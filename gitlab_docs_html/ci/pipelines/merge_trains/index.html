<!doctype html><html lang=en-us dir=ltr><head><script src=https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08></script><script type=text/javascript>function OptanonWrapper(){}</script><script>const callback=(e)=>{for(const t of e)t.type==="childList"&&t.addedNodes.forEach(e=>{e.nodeName==="IMG"&&document.querySelectorAll('img:not([src^="http"]):not([data-ot-ignore])').forEach(e=>{e.setAttribute("data-ot-ignore","")})})},config={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]},observer=new MutationObserver(callback);observer.observe(document.documentElement,config)</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GTM-NJXWQL"),gtag("consent","default",{analytics_storage:"granted",ad_storage:"granted",functionality_storage:"granted",wait_for_update:500}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",functionality_storage:"denied",region:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO","GB","PE","RU"],wait_for_update:500}),window.geofeed=e=>{dataLayer.push({event:"OneTrustCountryLoad",oneTrustCountryId:e.country.toString()})};const json=document.createElement("script");json.setAttribute("src","https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed"),document.head.appendChild(json)</script><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Merge trains | GitLab Docs</title><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=manifest href=/manifests/manifest.webmanifest><meta name=theme-color content="#FC6D26"><link rel=canonical href=https://docs.gitlab.com/ci/pipelines/merge_trains/><meta name=description content="Use merge trains to queue merge requests and prevent branch conflicts in GitLab CI/CD."><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"GitLab Docs","url":"https://docs.gitlab.com/"}</script><link rel=preload href=/gitlab_ui/fonts/GitLabSans.woff2 type=font/woff2 as=font crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabSans-Italic.woff2 crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabMono.woff2 crossorigin><link rel=stylesheet href=/gitlab_ui/ui/index.css><link rel=stylesheet href=/vite/main.css><link rel=stylesheet href=/css/syntax-dark.min.css id=syntax-dark-theme><link rel=stylesheet href=/css/syntax-light.min.css id=syntax-light-theme><script>(function(){const p="gitlab-docs-theme",g="gitlab-docs-layout",e={LIGHT:"light",DARK:"dark",AUTO:"auto"},i={FIXED:"fixed",FLUID:"fluid"},d="light",f="fixed";let r=!1;const t=localStorage?.getItem(p),m=localStorage?.getItem(g),l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?e.DARK:e.LIGHT;function h(){return t&&(t===e.LIGHT||t===e.DARK)?t:(t===e.AUTO&&(r=!0),l||d)}function u(){return m===i.FLUID?i.FLUID:f}const s=h(),c=u(),n=document.documentElement;n.classList.remove("gl-dark","gl-light"),n.classList.add(s===e.DARK?"gl-dark":"gl-light"),c===i.FLUID&&(n.classList.add("fluid"),n.classList.remove("fixed"));const a=document.getElementById("syntax-dark-theme"),o=document.getElementById("syntax-light-theme");a&&o&&(s===e.DARK?(a.disabled=!1,o.disabled=!0):(a.disabled=!0,o.disabled=!1)),window.__initialTheme=r?e.AUTO:s,window.__initialLayout=c})()</script><meta name=gitlab_docs_base_url content="/"><meta name=gitlab_docs_page_owner data-stage=Verify data-group="Pipeline Execution"><meta class=elastic name=gitlab_docs_version content="18.6"><meta class=elastic name=gitlab_docs_section content="use_gitlab"><meta class=elastic name=gitlab_docs_breadcrumbs content="Use GitLab › Use CI/CD to build your application › Pipelines › Types of pipelines"><script>window.pageMetadata={trail:[{path:"user/",title:"Use GitLab"},{path:"topics/build_your_application/",title:"Use CI/CD to build your application"},{path:"ci/pipelines/",title:"Pipelines"},{path:"ci/pipelines/pipeline_types/",title:"Types of pipelines"},{path:"ci/pipelines/merge_trains/",title:"Merge trains"}]}</script><meta name=gitlab_docs_legacy_path content="/ee/ci/pipelines/merge_trains.html"><meta name=gitlab_docs_hugo_launch_version content="17.9"><script>const ELASTIC_CLOUD_ID="gitlab-docs-website:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJDQwZTQyYTQzMTJiZjQyMzNiMzBiZTg0MTU5YjlkNmE1JGMxODg4Y2U5OTY0YzQzZjc5ZjQ1YTk5NDZmMjI0ODg0",ELASTIC_KEY="cDFpLWJaSUJXVHBqWWI4VGZKN3M6eENBSjl4WDRSRnlCUW94ajRQazhLQQ==",ELASTIC_INDEX="search-gitlab-docs-hugo"</script><script type=module src=/vite/elastic_search.js></script><script type=module src=/vite/history.js></script><script>const FS_IDENTIFIER="AIzaSyCLdi3jHHjkmLji9D8uj_RNPMHcdrYoIW4",RECAPTCHA_PUBLIC_KEY="6Le4R3UrAAAAALsIlK_siq0_UhPD-0rD-ImF1gfO"</script><meta name=google-site-verification content="AcGSBNaKDWnLgcYotlVibGy6STm2Y6_KJSaRxrA90xY"><meta name=google-site-verification content="6eFQOFLxYAer08ROqc3I-SAi44F9NmvH7PrUUBR3oCI"><meta name=google-site-verification content="xAUTWp3CDg-tU1LVVwsM9OrVhLR7L3SmiyKzkOuPNos"><meta name=google-site-verification content="F0zzwaMpiyWFcPQ1Lqu18qN3EnuQsqFXbySl_29yvHs"><meta name=google-site-verification content="nwo1bVaU0t9TZxZyM-aOI6-CofaH9GRL-uBPbdREWgc"><meta name=google-site-verification content="rWoHrtHEmIX0t28oOb1ZEDMYZb_EZA6rr6ZOl5otEPI"><meta name=google-site-verification content="fSxr8-uslxcuFL0N-oECp3Tm0RPNEGX97wbdayKOEL8"><meta name=google-site-verification content="ISxyLVnZqU8oY3jwrK7EO9o-2DOTvLJwPse7bZz6yhs"><meta name=google-site-verification content="x1WspIvz3ZHqS0gezfX_P-qiRDOeP2Oyrd68zrU2ErI"><meta name=google-site-verification content="DfXB2Za52GT3zs_vuLIAL4Mi3M3K4qxXcg7MAs0CUqo"><meta name=google-site-verification content="BCEBC2LC7A1NzO9Com1oBrWK88tV_QXfUL0i9mwXPL0"><meta name=google-site-verification content="a2lNcHMorfS43aoISjZt5_BBPo-H1UaTKMQdBgZO9iY"><meta name=google-site-verification content="0s16pP9MelY6wDHRf-izXb5pwLU01IogP-Uc_e8f3GU"><meta name=google-site-verification content="H474RNof35Xp8fLg02fZbg9Dzxdtfch6vtcjzpmUraU"><meta name=google-site-verification content="E0FlhpgBGeE7d1pQ6amdcIWPMDLDeu15-HLQVoDTguE"><meta name=google-site-verification content="opQd7_rXtPy-pX5CO_XZiztzeQEsXnB3j6Y1_dZAizA"><meta name=google-site-verification content="06Kq4AoXdmBOjOAkbPvnYGtSxnn4Q9QBqEO55PLlw5c"><meta name=google-site-verification content="djBBokRFSWV_VRlSE51V5TZSPzMC6hml5l-Sb22WglE"><meta name=google-site-verification content="UOW6nOsvbyMeIySuamzbws4kNC_WqehamWfoxxtKjZ8"><meta name=google-site-verification content="hXU1Gsdba74DUbvbdUHRl9o0cQeiwXIhAdIllOG6p8E"><meta name=google-site-verification content="YFeHIAPk9lE76ubVMeq4P0sQVnzo2-a4k1oU_bPY8yE"><meta name=google-site-verification content="h8ICI4eDkvXmYaGDuLTLoWuXnLn-KUkChqYB-roMRsw"><meta name=google-site-verification content="9QW7feFNlCpMLPm7vAWEU-v14vdzb0Bb3RAk-8e_a18"><meta name=google-site-verification content="26kXLBOjaYRb2UwzWTDl1I1nzA2NxMunhp7SUtxGV6E"><meta name=google-site-verification content="jr3C8t6vKGPyN9GV3esdHY_xGYyQaUNznIl-Un2RObA"><meta name=google-site-verification content="WdlBpRU0ec1ieKqrTY_772OhG23FY45VQ4Lv9DyLJ_Y"><meta name=google-site-verification content="n9i6B9q4Xjr_etK2nQGZH1msoo7vIv9SXV8SQLOUA7c"><meta name=zd-site-verification content="ony3w7hk1vs6tfyrc51mld"><meta name=zd-site-verification content="gtuq65qdzt6n31viazi6hj"></head><body data-elastic-exclude><nav data-ga-section=header data-elastic-exclude><div class="header-wrapper gl-w-full gl-fixed gl-z-4"><div class=header><div class="header-top gl-flex gl-items-center"><a href=#skipTarget class="gl-sr-only skip-link">Skip to main content</a>
<a class=navbar-logo href=/><span class=gl-sr-only>Go to GitLab Docs homepage</span></a><div class="mobile-header gl-w-full gl-text-base"><div class=mobile-header-overlay></div><div class="header-right collapse gl-z-4 gl-border-t lg:gl-border-0"><div class="search-wrapper lg:gl-ml-4 lg:gl-grow"><div class="js-elastic-search-form gl-spinner-container"><span role=status aria-label=Loading class="gl-ml-3 gl-align-text-bottom! gl-spinner gl-spinner gl-spinner-sm"></span></div></div><div class="gl-flex gl-flex-col gl-gap-3 gl-mt-5 lg:gl-mt-0 lg:gl-flex-row lg:gl-items-center gl-ml-auto"><a class="whats-new gl-button btn-default btn-default-tertiary gl-hidden lg:gl-block" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a><div data-vue-app=versions-menu></div><div data-vue-app=appearance-toggle class="gl-hidden lg:gl-block"></div><div class="gl-flex gl-justify-evenly lg:gl-justify-normal gl-items-center gl-gap-5"><a class="whats-new gl-button btn-default btn-default-tertiary gl-w-full lg:gl-hidden hover:gl-no-underline" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a>
<a class="free-trial-btn cta-button gl-button btn-confirm gl-w-full hover:gl-no-underline" href="https://gitlab.com/-/trial_registrations/new?glm_source=docs.gitlab.com&amp;amp;glm_content=navigation-cta-docs" target=_blank rel="noopener noreferrer" role=button>Get free trial</a></div></div></div></div><button class="navbar-toggle gl-button btn-default lg:gl-hidden" data-toggle=collapse data-target=.header-right>
<span class=navbar-toggle-icon></span>
<span class=gl-sr-only>Toggle menu</span></button></div><div class="header-bottom gl-border-t lg:gl-border-b"><ul class="subheader-menu gl-hidden lg:gl-flex gl-list-none gl-text-base gl-space-x-5 gl-py-4 gl-pl-0 gl-mb-0"><li><a href=/user/ class=active>Use GitLab</a></li><li><a href=/user/gitlab_duo/>GitLab Duo</a></li><li><a href=/api/>Extend</a></li><li><a href=/install/>Install</a></li><li><a href=/administration/>Administer</a></li><li><a href=/subscriptions/>Subscribe</a></li><li><a href=/development/>Contribute</a></li><li><a href=/solutions/>Solutions</a></li></ul></div></div></div></nav><main data-ga-section=content-body><div id=js-version-banner></div><div class="template-single gl-flex gl-h-full"><div class=side-nav data-ga-section=side-nav data-vue-app=sidebar-menu></div><div data-pagefind-body class=main-content><div class=docs-content><div class="gl-flex gl-h-5 gl-items-center gl-my-6"><div data-vue-app=open-sidebar></div><div data-vue-app=breadcrumb-nav></div></div><hr class="gl-border-t gl-px-5 lg:gl-hidden"><div class="gl-pt-4 gl-mt-4 lg:gl-pt-0 lg:gl-mt-0 lg:gl-border-t-0"><h1 id=skipTarget class=gl-mb-6>Merge trains</h1></div><div data-elastic-include><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-1 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-1>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-1 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/359057>In GitLab 16.0 and later</a>, the <strong>Start merge train</strong> and <strong>Start merge train when pipeline succeeds</strong> buttons became <strong>Set to auto-merge</strong>. <strong>Remove from merge train</strong> became <strong>Cancel auto-merge</strong>.</li><li>Support for <a href=/user/project/merge_requests/methods/#fast-forward-merge>fast-forward</a> and <a href=/user/project/merge_requests/methods/#merge-commit-with-semi-linear-history>semi-linear</a> merge methods <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/282442>introduced</a> in GitLab 16.5 <a href=/administration/feature_flags/>with a flag</a> named <code>fast_forward_merge_trains_support</code>. Enabled by default.</li><li><a href=https://gitlab.com/gitlab-org/gitlab/-/merge_requests/148964#note_1855981445>Feature flag <code>fast_forward_merge_trains_support</code> removed</a> in GitLab 16.11.</li></ul></div></div><p>In projects with frequent merges to the default branch, changes in different merge requests
might conflict with each other. Use merge trains to put merge requests in a queue.
Each merge request is compared to the other, earlier merge requests, to ensure they all work together.</p><p>For more information about:</p><ul><li>How merge trains work, review the <a href=/ci/pipelines/merge_trains/#merge-train-workflow>merge train workflow</a>.</li><li>Why you might want to use merge trains, read <a href=https://about.gitlab.com/blog/2020/01/30/all-aboard-merge-trains/>How starting merge trains improve efficiency for DevOps</a>.</li></ul><h2 id=merge-train-workflow>Merge train workflow</h2><p>A merge train starts when there are no merge requests waiting to merge and you
select <a href=/ci/pipelines/merge_trains/#start-a-merge-train><strong>Merge</strong> or <strong>Set to auto-merge</strong></a>. GitLab starts a merge
train pipeline that verifies that the changes can merge into the default branch.
This first pipeline is the same as a <a href=/ci/pipelines/merged_results_pipelines/>merged results pipeline</a>,
which runs on the changes of the source and target branches combined together.
The author of the internal merged result commit is the user that initiated the
merge.</p><p>To queue a second merge request to merge immediately after the first pipeline
completes, select <a href=/ci/pipelines/merge_trains/#add-a-merge-request-to-a-merge-train><strong>Merge</strong> or <strong>Set to auto-merge</strong></a>
to add it to the train. This second merge train pipeline runs on the changes of
<em>both</em> merge requests combined with the target branch. Similarly, if you add a
third merge request, that pipeline runs on the changes of all three merge
requests merged with the target branch. The pipelines all run in parallel.</p><p>Each merge request merges into the target branch only after:</p><ul><li>The merge request&rsquo;s pipeline completes successfully.</li><li>All other merge requests queued before it are merged.</li></ul><p>If a merge train pipeline fails, the merge request is not merged. GitLab
removes that merge request from the merge train, and starts new pipelines for all
the merge requests that were queued after it.</p><p>For example:</p><p>Three merge requests (<code>A</code>, <code>B</code>, and <code>C</code>) are added to a merge train in order, which
creates three merged results pipelines that run in parallel:</p><ol><li>The first pipeline runs on the changes from <code>A</code> combined with the target branch.</li><li>The second pipeline runs on the changes from <code>A</code> and <code>B</code> combined with the target branch.</li><li>The third pipeline runs on the changes from <code>A</code>, <code>B</code>, and <code>C</code> combined with the target branch.</li></ol><p>If the pipeline for <code>B</code> fails:</p><ul><li>The first pipeline (<code>A</code>) continues to run.</li><li><code>B</code> is removed from the train.</li><li>The pipeline for <code>C</code> <a href=/ci/pipelines/merge_trains/#automatic-pipeline-cancellation>is canceled</a>, and a new pipeline
starts for the changes from <code>A</code> and <code>C</code> combined with the target branch (without the <code>B</code> changes).</li></ul><p>If <code>A</code> then completes successfully, it merges into the target branch, and <code>C</code> continues
to run. Any new merge requests added to the train include the <code>A</code> changes now in
the target branch, and the <code>C</code> changes from the merge train.</p><p><i class="fa fa-youtube-play youtube" aria-hidden=true></i>
Watch this video for a demonstration on <a href="https://www.youtube.com/watch?v=D4qCqXgZkHQ">how parallel execution of merge trains can prevent commits from breaking the default branch</a>.</p><h3 id=automatic-pipeline-cancellation>Automatic pipeline cancellation</h3><p>GitLab CI/CD detects redundant pipelines, and cancels them to conserve resources.</p><p>Redundant merge train pipelines happen when:</p><ul><li>The pipeline fails for one of the merge requests in the merge train.</li><li>You <a href=/ci/pipelines/merge_trains/#skip-the-merge-train-and-merge-immediately>skip the merge train and merge immediately</a>.</li><li>You <a href=/ci/pipelines/merge_trains/#remove-a-merge-request-from-a-merge-train>remove a merge request from a merge train</a>.</li></ul><p>In these cases, GitLab must create new merge train pipelines for some or all of the
merge requests on the train. The old pipelines were comparing against the previous
combined changes in the merge train, which are no longer valid, so these old pipelines
are canceled.</p><h2 id=enable-merge-trains>Enable merge trains</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-2 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-2>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-2 class="collapsible-list collapse" aria-hidden=true><ul><li><code>disable_merge_trains</code> feature flag <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/282477>removed</a> in GitLab 16.5.</li></ul></div></div><p>Prerequisites:</p><ul><li>You must have the Maintainer role.</li><li>Your repository must be a GitLab repository, not an <a href=/ci/ci_cd_for_external_repos/>external repository</a>.</li><li>Your pipeline must be <a href=/ci/pipelines/merge_request_pipelines/#prerequisites>configured to use merge request pipelines</a>.
Otherwise your merge requests may become stuck in an unresolved state or your pipelines
might be dropped.</li><li>You must have <a href=/ci/pipelines/merged_results_pipelines/#enable-merged-results-pipelines>merged results pipelines enabled</a>.</li></ul><p>To enable merge trains:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Settings</strong> > <strong>Merge requests</strong>.</li><li>In GitLab 16.4 and earlier, in the <strong>Merge method</strong> section, verify that <strong>Merge commit</strong> is selected.
In GitLab 16.5 and later, you can use any merge method.</li><li>In the <strong>Merge options</strong> section, ensure <strong>Enable merged results pipelines</strong> is enabled
and select <strong>Enable merge trains</strong>.</li><li>Select <strong>Save changes</strong>.</li></ol><h2 id=start-a-merge-train>Start a merge train</h2><p>Prerequisites:</p><ul><li>You must have <a href=/user/permissions/>permissions</a> to merge or push to the target branch.</li></ul><p>To start a merge train:</p><ol><li>Go to a merge request.</li><li>Select:<ul><li>When no pipeline is running, <strong>Merge</strong>.</li><li>When a pipeline is running, <a href=/user/project/merge_requests/auto_merge/><strong>Set to auto-merge</strong></a>.</li></ul></li></ol><p>The merge request&rsquo;s merge train status displays under the pipeline widget with a
message similar to <code>A new merge train has started and this merge request is the first of the queue. View merge train details.</code>
You can select the link to view the merge train.</p><p>Other merge requests can now be added to the train.</p><h2 id=view-a-merge-train>View a merge train</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-3 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-3>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-3 class="collapsible-list collapse" aria-hidden=true><ul><li>Merge train visualization <a href=https://gitlab.com/groups/gitlab-org/-/epics/13705>introduced</a> in GitLab 17.3.</li></ul></div></div><p>You can view the merge train to gain better insight into the order and status of merge requests in the queue.
The merge train details page shows active merge requests in the queue and merged merge requests that were part of the train.</p><p>To access the merge train details from the list of merge requests:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Code</strong> > <strong>Merge requests</strong>.</li><li>Above the list of merge requests, select <strong>Merge trains</strong>.</li><li>Optional. Filter the merge trains by target branch.</li></ol><p>You also access this view by selecting <strong>View merge train details</strong> from:</p><ul><li>The pipeline widget and system notes on a merge request added to a merge train.</li><li>The pipeline details page for a merge train pipeline.</li></ul><p>You can also remove (<span> <svg role="img" aria-label="close" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#close"/><title>close</title></svg> </span>) a merge request from the merge train details view.</p><h2 id=add-a-merge-request-to-a-merge-train>Add a merge request to a merge train</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-5 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-5>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-5 class="collapsible-list collapse" aria-hidden=true><ul><li>Auto-merge for merge trains <a href=https://gitlab.com/groups/gitlab-org/-/epics/10874>introduced</a> in GitLab 17.2 <a href=/administration/feature_flags/>with a flag</a> named <code>merge_when_checks_pass_merge_train</code>. Disabled by default.</li><li>Auto-merge for merge trains <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/470667>enabled</a> on GitLab.com in GitLab 17.2.</li><li>Auto-merge for merge trains <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/470667>enabled</a> by default in GitLab 17.4.</li><li>Auto-merge for merge trains <a href=https://gitlab.com/gitlab-org/gitlab/-/merge_requests/174357>generally available</a> in GitLab 17.7. Feature flag <code>merge_when_checks_pass_merge_train</code> removed.</li></ul></div></div><p>Prerequisites:</p><ul><li>You must have <a href=/user/permissions/>permissions</a> to merge or push to the target branch.</li></ul><p>To add a merge request to a merge train:</p><ol><li>Visit a merge request.</li><li>Select:<ul><li>When no pipeline is running, <strong>Merge</strong>.</li><li>When a pipeline is running, <a href=/user/project/merge_requests/auto_merge/><strong>Set to auto-merge</strong></a>.</li></ul></li></ol><p>The merge request&rsquo;s merge train status displays under the pipeline widget with a
message similar to <code>This merge request is 2 of 3 in queue.</code></p><p>Each merge train can run a maximum of twenty pipelines in parallel. If you add more than
twenty merge requests to the merge train, the extra merge requests are queued, waiting
for pipelines to complete. There is no limit to the number of queued merge requests
waiting to join the merge train.</p><h2 id=remove-a-merge-request-from-a-merge-train>Remove a merge request from a merge train</h2><p>When you remove a merge request from a merge train:</p><ul><li>All pipelines for merge requests queued after the removed merge request restart.</li><li>Redundant pipelines <a href=/ci/pipelines/merge_trains/#automatic-pipeline-cancellation>are canceled</a>.</li></ul><p>You can add the merge request to a merge train again later.</p><p>To remove a merge request from a merge train:</p><ul><li>From a merge request, select <strong>Cancel auto-merge</strong>.</li><li>From the <a href=/ci/pipelines/merge_trains/#view-a-merge-train>merge train details</a>, next to the merge request, select <span><svg role="img" aria-label="close" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#close"/><title>close</title></svg> </span>.</li></ul><h2 id=skip-the-merge-train-and-merge-immediately>Skip the merge train and merge immediately</h2><p>If you have a high-priority merge request, like a critical patch that must
be merged urgently, you can select <strong>Merge immediately</strong>.</p><p>When you merge a merge request immediately:</p><ul><li>The commits from the merge request are merged, ignoring the status of the merge train.</li><li>The merge train pipelines for all other merge requests on the train <a href=/ci/pipelines/merge_trains/#automatic-pipeline-cancellation>are canceled</a>.</li><li>A new merge train starts and all the merge requests from the original merge train are added to this new merge train,
with a new merge train pipeline for each. These new merge train pipelines now contain
the commits added by the merge request that was merged immediately.</li></ul><div class="alert alert-type-warning gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>Merging immediately can use a lot of CI/CD resources. Use this option
only in critical situations.</p></div></div><div class="alert alert-type-note gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>The <strong>merge immediately</strong> option may not be available if your project uses the <a href=/user/project/merge_requests/methods/#fast-forward-merge>fast-forward</a>
merge method and the source branch is behind the target branch. See <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/434070>issue 434070</a> for more details.</p></div></div><h3 id=allow-merge-trains-to-be-skipped-to-merge-immediately-without-restarting-merge-train-pipelines>Allow merge trains to be skipped to merge immediately without restarting merge train pipelines</h3><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Status</span>: Experiment</li></ul></div><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-10 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-10>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-10 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/414505>Introduced</a> in GitLab 16.5 <a href=/administration/feature_flags/>with a flag</a> named <code>merge_trains_skip_train</code>. Disabled by default.</li><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/422111>Enabled</a> as an <a href=/policy/development_stages_support/>experiment feature</a> in GitLab 16.10.</li></ul></div></div><div class="alert alert-type-flag gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>On GitLab Self-Managed, by default this feature is available. To hide the feature,
an administrator can <a href=/administration/feature_flags/>disable the feature flag</a>
named <code>merge_trains_skip_train</code>. On GitLab.com and GitLab Dedicated, this feature is available.</p></div></div><p>You can allow merge requests to be merged without completely restarting a running merge train.
Use this feature to quickly merge changes that can safely skip the pipeline, for example
minor documentation updates.</p><p>You cannot skip merge trains for fast-forward or semi-linear merge methods. For more information, see <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/429009>issue 429009</a>.</p><p>Skipping merge trains is an experimental feature. It may change or be removed completely in future releases.</p><div class="alert alert-type-warning gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>You can use this feature to quickly merge security or bug fixes, but the changes
in the merge request that skipped the train are not verified against
any of the other merge requests in the train. If these other merge train pipelines
complete successfully and merge, there is a risk that the combined changes are incompatible.
The target branch could then require additional work to resolve the new failures.</p></div></div><p>Prerequisites:</p><ul><li>You must have the Maintainer role.</li><li>You must have <a href=/ci/pipelines/merge_trains/#enable-merge-trains>Merge trains enabled</a>.</li></ul><p>To enable skipping the train without pipeline restarts:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Settings</strong> > <strong>Merge requests</strong>.</li><li>In the <strong>Merge options</strong> section, ensure the <strong>Enable merged results pipelines</strong>
and <strong>Enable merge trains</strong> options are enabled.</li><li>Select <strong>Allow skipping the merge train</strong>.</li><li>Select <strong>Save changes</strong>.</li></ol><p>To merge a merge request by skipping the merge train, use the <a href=/api/merge_requests/#merge-a-merge-request>merge requests merge API endpoint</a>
to merge with the attribute <code>skip_merge_train</code> set to <code>true</code>.</p><p>The merge request merges, and the existing merge train pipelines are not canceled
or restarted.</p><h2 id=troubleshooting>Troubleshooting</h2><h3 id=merge-request-dropped-from-the-merge-train>Merge request dropped from the merge train</h3><p>If a merge request becomes unmergeable while a merge train pipeline is running,
the merge train drops your merge request automatically. For example, this could be caused by:</p><ul><li>Changing the merge request to a <a href=/user/project/merge_requests/drafts/>draft</a>.</li><li>A merge conflict.</li><li>A new conversation thread that is unresolved, when <a href=/user/project/merge_requests/#prevent-merge-unless-all-threads-are-resolved>all threads must be resolved</a>
is enabled.</li></ul><p>You can find reason the merge request was dropped from the merge train in the system
notes. Check the <strong>Activity</strong> section in the <strong>Overview</strong> tab for a message similar to:
<code>User removed this merge request from the merge train because ...</code></p><h3 id=cannot-use-auto-merge>Cannot use auto-merge</h3><p>You cannot use <a href=/user/project/merge_requests/auto_merge/>auto-merge</a>
(formerly <strong>Merge when pipeline succeeds</strong>) to skip the merge train, when merge trains are enabled.
See <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/12267>issue 12267</a> for more information.</p><h3 id=cannot-retry-merge-train-pipeline>Cannot retry merge train pipeline</h3><p>When a merge train pipeline fails, the merge request is dropped from the train and the pipeline can&rsquo;t be retried after it fails.
Merge train pipelines run on the merged result of the changes in the merge request and
changes from other merge requests already on the train. If the merge request is dropped from the train,
the merged result is out of date and the pipeline can&rsquo;t be retried.</p><p>You can:</p><ul><li><a href=/ci/pipelines/merge_trains/#add-a-merge-request-to-a-merge-train>Add the merge request to the train</a> again,
which triggers a new pipeline.</li><li>Add the <a href=/ci/yaml/#retry><code>retry</code></a> keyword to the job if it fails intermittently.
If it succeeds after a retry, the merge request is not removed from the merge train.</li></ul><h3 id=cannot-add-a-merge-request-to-the-merge-train>Cannot add a merge request to the merge train</h3><p>When <a href=/user/project/merge_requests/auto_merge/#require-a-successful-pipeline-for-merge><strong>Pipelines must succeed</strong></a>
is enabled, but the latest pipeline failed:</p><ul><li>The <strong>Set to auto-merge</strong> or <strong>Merge</strong> options are not available.</li><li>The merge request displays <code>The pipeline for this merge request failed. Please retry the job or push a new commit to fix the failure.</code></li></ul><p>Before you can re-add a merge request to a merge train, you can try to:</p><ul><li>Retry the failed job. If it passes, and no other jobs failed, the pipeline is marked as successful.</li><li>Rerun the whole pipeline. On the <strong>Pipelines</strong> tab, select <strong>Run pipeline</strong>.</li><li>Push a new commit that fixes the issue, which also triggers a new pipeline.</li></ul><p>See <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/35135>the related issue</a>
for more information.</p></div><div data-vue-app=back-to-top-button></div></div><div class="feedback gl-min-h-8" data-ga-section=feedback data-elastic-exclude><div data-component=docs-feedback></div></div></div><aside class=sidebar-right><div data-ga-section=toc data-vue-app=toc></div></aside></div></main><footer data-ga-section=footer><section data-ga-section=footer><div id=footer class="footer-section container gl-grid gl-grid-cols-2 gl-grid-rows-3 gl-grid-rows-auto gl-gap-8 lg:gl-grid-cols-5 lg:gl-grid-rows-1 lg:gl-justify-items-center gl-px-8 gl-py-8 lg:gl-py-10"><div class="gl-col-span-2 lg:gl-col-span-1 gl-row-start-1"><div class="docs-title gl-flex gl-items-center"><a href=/><img src=/gitlab-logo-footer.svg alt="GitLab Docs logo" class=logo width=176 height=24></a></div><ul class="docs-social gl-list-none gl-flex"><li><a href=https://www.facebook.com/gitlab class=facebook><span class=gl-sr-only>Facebook</span></a></li><li><a href=https://www.linkedin.com/company/gitlab-com class=linkedin><span class=gl-sr-only>LinkedIn</span></a></li><li><a href=https://twitter.com/gitlab class=twitter><span class=gl-sr-only>Twitter</span></a></li><li><a href=https://www.youtube.com/channel/UCnMGQ8QHMAnVIsI3xJrihhg class=youtube><span class=gl-sr-only>YouTube</span></a></li></ul><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="license noopener noreferrer" class=gl-mt-0><img src=/by-sa.svg alt="Creative Commons License" width=80 height=15></a></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Company</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/company/>About GitLab</a></li><li><a href=https://about.gitlab.com/pricing/>View pricing</a></li><li><a href=https://about.gitlab.com/free-trial/>Try GitLab for free</a></li></ul></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Feedback</div><ul class="gl-list-none gl-p-0"><li><a href=https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/ci/pipelines/merge_trains.md>View page source</a></li><li><a href=https://gitlab.com/-/ide/project/gitlab-org/gitlab/edit/master/-/doc/ci/pipelines/merge_trains.md>Edit in web IDE</a></li><li><a href=https://about.gitlab.com/community/contribute/>Contribute to GitLab</a></li><li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/new?issuable_template=Documentation">Suggest updates</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Help & Community</div><ul class="gl-list-none gl-p-0"><li><a href=https://university.gitlab.com/pages/certifications>Get certified</a></li><li><a href=https://about.gitlab.com/support/>Get support</a></li><li><a href="https://forum.gitlab.com/new-topic?title=topic%20title&amp;body=topic%20body&amp;tags=docs-feedback">Post on the GitLab forum</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Resources</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/terms/>Terms</a></li><li><a href=https://about.gitlab.com/privacy/>Privacy statement</a></li><li><a href=/legal/use_generative_ai/>Use of generative AI</a></li><li><a href=/legal/licensing_policy/>Acceptable use of user licenses</a></li><li><button id=ot-sdk-btn class=ot-sdk-show-settings></button></li></ul></div></div></section></footer><script type=module src=/vite/main.js></script><script async>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NJXWQL")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJXWQL" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script async>(function(){var e,t=!1;function n(){t===!1&&(t=!0,Munchkin.init("194-VVC-221",{useBeaconAPI:!0}))}e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://munchkin.marketo.net/munchkin.js",e.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&n()},e.onload=n,document.getElementsByTagName("head")[0].appendChild(e)})()</script><script async src=https://cdn.bizible.com/scripts/bizible.js></script><script async>_linkedin_partner_id="30694",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id),function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height=1 width=1 style=display:none alt src="https://dc.ads.linkedin.com/collect/?pid=30694&fmt=gif"></noscript></body></html>