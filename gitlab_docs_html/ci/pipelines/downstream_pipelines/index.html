<!doctype html><html lang=en-us dir=ltr><head><script src=https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08></script><script type=text/javascript>function OptanonWrapper(){}</script><script>const callback=(e)=>{for(const t of e)t.type==="childList"&&t.addedNodes.forEach(e=>{e.nodeName==="IMG"&&document.querySelectorAll('img:not([src^="http"]):not([data-ot-ignore])').forEach(e=>{e.setAttribute("data-ot-ignore","")})})},config={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]},observer=new MutationObserver(callback);observer.observe(document.documentElement,config)</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GTM-NJXWQL"),gtag("consent","default",{analytics_storage:"granted",ad_storage:"granted",functionality_storage:"granted",wait_for_update:500}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",functionality_storage:"denied",region:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO","GB","PE","RU"],wait_for_update:500}),window.geofeed=e=>{dataLayer.push({event:"OneTrustCountryLoad",oneTrustCountryId:e.country.toString()})};const json=document.createElement("script");json.setAttribute("src","https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed"),document.head.appendChild(json)</script><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Downstream pipelines | GitLab Docs</title><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=manifest href=/manifests/manifest.webmanifest><meta name=theme-color content="#FC6D26"><link rel=canonical href=https://docs.gitlab.com/ci/pipelines/downstream_pipelines/><meta name=description content="GitLab product documentation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"GitLab Docs","url":"https://docs.gitlab.com/"}</script><link rel=preload href=/gitlab_ui/fonts/GitLabSans.woff2 type=font/woff2 as=font crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabSans-Italic.woff2 crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabMono.woff2 crossorigin><link rel=stylesheet href=/gitlab_ui/ui/index.css><link rel=stylesheet href=/vite/main.css><link rel=stylesheet href=/css/syntax-dark.min.css id=syntax-dark-theme><link rel=stylesheet href=/css/syntax-light.min.css id=syntax-light-theme><script>(function(){const p="gitlab-docs-theme",g="gitlab-docs-layout",e={LIGHT:"light",DARK:"dark",AUTO:"auto"},i={FIXED:"fixed",FLUID:"fluid"},d="light",f="fixed";let r=!1;const t=localStorage?.getItem(p),m=localStorage?.getItem(g),l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?e.DARK:e.LIGHT;function h(){return t&&(t===e.LIGHT||t===e.DARK)?t:(t===e.AUTO&&(r=!0),l||d)}function u(){return m===i.FLUID?i.FLUID:f}const s=h(),c=u(),n=document.documentElement;n.classList.remove("gl-dark","gl-light"),n.classList.add(s===e.DARK?"gl-dark":"gl-light"),c===i.FLUID&&(n.classList.add("fluid"),n.classList.remove("fixed"));const a=document.getElementById("syntax-dark-theme"),o=document.getElementById("syntax-light-theme");a&&o&&(s===e.DARK?(a.disabled=!1,o.disabled=!0):(a.disabled=!0,o.disabled=!1)),window.__initialTheme=r?e.AUTO:s,window.__initialLayout=c})()</script><meta name=gitlab_docs_base_url content="/"><meta name=gitlab_docs_page_owner data-stage=Verify data-group="Pipeline Authoring"><meta class=elastic name=gitlab_docs_version content="18.6"><meta class=elastic name=gitlab_docs_section content="use_gitlab"><meta class=elastic name=gitlab_docs_breadcrumbs content="Use GitLab › Use CI/CD to build your application › Pipelines"><script>window.pageMetadata={trail:[{path:"user/",title:"Use GitLab"},{path:"topics/build_your_application/",title:"Use CI/CD to build your application"},{path:"ci/pipelines/",title:"Pipelines"},{path:"ci/pipelines/downstream_pipelines/",title:"Downstream pipelines"}]}</script><meta name=gitlab_docs_legacy_path content="/ee/ci/pipelines/downstream_pipelines.html"><meta name=gitlab_docs_hugo_launch_version content="17.9"><script>const ELASTIC_CLOUD_ID="gitlab-docs-website:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJDQwZTQyYTQzMTJiZjQyMzNiMzBiZTg0MTU5YjlkNmE1JGMxODg4Y2U5OTY0YzQzZjc5ZjQ1YTk5NDZmMjI0ODg0",ELASTIC_KEY="cDFpLWJaSUJXVHBqWWI4VGZKN3M6eENBSjl4WDRSRnlCUW94ajRQazhLQQ==",ELASTIC_INDEX="search-gitlab-docs-hugo"</script><script type=module src=/vite/elastic_search.js></script><script type=module src=/vite/history.js></script><script>const FS_IDENTIFIER="AIzaSyCLdi3jHHjkmLji9D8uj_RNPMHcdrYoIW4",RECAPTCHA_PUBLIC_KEY="6Le4R3UrAAAAALsIlK_siq0_UhPD-0rD-ImF1gfO"</script><meta name=google-site-verification content="AcGSBNaKDWnLgcYotlVibGy6STm2Y6_KJSaRxrA90xY"><meta name=google-site-verification content="6eFQOFLxYAer08ROqc3I-SAi44F9NmvH7PrUUBR3oCI"><meta name=google-site-verification content="xAUTWp3CDg-tU1LVVwsM9OrVhLR7L3SmiyKzkOuPNos"><meta name=google-site-verification content="F0zzwaMpiyWFcPQ1Lqu18qN3EnuQsqFXbySl_29yvHs"><meta name=google-site-verification content="nwo1bVaU0t9TZxZyM-aOI6-CofaH9GRL-uBPbdREWgc"><meta name=google-site-verification content="rWoHrtHEmIX0t28oOb1ZEDMYZb_EZA6rr6ZOl5otEPI"><meta name=google-site-verification content="fSxr8-uslxcuFL0N-oECp3Tm0RPNEGX97wbdayKOEL8"><meta name=google-site-verification content="ISxyLVnZqU8oY3jwrK7EO9o-2DOTvLJwPse7bZz6yhs"><meta name=google-site-verification content="x1WspIvz3ZHqS0gezfX_P-qiRDOeP2Oyrd68zrU2ErI"><meta name=google-site-verification content="DfXB2Za52GT3zs_vuLIAL4Mi3M3K4qxXcg7MAs0CUqo"><meta name=google-site-verification content="BCEBC2LC7A1NzO9Com1oBrWK88tV_QXfUL0i9mwXPL0"><meta name=google-site-verification content="a2lNcHMorfS43aoISjZt5_BBPo-H1UaTKMQdBgZO9iY"><meta name=google-site-verification content="0s16pP9MelY6wDHRf-izXb5pwLU01IogP-Uc_e8f3GU"><meta name=google-site-verification content="H474RNof35Xp8fLg02fZbg9Dzxdtfch6vtcjzpmUraU"><meta name=google-site-verification content="E0FlhpgBGeE7d1pQ6amdcIWPMDLDeu15-HLQVoDTguE"><meta name=google-site-verification content="opQd7_rXtPy-pX5CO_XZiztzeQEsXnB3j6Y1_dZAizA"><meta name=google-site-verification content="06Kq4AoXdmBOjOAkbPvnYGtSxnn4Q9QBqEO55PLlw5c"><meta name=google-site-verification content="djBBokRFSWV_VRlSE51V5TZSPzMC6hml5l-Sb22WglE"><meta name=google-site-verification content="UOW6nOsvbyMeIySuamzbws4kNC_WqehamWfoxxtKjZ8"><meta name=google-site-verification content="hXU1Gsdba74DUbvbdUHRl9o0cQeiwXIhAdIllOG6p8E"><meta name=google-site-verification content="YFeHIAPk9lE76ubVMeq4P0sQVnzo2-a4k1oU_bPY8yE"><meta name=google-site-verification content="h8ICI4eDkvXmYaGDuLTLoWuXnLn-KUkChqYB-roMRsw"><meta name=google-site-verification content="9QW7feFNlCpMLPm7vAWEU-v14vdzb0Bb3RAk-8e_a18"><meta name=google-site-verification content="26kXLBOjaYRb2UwzWTDl1I1nzA2NxMunhp7SUtxGV6E"><meta name=google-site-verification content="jr3C8t6vKGPyN9GV3esdHY_xGYyQaUNznIl-Un2RObA"><meta name=google-site-verification content="WdlBpRU0ec1ieKqrTY_772OhG23FY45VQ4Lv9DyLJ_Y"><meta name=google-site-verification content="n9i6B9q4Xjr_etK2nQGZH1msoo7vIv9SXV8SQLOUA7c"><meta name=zd-site-verification content="ony3w7hk1vs6tfyrc51mld"><meta name=zd-site-verification content="gtuq65qdzt6n31viazi6hj"></head><body data-elastic-exclude><nav data-ga-section=header data-elastic-exclude><div class="header-wrapper gl-w-full gl-fixed gl-z-4"><div class=header><div class="header-top gl-flex gl-items-center"><a href=#skipTarget class="gl-sr-only skip-link">Skip to main content</a>
<a class=navbar-logo href=/><span class=gl-sr-only>Go to GitLab Docs homepage</span></a><div class="mobile-header gl-w-full gl-text-base"><div class=mobile-header-overlay></div><div class="header-right collapse gl-z-4 gl-border-t lg:gl-border-0"><div class="search-wrapper lg:gl-ml-4 lg:gl-grow"><div class="js-elastic-search-form gl-spinner-container"><span role=status aria-label=Loading class="gl-ml-3 gl-align-text-bottom! gl-spinner gl-spinner gl-spinner-sm"></span></div></div><div class="gl-flex gl-flex-col gl-gap-3 gl-mt-5 lg:gl-mt-0 lg:gl-flex-row lg:gl-items-center gl-ml-auto"><a class="whats-new gl-button btn-default btn-default-tertiary gl-hidden lg:gl-block" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a><div data-vue-app=versions-menu></div><div data-vue-app=appearance-toggle class="gl-hidden lg:gl-block"></div><div class="gl-flex gl-justify-evenly lg:gl-justify-normal gl-items-center gl-gap-5"><a class="whats-new gl-button btn-default btn-default-tertiary gl-w-full lg:gl-hidden hover:gl-no-underline" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a>
<a class="free-trial-btn cta-button gl-button btn-confirm gl-w-full hover:gl-no-underline" href="https://gitlab.com/-/trial_registrations/new?glm_source=docs.gitlab.com&amp;amp;glm_content=navigation-cta-docs" target=_blank rel="noopener noreferrer" role=button>Get free trial</a></div></div></div></div><button class="navbar-toggle gl-button btn-default lg:gl-hidden" data-toggle=collapse data-target=.header-right>
<span class=navbar-toggle-icon></span>
<span class=gl-sr-only>Toggle menu</span></button></div><div class="header-bottom gl-border-t lg:gl-border-b"><ul class="subheader-menu gl-hidden lg:gl-flex gl-list-none gl-text-base gl-space-x-5 gl-py-4 gl-pl-0 gl-mb-0"><li><a href=/user/ class=active>Use GitLab</a></li><li><a href=/user/gitlab_duo/>GitLab Duo</a></li><li><a href=/api/>Extend</a></li><li><a href=/install/>Install</a></li><li><a href=/administration/>Administer</a></li><li><a href=/subscriptions/>Subscribe</a></li><li><a href=/development/>Contribute</a></li><li><a href=/solutions/>Solutions</a></li></ul></div></div></div></nav><main data-ga-section=content-body><div id=js-version-banner></div><div class="template-single gl-flex gl-h-full"><div class=side-nav data-ga-section=side-nav data-vue-app=sidebar-menu></div><div data-pagefind-body class=main-content><div class=docs-content><div class="gl-flex gl-h-5 gl-items-center gl-my-6"><div data-vue-app=open-sidebar></div><div data-vue-app=breadcrumb-nav></div></div><hr class="gl-border-t gl-px-5 lg:gl-hidden"><div class="gl-pt-4 gl-mt-4 lg:gl-pt-0 lg:gl-mt-0 lg:gl-border-t-0"><h1 id=skipTarget class=gl-mb-6>Downstream pipelines</h1></div><div data-elastic-include><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Free, Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><p>A downstream pipeline is any GitLab CI/CD pipeline triggered by another pipeline.
Downstream pipelines run independently and concurrently to the upstream pipeline
that triggered them.</p><ul><li>A <a href=/ci/pipelines/downstream_pipelines/#parent-child-pipelines>parent-child pipeline</a> is a downstream pipeline
triggered in the same project as the first pipeline.</li><li>A <a href=/ci/pipelines/downstream_pipelines/#multi-project-pipelines>multi-project pipeline</a> is a downstream pipeline triggered
in a different project than the first pipeline.</li></ul><p>You can sometimes use parent-child pipelines and multi-project pipelines for similar purposes,
but there are <a href=/ci/pipelines/pipeline_architectures/>key differences</a>.</p><p>A pipeline hierarchy can contain up to 1000 downstream pipelines by default.
For more information about this limit and how to change it, see <a href=/administration/instance_limits/#limit-pipeline-hierarchy-size>Limit pipeline hierarchy size</a>.</p><h2 id=parent-child-pipelines>Parent-child pipelines</h2><p>A parent pipeline is a pipeline that triggers a downstream pipeline in the same project.
The downstream pipeline is called a child pipeline.</p><p>Child pipelines:</p><ul><li>Run under the same project, ref, and commit SHA as the parent pipeline.</li><li>Do not directly affect the overall status of the ref the pipeline runs against. For example,
if a pipeline fails for the main branch, it&rsquo;s common to say that &ldquo;main is broken&rdquo;.
The status of child pipelines only affects the status of the ref if the child
pipeline is triggered with <a href=/ci/yaml/#triggerstrategy><code>trigger:strategy</code></a>.</li><li>Are automatically canceled if the pipeline is configured with <a href=/ci/yaml/#interruptible><code>interruptible</code></a>
when a new pipeline is created for the same ref.</li><li>Are not displayed in the project&rsquo;s pipeline list. You can only view child pipelines on
their parent pipeline&rsquo;s details page.</li></ul><h3 id=nested-child-pipelines>Nested child pipelines</h3><p>Parent and child pipelines have a maximum depth of two levels of child pipelines.</p><p>A parent pipeline can trigger many child pipelines, and these child pipelines can trigger
their own child pipelines. You cannot trigger another level of child pipelines.</p><p><i class="fa fa-youtube-play youtube" aria-hidden=true></i>
For an overview, see <a href=https://youtu.be/C5j3ju9je2M>Nested Dynamic Pipelines</a>.</p><h2 id=multi-project-pipelines>Multi-project pipelines</h2><p>A pipeline in one project can trigger downstream pipelines in another project,
called multi-project pipelines. The user triggering the upstream pipeline must be able to
start pipelines in the downstream project, otherwise <a href=/ci/pipelines/downstream_pipelines_troubleshooting/#trigger-job-fails-and-does-not-create-multi-project-pipeline>the downstream pipeline fails to start</a>.</p><p>Multi-project pipelines:</p><ul><li>Are triggered from another project&rsquo;s pipeline, but the upstream (triggering) pipeline does
not have much control over the downstream (triggered) pipeline. However, it can
choose the ref of the downstream pipeline, and pass CI/CD variables to it.</li><li>Affect the overall status of the ref of the project it runs in, but does not
affect the status of the triggering pipeline&rsquo;s ref, unless it was triggered with
<a href=/ci/yaml/#triggerstrategy><code>trigger:strategy</code></a>.</li><li>Are not automatically canceled in the downstream project when using <a href=/ci/yaml/#interruptible><code>interruptible</code></a>
if a new pipeline runs for the same ref in the upstream pipeline. They can be
automatically canceled if a new pipeline is triggered for the same ref on the downstream project.</li><li>Are visible in the downstream project&rsquo;s pipeline list.</li><li>Are independent, so there are no nesting limits.</li></ul><p>If you use a public project to trigger downstream pipelines in a private project,
make sure there are no confidentiality problems. The upstream project&rsquo;s pipelines page
always displays:</p><ul><li>The name of the downstream project.</li><li>The status of the pipeline.</li></ul><h2 id=trigger-a-downstream-pipeline-from-a-job-in-the-gitlab-ciyml-file>Trigger a downstream pipeline from a job in the <code>.gitlab-ci.yml</code> file</h2><p>Use the <a href=/ci/yaml/#trigger><code>trigger</code></a> keyword in your <code>.gitlab-ci.yml</code> file
to create a job that triggers a downstream pipeline. This job is called a trigger job.</p><p>For example:</p><div data-vue-app=docs-tabs><div class=tab><button class=tab-title>Parent-child pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger_job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline.yml</span></span></span></code></pre></div></div></div></div><div class=tab><button class=tab-title>Multi-project pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger_job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>project-group/my-downstream-project</span></span></span></code></pre></div></div></div></div></div><p>After the trigger job starts, the initial status of the job is <code>pending</code> while GitLab
attempts to create the downstream pipeline. The trigger job shows <code>passed</code> if the
downstream pipeline is created successfully, otherwise it shows <code>failed</code>. Alternatively,
you can <a href=/ci/pipelines/downstream_pipelines/#mirror-the-status-of-a-downstream-pipeline-in-the-trigger-job>set the trigger job to show the downstream pipeline&rsquo;s status</a>
instead.</p><h3 id=use-rules-to-control-downstream-pipeline-jobs>Use <code>rules</code> to control downstream pipeline jobs</h3><p>Use CI/CD variables or the <a href=/ci/yaml/#rulesif><code>rules</code></a> keyword to
<a href=/ci/jobs/job_control/>control job behavior</a> in downstream pipelines.</p><p>When you trigger a downstream pipeline with the <a href=/ci/yaml/#trigger><code>trigger</code></a> keyword,
the value of the <a href=/ci/variables/predefined_variables/><code>$CI_PIPELINE_SOURCE</code> predefined variable</a>
for all jobs is:</p><ul><li><code>pipeline</code> for multi-project pipelines.</li><li><code>parent_pipeline</code> for parent-child pipelines.</li></ul><p>For example, to control jobs in multi-project pipelines in a project that also runs
merge request pipelines:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>job1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;pipeline&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;This job runs in multi-project pipelines only&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;merge_request_event&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;This job runs in merge request pipelines only&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job3</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;pipeline&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;merge_request_event&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;This job runs in both multi-project and merge request pipelines&#34;</span></span></span></code></pre></div></div><h3 id=use-a-child-pipeline-configuration-file-in-a-different-project>Use a child pipeline configuration file in a different project</h3><p>You can use <a href=/ci/yaml/#includeproject><code>include:project</code></a> in a trigger job
to trigger child pipelines with a configuration file in a different project:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>microservice_a</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;my-group/my-pipeline-library&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;main&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;/path/to/child-pipeline.yml&#39;</span></span></span></code></pre></div></div><h3 id=combine-multiple-child-pipeline-configuration-files>Combine multiple child pipeline configuration files</h3><p>You can include up to three configuration files when defining a child pipeline. The child pipeline&rsquo;s
configuration is composed of all configuration files merged together:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>microservice_a</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/microservice_a.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>Jobs/SAST.gitlab-ci.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;my-group/my-pipeline-library&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;main&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;/path/to/child-pipeline.yml&#39;</span></span></span></code></pre></div></div><h3 id=dynamic-child-pipelines>Dynamic child pipelines</h3><p>You can trigger a child pipeline from a YAML file generated in a job, instead of a
static file saved in your project. This technique can be very powerful for generating pipelines
targeting content that changed or to build a matrix of targets and architectures.</p><p>The artifact containing the generated YAML file must be within <a href=/administration/instance_limits/#maximum-size-of-the-ci-artifacts-archive>instance limits</a>.</p><p><i class="fa fa-youtube-play youtube" aria-hidden=true></i>
For an overview, see <a href=https://youtu.be/nMdfus2JWHM>Create child pipelines using dynamically generated configurations</a>.</p><p>For an example project that generates a dynamic child pipeline, see
<a href=https://gitlab.com/gitlab-org/project-templates/jsonnet>Dynamic Child Pipelines with Jsonnet</a>.
This project shows how to use a data templating language to generate your <code>.gitlab-ci.yml</code> at runtime.
You can use a similar process for other templating languages like
<a href=https://dhall-lang.org/>Dhall</a> or <a href=https://get-ytt.io/>ytt</a>.</p><h4 id=trigger-a-dynamic-child-pipeline>Trigger a dynamic child pipeline</h4><p>To trigger a child pipeline from a dynamically generated configuration file:</p><ol><li><p>Generate the configuration file in a job and save it as an <a href=/ci/yaml/#artifactspaths>artifact</a>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>generate-config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>generate-ci-config &gt; generated-config.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>generated-config.yml</span></span></span></code></pre></div></div></li><li><p>Configure the trigger job to run after the job that generated the configuration file.
Set <code>include: artifact</code> to the generated artifact, and set <code>include: job</code> to
the job that created the artifact:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>child-pipeline</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>artifact</span><span class=p>:</span><span class=w> </span><span class=l>generated-config.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>job</span><span class=p>:</span><span class=w> </span><span class=l>generate-config</span></span></span></code></pre></div></div></li></ol><p>In this example, GitLab retrieves <code>generated-config.yml</code> and triggers a child pipeline
with the CI/CD configuration in that file.</p><p>The artifact path is parsed by GitLab, not the runner, so the path must match the
syntax for the OS running GitLab. If GitLab is running on Linux but using a Windows
runner for testing, the path separator for the trigger job is <code>/</code>. Other CI/CD
configuration for jobs that use the Windows runner, like scripts, use <code>\</code>.</p><p>You cannot use CI/CD variables in an <code>include</code> section in a dynamic child pipeline&rsquo;s configuration.</p><h3 id=run-child-pipelines-with-merge-request-pipelines>Run child pipelines with merge request pipelines</h3><p>Pipelines, including child pipelines, run as branch pipelines by default when not using
<a href=/ci/yaml/#rules><code>rules</code></a> or <a href=/ci/yaml/#workflowrules><code>workflow:rules</code></a>.
To configure child pipelines to run when triggered from a <a href=/ci/pipelines/merge_request_pipelines/>merge request (parent) pipeline</a>, use <code>rules</code> or <code>workflow:rules</code>.
For example, using <code>rules</code>:</p><ol><li><p>Set the parent pipeline&rsquo;s trigger job to run on merge requests:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger-child-pipeline-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline-configuration.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;merge_request_event&#34;</span></span></span></code></pre></div></div></li><li><p>Use <code>rules</code> to configure the child pipeline jobs to run when triggered by the parent pipeline:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>job1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;This child pipeline job runs any time the parent pipeline triggers it.&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;parent_pipeline&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;This child pipeline job runs only when the parent pipeline is a merge request pipeline&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_MERGE_REQUEST_ID</span></span></span></code></pre></div></div></li></ol><p>In child pipelines, <code>$CI_PIPELINE_SOURCE</code> always has a value of <code>parent_pipeline</code>, so:</p><ul><li>You can use <code>if: $CI_PIPELINE_SOURCE == "parent_pipeline"</code> to ensure child pipeline jobs always run.</li><li>You can&rsquo;t use <code>if: $CI_PIPELINE_SOURCE == "merge_request_event"</code> to configure child pipeline
jobs to run for merge request pipelines. Instead, use <code>if: $CI_MERGE_REQUEST_ID</code>
to set child pipeline jobs to run only when the parent pipeline is a merge request pipeline. The parent pipeline&rsquo;s
<a href=/ci/variables/predefined_variables/#predefined-variables-for-merge-request-pipelines><code>CI_MERGE_REQUEST_*</code> predefined variables</a>
are passed to the child pipeline jobs.</li></ul><h3 id=specify-a-branch-for-multi-project-pipelines>Specify a branch for multi-project pipelines</h3><p>You can specify the branch to use when triggering a multi-project pipeline. GitLab uses
the commit on the head of the branch to create the downstream pipeline. For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>staging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my/deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branch</span><span class=p>:</span><span class=w> </span><span class=l>stable-11-2</span></span></span></code></pre></div></div><p>Use:</p><ul><li>The <code>project</code> keyword to specify the full path to the downstream project.
In <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/367660>GitLab 15.3 and later</a>,
you can use <a href=/ci/variables/where_variables_can_be_used/#gitlab-ciyml-file>variable expansion</a>.</li><li>The <code>branch</code> keyword to specify the name of a branch or <a href=/user/project/repository/tags/>tag</a>
in the project specified by <code>project</code>. You can use variable expansion.</li></ul><h2 id=trigger-a-multi-project-pipeline-by-using-the-api>Trigger a multi-project pipeline by using the API</h2><p>You can use the <a href=/ci/jobs/ci_job_token/>CI/CD job token (<code>CI_JOB_TOKEN</code>)</a> with the
<a href=/api/pipeline_triggers/#trigger-a-pipeline-with-a-token>pipeline trigger API endpoint</a>
to trigger multi-project pipelines from inside a CI/CD job. GitLab sets pipelines triggered
with a job token as downstream pipelines of the pipeline that contains the job that
made the API call.</p><p>For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger_pipeline</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>curl --request POST --form &#34;token=$CI_JOB_TOKEN&#34; --form ref=main &#34;https://gitlab.example.com/api/v4/projects/9/trigger/pipeline&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_COMMIT_TAG</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class=l>production</span></span></span></code></pre></div></div><h2 id=view-a-downstream-pipeline>View a downstream pipeline</h2><p>In the <a href=/ci/pipelines/#pipeline-details>pipeline details page</a>, downstream pipelines display
as a list of cards on the right of the graph. From this view, you can:</p><ul><li>Select a trigger job to see the triggered downstream pipeline&rsquo;s jobs.</li><li>Select <strong>Expand jobs</strong> <span><svg role="img" aria-label="chevron-lg-right" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#chevron-lg-right"/><title>chevron-lg-right</title></svg> </span>on a pipeline card to expand the view
with the downstream pipeline&rsquo;s jobs. You can view one downstream pipeline at a time.</li><li>Hover over a pipeline card to have the job that triggered the downstream pipeline highlighted.</li></ul><h3 id=retry-failed-and-canceled-jobs-in-a-downstream-pipeline>Retry failed and canceled jobs in a downstream pipeline</h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-3 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-3>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-3 class="collapsible-list collapse" aria-hidden=true><ul><li>Retry from graph view <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/354974>introduced</a> in GitLab 15.0 <a href=/administration/feature_flags/>with a flag</a> named <code>downstream_retry_action</code>. Disabled by default.</li><li>Retry from graph view <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/357406>generally available and feature flag removed</a> in GitLab 15.1.</li></ul></div></div><p>To retry failed and canceled jobs, select <strong>Retry</strong> (<span> <svg role="img" aria-label="retry" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#retry"/><title>retry</title></svg> </span>):</p><ul><li>From the downstream pipeline&rsquo;s details page.</li><li>On the pipeline&rsquo;s card in the pipeline graph view.</li></ul><h3 id=recreate-a-downstream-pipeline>Recreate a downstream pipeline</h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-5 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-5>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-5 class="collapsible-list collapse" aria-hidden=true><ul><li>Retry trigger job from graph view <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/367547>introduced</a> in GitLab 15.10 <a href=/administration/feature_flags/>with a flag</a> named <code>ci_recreate_downstream_pipeline</code>. Disabled by default.</li><li><a href=https://gitlab.com/groups/gitlab-org/-/epics/6947>Generally available</a> in GitLab 15.11. Feature flag <code>ci_recreate_downstream_pipeline</code> removed.</li></ul></div></div><p>You can recreate a downstream pipeline by retrying its corresponding trigger job. The newly created downstream pipeline replaces the current downstream pipeline in the pipeline graph.</p><p>To recreate a downstream pipeline:</p><ul><li>Select <strong>Run again</strong> (<span> <svg role="img" aria-label="retry" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#retry"/><title>retry</title></svg> </span>) on the trigger job&rsquo;s card in the pipeline graph view.</li></ul><h3 id=cancel-a-downstream-pipeline>Cancel a downstream pipeline</h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-7 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-7>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-7 class="collapsible-list collapse" aria-hidden=true><ul><li>Retry from graph view <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/354974>introduced</a> in GitLab 15.0 <a href=/administration/feature_flags/>with a flag</a> named <code>downstream_retry_action</code>. Disabled by default.</li><li>Retry from graph view <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/357406>generally available and feature flag removed</a> in GitLab 15.1.</li></ul></div></div><p>To cancel a downstream pipeline that is still running, select <strong>Cancel</strong> (<span> <svg role="img" aria-label="cancel" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#cancel"/><title>cancel</title></svg> </span>):</p><ul><li>From the downstream pipeline&rsquo;s details page.</li><li>On the pipeline&rsquo;s card in the pipeline graph view.</li></ul><h3 id=auto-cancel-the-parent-pipeline-from-a-downstream-pipeline>Auto-cancel the parent pipeline from a downstream pipeline</h3><p>You can configure a child pipeline to <a href=/ci/yaml/#workflowauto_cancelon_job_failure>auto-cancel</a>
as soon as one of its jobs fail.</p><p>The parent pipeline only auto-cancels when a job in the child pipeline fails if:</p><ul><li>The parent pipeline is also set up to auto-cancel on job failure.</li><li>The trigger job is configured with <a href=/ci/yaml/#triggerstrategy><code>strategy: mirror</code></a>.</li></ul><p>For example:</p><ul><li><p>Content of <code>.gitlab-ci.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>workflow</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>auto_cancel</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>on_job_failure</span><span class=p>:</span><span class=w> </span><span class=l>all</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>trigger_job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=l>child-pipeline.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span><span class=l>mirror</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job3</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sleep 120</span></span></span></code></pre></div></div></li><li><p>Content of <code>child-pipeline.yml</code></p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Contents of child-pipeline.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>workflow</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>auto_cancel</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>on_job_failure</span><span class=p>:</span><span class=w> </span><span class=l>all</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>sleep 60</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sleep 30</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>exit 1</span></span></span></code></pre></div></div></li></ul><p>In this example:</p><ol><li>The parent pipeline triggers the child pipeline and <code>job3</code> at the same time</li><li><code>job2</code> from the child pipeline fails and the child pipeline is canceled, stopping <code>job1</code> as well</li><li>The child pipeline has been canceled so the parent pipeline is auto-canceled</li></ol><h3 id=mirror-the-status-of-a-downstream-pipeline-in-the-trigger-job>Mirror the status of a downstream pipeline in the trigger job</h3><p>You can mirror the status of the downstream pipeline in the trigger job
by using <a href=/ci/yaml/#triggerstrategy><code>strategy: mirror</code></a>:</p><div data-vue-app=docs-tabs><div class=tab><button class=tab-title>Parent-child pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger_job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span><span class=l>mirror</span></span></span></code></pre></div></div></div></div><div class=tab><button class=tab-title>Multi-project pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger_job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my/project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span><span class=l>mirror</span></span></span></code></pre></div></div></div></div></div><h3 id=view-multi-project-pipelines-in-pipeline-graphs>View multi-project pipelines in pipeline graphs</h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-10 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-10>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-10 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/422282>Moved</a> from GitLab Premium to GitLab Free in 16.8.</li></ul></div></div><p>After you trigger a multi-project pipeline, the downstream pipeline displays
to the right of the <a href=/ci/pipelines/#view-pipelines>pipeline graph</a>.</p><p>In <a href=/ci/pipelines/#pipeline-mini-graphs>pipeline mini graphs</a>, the downstream pipeline
displays to the right of the mini graph.</p><h2 id=view-child-pipeline-reports-in-merge-requests>View child pipeline reports in merge requests</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-11 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-11>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-11 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/groups/gitlab-org/-/epics/18311>Introduced</a> in GitLab 18.6.</li></ul></div></div><p>You can view reports from child pipelines in merge request widgets. This provides a
unified view of test results and quality checks across your pipeline hierarchy
without manually navigating through multiple pipelines to identify failures.</p><p>The following report types from child pipelines are supported:</p><ul><li>Unit test reports (Junit)</li><li>Code quality reports</li><li>Terraform reports</li><li>Metric reports</li></ul><p>Test results from child pipelines also appear in the parent pipeline&rsquo;s <strong>Tests</strong> tab.</p><p>To ensure complete report information in merge request widgets,
child pipelines that generate <a href=/ci/yaml/artifacts_reports/>artifacts reports</a> should use
<a href=/ci/yaml/#triggerstrategy><code>strategy: depend</code></a> or <a href=/ci/yaml/#triggerstrategy><code>strategy: mirror</code></a>.</p><p>For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>test-backend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=l>backend-tests.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span><span class=l>depend</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test-frontend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=l>frontend-tests.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span><span class=l>depend</span></span></span></code></pre></div></div><h2 id=fetch-artifacts-from-an-upstream-pipeline>Fetch artifacts from an upstream pipeline</h2><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><div data-vue-app=docs-tabs><div class=tab><button class=tab-title>Parent-child pipeline</button><div class=tab-content><p>Use <a href=/ci/yaml/#needspipelinejob><code>needs:pipeline:job</code></a> to fetch artifacts from an
upstream pipeline:</p><ol><li><p>In the upstream pipeline, save the artifacts in a job with the <a href=/ci/yaml/#artifacts><code>artifacts</code></a>
keyword, then trigger the downstream pipeline with a trigger job:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>build_artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;This is a test artifact!&#34; &gt;&gt; artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>PARENT_PIPELINE_ID</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_ID</span></span></span></code></pre></div></div></li><li><p>Use <code>needs:pipeline:job</code> in a job in the downstream pipeline to fetch the artifacts.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cat artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>needs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>pipeline</span><span class=p>:</span><span class=w> </span><span class=l>$PARENT_PIPELINE_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>job</span><span class=p>:</span><span class=w> </span><span class=l>build_artifacts</span></span></span></code></pre></div></div><p>Set <code>job</code> to the job in the upstream pipeline that created the artifacts.</p></li></ol></div></div><div class=tab><button class=tab-title>Multi-project pipeline</button><div class=tab-content><p>Use <a href=/ci/yaml/#needsproject><code>needs:project</code></a> to fetch artifacts from an
upstream pipeline:</p><ol><li><p>In GitLab 15.9 and later, <a href=/ci/jobs/ci_job_token/#add-a-group-or-project-to-the-job-token-allowlist>add the downstream project to the job token scope allowlist</a> of the upstream project.</p></li><li><p>In the upstream pipeline, save the artifacts in a job with the <a href=/ci/yaml/#artifacts><code>artifacts</code></a>
keyword, then trigger the downstream pipeline with a trigger job:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>build_artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;This is a test artifact!&#34; &gt;&gt; artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=l>my/downstream_project  </span><span class=w> </span><span class=c># Path to the project to trigger a pipeline in</span></span></span></code></pre></div></div></li><li><p>Use <code>needs:project</code> in a job in the downstream pipeline to fetch the artifacts.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cat artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>needs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my/upstream_project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>job</span><span class=p>:</span><span class=w> </span><span class=l>build_artifacts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>artifacts</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div><p>Set:</p><ul><li><code>job</code> to the job in the upstream pipeline that created the artifacts.</li><li><code>ref</code> to the branch.</li><li><code>artifacts</code> to <code>true</code>.</li></ul></li></ol></div></div></div><h3 id=fetch-artifacts-from-an-upstream-merge-request-pipeline>Fetch artifacts from an upstream merge request pipeline</h3><p>When you use <code>needs:project</code> to <a href=/ci/pipelines/downstream_pipelines/#fetch-artifacts-from-an-upstream-pipeline>pass artifacts to a downstream pipeline</a>,
the <code>ref</code> value is usually a branch name, like <code>main</code> or <code>development</code>.</p><p>For <a href=/ci/pipelines/merge_request_pipelines/>merge request pipelines</a>, the <code>ref</code> value is in the form of <code>refs/merge-requests/&lt;id>/head</code>,
where <code>id</code> is the merge request ID. You can retrieve this ref with the <a href=/ci/variables/predefined_variables/#predefined-variables-for-merge-request-pipelines><code>CI_MERGE_REQUEST_REF_PATH</code></a>
CI/CD variable. Do not use a branch name as the <code>ref</code> with merge request pipelines,
because the downstream pipeline attempts to fetch artifacts from the latest branch pipeline.</p><p>To fetch the artifacts from the upstream <code>merge request</code> pipeline instead of the <code>branch</code> pipeline,
pass <code>CI_MERGE_REQUEST_REF_PATH</code> to the downstream pipeline using <a href=/ci/pipelines/downstream_pipelines/#pass-yaml-defined-cicd-variables>variable inheritance</a>:</p><ol><li><p>In GitLab 15.9 and later, <a href=/ci/jobs/ci_job_token/#add-a-group-or-project-to-the-job-token-allowlist>add the downstream project to the job token scope allowlist</a> of the upstream project.</p></li><li><p>In a job in the upstream pipeline, save the artifacts using the <a href=/ci/yaml/#artifacts><code>artifacts</code></a> keyword.</p></li><li><p>In the job that triggers the downstream pipeline, pass the <code>$CI_MERGE_REQUEST_REF_PATH</code> variable:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>build_artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#39;merge_request_event&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;This is a test artifact!&#34; &gt;&gt; artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>upstream_job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#39;merge_request_event&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>UPSTREAM_REF</span><span class=p>:</span><span class=w> </span><span class=l>$CI_MERGE_REQUEST_REF_PATH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my/downstream_project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branch</span><span class=p>:</span><span class=w> </span><span class=l>my-branch</span></span></span></code></pre></div></div></li><li><p>In a job in the downstream pipeline, fetch the artifacts from the upstream pipeline
by using <code>needs:project</code> and the passed variable as the <code>ref</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cat artifact.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>needs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my/upstream_project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>job</span><span class=p>:</span><span class=w> </span><span class=l>build_artifacts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>$UPSTREAM_REF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>artifacts</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div></li></ol><p>You can use this method to fetch artifacts from upstream merge request pipelines,
but not from <a href=/ci/pipelines/merged_results_pipelines/>merged results pipelines</a>.</p><h2 id=pass-inputs-to-a-downstream-pipeline>Pass inputs to a downstream pipeline</h2><p>You can use the <a href=/ci/inputs/><code>inputs</code></a> keyword to pass input values to downstream pipelines.
Inputs provide advantages over variables including type checking, validation through options,
descriptions, and default values.</p><p>First, define input parameters in the target configuration file using <code>spec:inputs</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Target pipeline configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>inputs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Deployment environment&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>options</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>staging, production]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Application version&#34;</span></span></span></code></pre></div></div><p>Then provide values when triggering the pipeline:</p><div data-vue-app=docs-tabs><div class=tab><button class=tab-title>Parent-child pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>staging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>inputs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class=l>staging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.0.0&#34;</span></span></span></code></pre></div></div></div></div><div class=tab><button class=tab-title>Multi-project pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>staging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my-group/my-deployment-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>inputs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class=l>staging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.0.0&#34;</span></span></span></code></pre></div></div></div></div></div><h2 id=pass-cicd-variables-to-a-downstream-pipeline>Pass CI/CD variables to a downstream pipeline</h2><p>You can pass <a href=/ci/variables/>CI/CD variables</a> to a downstream pipeline with
a few different methods, based on where the variable is created or defined.</p><h3 id=pass-yaml-defined-cicd-variables>Pass YAML-defined CI/CD variables</h3><div class="alert alert-type-note gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>Inputs are recommended for pipeline configuration instead of variables as they offer improved security and flexibility.</p></div></div><p>You can use the <code>variables</code> keyword to pass CI/CD variables to a downstream pipeline.
These variables are pipeline variables for <a href=/ci/variables/#cicd-variable-precedence>variable precedence</a>.</p><p>For example:</p><div data-vue-app=docs-tabs><div class=tab><button class=tab-title>Parent-child pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>VERSION</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.0.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>staging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ENVIRONMENT</span><span class=p>:</span><span class=w> </span><span class=l>staging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline.yml</span></span></span></code></pre></div></div></div></div><div class=tab><button class=tab-title>Multi-project pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>VERSION</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.0.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>staging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ENVIRONMENT</span><span class=p>:</span><span class=w> </span><span class=l>staging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=l>my-group/my-deployment-project</span></span></span></code></pre></div></div></div></div></div><p>The <code>ENVIRONMENT</code> variable is available in every job defined in the downstream pipeline.</p><p>The <code>VERSION</code> default variable is also available in the downstream pipeline, because
all jobs in a pipeline, including trigger jobs, inherit <a href=/ci/yaml/#default-variables>default <code>variables</code></a>.</p><h4 id=prevent-default-variables-from-being-passed>Prevent default variables from being passed</h4><p>You can stop default CI/CD variables from reaching the downstream pipeline with
<a href=/ci/yaml/#inheritvariables><code>inherit:variables</code></a>. You can list specific variables to inherit,
or block all default variables.</p><p>For example:</p><div data-vue-app=docs-tabs><div class=tab><button class=tab-title>Parent-child pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>DEFAULT_VAR</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>trigger-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>inherit</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>variables</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>JOB_VAR</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline.yml</span></span></span></code></pre></div></div></div></div><div class=tab><button class=tab-title>Multi-project pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>DEFAULT_VAR</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>trigger-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>inherit</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>variables</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>JOB_VAR</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=l>my-group/my-project</span></span></span></code></pre></div></div></div></div></div><p>The <code>DEFAULT_VAR</code> variable is not available in the triggered pipeline, but <code>JOB_VAR</code>
is available.</p><h3 id=pass-a-predefined-variable>Pass a predefined variable</h3><p>To pass information about the upstream pipeline using <a href=/ci/variables/predefined_variables/>predefined CI/CD variables</a>
use interpolation. Save the predefined variable as a new job variable in the trigger
job, which is passed to the downstream pipeline. For example:</p><div data-vue-app=docs-tabs><div class=tab><button class=tab-title>Parent-child pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>PARENT_BRANCH</span><span class=p>:</span><span class=w> </span><span class=l>$CI_COMMIT_REF_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>path/to/child-pipeline.yml</span></span></span></code></pre></div></div></div></div><div class=tab><button class=tab-title>Multi-project pipeline</button><div class=tab-content><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>trigger-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>UPSTREAM_BRANCH</span><span class=p>:</span><span class=w> </span><span class=l>$CI_COMMIT_REF_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=l>my-group/my-project</span></span></span></code></pre></div></div></div></div></div><p>The <code>UPSTREAM_BRANCH</code> variable, which contains the value of the upstream pipeline&rsquo;s <code>$CI_COMMIT_REF_NAME</code>
predefined CI/CD variable, is available in the downstream pipeline.</p><p>Do not use this method to pass <a href=/ci/variables/#mask-a-cicd-variable>masked variables</a>
to a multi-project pipeline. The CI/CD masking configuration is not passed to the
downstream pipeline and the variable could be unmasked in job logs in the downstream project.</p><p>You cannot use this method to forward <a href=/ci/variables/predefined_variables/#variable-availability>job-only variables</a>
to a downstream pipeline, as they are not available in trigger jobs.</p><p>Upstream pipelines take precedence over downstream ones. If there are two
variables with the same name defined in both upstream and downstream projects,
the ones defined in the upstream project take precedence.</p><h3 id=pass-dotenv-variables-created-in-a-job>Pass dotenv variables created in a job</h3><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><p>You can pass variables to a downstream pipeline with <a href=/ci/variables/job_scripts/#pass-an-environment-variable-to-another-job><code>dotenv</code> variable inheritance</a>.</p><p>For example, in a <a href=/ci/pipelines/downstream_pipelines/#multi-project-pipelines>multi-project pipeline</a>:</p><ol><li><p>Save the variables in a <code>.env</code> file.</p></li><li><p>Save the <code>.env</code> file as a <code>dotenv</code> report.</p></li><li><p>Trigger the downstream pipeline.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>build_vars</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;BUILD_VERSION=hello&#34; &gt;&gt; build.env</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>reports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dotenv</span><span class=p>:</span><span class=w> </span><span class=l>build.env</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=l>my/downstream_project</span></span></span></code></pre></div></div></li><li><p>Set the <code>test</code> job in the downstream pipeline to inherit the variables from the <code>build_vars</code>
job in the upstream project with <code>needs</code>. The <code>test</code> job inherits the variables in the
<code>dotenv</code> report and it can access <code>BUILD_VERSION</code> in the script:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo $BUILD_VERSION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>needs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my/upstream_project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>job</span><span class=p>:</span><span class=w> </span><span class=l>build_vars</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>artifacts</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div></li></ol><h3 id=control-what-type-of-variables-to-forward-to-downstream-pipelines>Control what type of variables to forward to downstream pipelines</h3><p>Use the <a href=/ci/yaml/#triggerforward><code>trigger:forward</code> keyword</a> to specify
what type of variables to forward to the downstream pipeline. Forwarded variables
are considered trigger variables, which have the <a href=/ci/variables/#cicd-variable-precedence>highest precedence</a>.</p><h2 id=downstream-pipelines-for-deployments>Downstream pipelines for deployments</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-20 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-20>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-20 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/369061>Introduced</a> in GitLab 16.4.</li></ul></div></div><p>You can use the <a href=/ci/yaml/#environment><code>environment</code></a> keyword with <a href=/ci/yaml/#trigger><code>trigger</code></a>.
You might want to use <code>environment</code> from a trigger job if your deployment and application projects are separately managed.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>project-group/my-downstream-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w> </span><span class=l>production</span></span></span></code></pre></div></div><p>A downstream pipeline can provision infrastructure, deploy to a designated environment, and return the deployment status
to the upstream project.</p><p>You can <a href=/ci/environments/#view-environments-and-deployments>view the environment and deployment</a>
from the upstream project.</p><h3 id=advanced-example>Advanced example</h3><p>This example configuration has the following behaviors:</p><ul><li>The upstream project dynamically composes an environment name based on a branch name.</li><li>The upstream project passes the context of the deployment to the downstream project with <code>UPSTREAM_*</code> variables.</li></ul><p>The <code>.gitlab-ci.yml</code> in an upstream project:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>cleanup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>.downstream-deployment-pipeline</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>UPSTREAM_PROJECT_ID</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PROJECT_ID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>UPSTREAM_ENVIRONMENT_NAME</span><span class=p>:</span><span class=w> </span><span class=l>$CI_ENVIRONMENT_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>UPSTREAM_ENVIRONMENT_ACTION</span><span class=p>:</span><span class=w> </span><span class=l>$CI_ENVIRONMENT_ACTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>project-group/deployment-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branch</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span><span class=l>mirror</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>deploy-review</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.downstream-deployment-pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review/$CI_COMMIT_REF_SLUG</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>on_stop</span><span class=p>:</span><span class=w> </span><span class=l>stop-review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stop-review</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>cleanup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extends</span><span class=p>:</span><span class=w> </span><span class=l>.downstream-deployment-pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review/$CI_COMMIT_REF_SLUG</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>stop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>manual</span></span></span></code></pre></div></div><p>The <code>.gitlab-ci.yml</code> in a downstream project:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Deploy to ${UPSTREAM_ENVIRONMENT_NAME} for ${UPSTREAM_PROJECT_ID}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;pipeline&#34; &amp;&amp; $UPSTREAM_ENVIRONMENT_ACTION == &#34;start&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stop</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Stop ${UPSTREAM_ENVIRONMENT_NAME} for ${UPSTREAM_PROJECT_ID}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;pipeline&#34; &amp;&amp; $UPSTREAM_ENVIRONMENT_ACTION == &#34;stop&#34;</span></span></span></code></pre></div></div></div><div data-vue-app=back-to-top-button></div></div><div class="feedback gl-min-h-8" data-ga-section=feedback data-elastic-exclude><div data-component=docs-feedback></div></div></div><aside class=sidebar-right><div data-ga-section=toc data-vue-app=toc></div></aside></div></main><footer data-ga-section=footer><section data-ga-section=footer><div id=footer class="footer-section container gl-grid gl-grid-cols-2 gl-grid-rows-3 gl-grid-rows-auto gl-gap-8 lg:gl-grid-cols-5 lg:gl-grid-rows-1 lg:gl-justify-items-center gl-px-8 gl-py-8 lg:gl-py-10"><div class="gl-col-span-2 lg:gl-col-span-1 gl-row-start-1"><div class="docs-title gl-flex gl-items-center"><a href=/><img src=/gitlab-logo-footer.svg alt="GitLab Docs logo" class=logo width=176 height=24></a></div><ul class="docs-social gl-list-none gl-flex"><li><a href=https://www.facebook.com/gitlab class=facebook><span class=gl-sr-only>Facebook</span></a></li><li><a href=https://www.linkedin.com/company/gitlab-com class=linkedin><span class=gl-sr-only>LinkedIn</span></a></li><li><a href=https://twitter.com/gitlab class=twitter><span class=gl-sr-only>Twitter</span></a></li><li><a href=https://www.youtube.com/channel/UCnMGQ8QHMAnVIsI3xJrihhg class=youtube><span class=gl-sr-only>YouTube</span></a></li></ul><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="license noopener noreferrer" class=gl-mt-0><img src=/by-sa.svg alt="Creative Commons License" width=80 height=15></a></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Company</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/company/>About GitLab</a></li><li><a href=https://about.gitlab.com/pricing/>View pricing</a></li><li><a href=https://about.gitlab.com/free-trial/>Try GitLab for free</a></li></ul></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Feedback</div><ul class="gl-list-none gl-p-0"><li><a href=https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/ci/pipelines/downstream_pipelines.md>View page source</a></li><li><a href=https://gitlab.com/-/ide/project/gitlab-org/gitlab/edit/master/-/doc/ci/pipelines/downstream_pipelines.md>Edit in web IDE</a></li><li><a href=https://about.gitlab.com/community/contribute/>Contribute to GitLab</a></li><li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/new?issuable_template=Documentation">Suggest updates</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Help & Community</div><ul class="gl-list-none gl-p-0"><li><a href=https://university.gitlab.com/pages/certifications>Get certified</a></li><li><a href=https://about.gitlab.com/support/>Get support</a></li><li><a href="https://forum.gitlab.com/new-topic?title=topic%20title&amp;body=topic%20body&amp;tags=docs-feedback">Post on the GitLab forum</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Resources</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/terms/>Terms</a></li><li><a href=https://about.gitlab.com/privacy/>Privacy statement</a></li><li><a href=/legal/use_generative_ai/>Use of generative AI</a></li><li><a href=/legal/licensing_policy/>Acceptable use of user licenses</a></li><li><button id=ot-sdk-btn class=ot-sdk-show-settings></button></li></ul></div></div></section></footer><script type=module src=/vite/main.js></script><script async>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NJXWQL")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJXWQL" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script async>(function(){var e,t=!1;function n(){t===!1&&(t=!0,Munchkin.init("194-VVC-221",{useBeaconAPI:!0}))}e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://munchkin.marketo.net/munchkin.js",e.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&n()},e.onload=n,document.getElementsByTagName("head")[0].appendChild(e)})()</script><script async src=https://cdn.bizible.com/scripts/bizible.js></script><script async>_linkedin_partner_id="30694",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id),function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height=1 width=1 style=display:none alt src="https://dc.ads.linkedin.com/collect/?pid=30694&fmt=gif"></noscript></body></html>