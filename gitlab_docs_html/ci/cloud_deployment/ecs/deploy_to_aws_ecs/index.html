<!doctype html><html lang=en-us dir=ltr><head><script src=https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08></script><script type=text/javascript>function OptanonWrapper(){}</script><script>const callback=(e)=>{for(const t of e)t.type==="childList"&&t.addedNodes.forEach(e=>{e.nodeName==="IMG"&&document.querySelectorAll('img:not([src^="http"]):not([data-ot-ignore])').forEach(e=>{e.setAttribute("data-ot-ignore","")})})},config={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]},observer=new MutationObserver(callback);observer.observe(document.documentElement,config)</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GTM-NJXWQL"),gtag("consent","default",{analytics_storage:"granted",ad_storage:"granted",functionality_storage:"granted",wait_for_update:500}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",functionality_storage:"denied",region:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO","GB","PE","RU"],wait_for_update:500}),window.geofeed=e=>{dataLayer.push({event:"OneTrustCountryLoad",oneTrustCountryId:e.country.toString()})};const json=document.createElement("script");json.setAttribute("src","https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed"),document.head.appendChild(json)</script><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Deploy to Amazon Elastic Container Service | GitLab Docs</title><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=manifest href=/manifests/manifest.webmanifest><meta name=theme-color content="#FC6D26"><link rel=canonical href=https://docs.gitlab.com/ci/cloud_deployment/ecs/deploy_to_aws_ecs/><meta name=description content="Deploy a GitLab project to Amazon ECS. Containerize the application and set up continuous deployment, review apps, and security testing."><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"GitLab Docs","url":"https://docs.gitlab.com/"}</script><link rel=preload href=/gitlab_ui/fonts/GitLabSans.woff2 type=font/woff2 as=font crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabSans-Italic.woff2 crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabMono.woff2 crossorigin><link rel=stylesheet href=/gitlab_ui/ui/index.css><link rel=stylesheet href=/vite/main.css><link rel=stylesheet href=/css/syntax-dark.min.css id=syntax-dark-theme><link rel=stylesheet href=/css/syntax-light.min.css id=syntax-light-theme><script>(function(){const p="gitlab-docs-theme",g="gitlab-docs-layout",e={LIGHT:"light",DARK:"dark",AUTO:"auto"},i={FIXED:"fixed",FLUID:"fluid"},d="light",f="fixed";let r=!1;const t=localStorage?.getItem(p),m=localStorage?.getItem(g),l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?e.DARK:e.LIGHT;function h(){return t&&(t===e.LIGHT||t===e.DARK)?t:(t===e.AUTO&&(r=!0),l||d)}function u(){return m===i.FLUID?i.FLUID:f}const s=h(),c=u(),n=document.documentElement;n.classList.remove("gl-dark","gl-light"),n.classList.add(s===e.DARK?"gl-dark":"gl-light"),c===i.FLUID&&(n.classList.add("fluid"),n.classList.remove("fixed"));const a=document.getElementById("syntax-dark-theme"),o=document.getElementById("syntax-light-theme");a&&o&&(s===e.DARK?(a.disabled=!1,o.disabled=!0):(a.disabled=!0,o.disabled=!1)),window.__initialTheme=r?e.AUTO:s,window.__initialLayout=c})()</script><meta name=gitlab_docs_base_url content="/"><meta name=gitlab_docs_page_owner data-stage=Deploy data-group=Environments><meta class=elastic name=gitlab_docs_version content="18.6"><meta class=elastic name=gitlab_docs_section content="use_gitlab"><meta class=elastic name=gitlab_docs_breadcrumbs content="Use GitLab › Deploy and release your application › Deployments › Deploy to AWS"><script>window.pageMetadata={trail:[{path:"user/",title:"Use GitLab"},{path:"topics/release_your_application/",title:"Deploy and release your application"},{path:"ci/environments/deployments/",title:"Deployments"},{path:"ci/cloud_deployment/",title:"Deploy to AWS"},{path:"ci/cloud_deployment/ecs/deploy_to_aws_ecs/",title:"Deploy to Amazon ECS"}]}</script><meta name=gitlab_docs_legacy_path content="/ee/ci/cloud_deployment/ecs/deploy_to_aws_ecs.html"><meta name=gitlab_docs_hugo_launch_version content="17.9"><script>const ELASTIC_CLOUD_ID="gitlab-docs-website:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJDQwZTQyYTQzMTJiZjQyMzNiMzBiZTg0MTU5YjlkNmE1JGMxODg4Y2U5OTY0YzQzZjc5ZjQ1YTk5NDZmMjI0ODg0",ELASTIC_KEY="cDFpLWJaSUJXVHBqWWI4VGZKN3M6eENBSjl4WDRSRnlCUW94ajRQazhLQQ==",ELASTIC_INDEX="search-gitlab-docs-hugo"</script><script type=module src=/vite/elastic_search.js></script><script type=module src=/vite/history.js></script><script>const FS_IDENTIFIER="AIzaSyCLdi3jHHjkmLji9D8uj_RNPMHcdrYoIW4",RECAPTCHA_PUBLIC_KEY="6Le4R3UrAAAAALsIlK_siq0_UhPD-0rD-ImF1gfO"</script><meta name=google-site-verification content="AcGSBNaKDWnLgcYotlVibGy6STm2Y6_KJSaRxrA90xY"><meta name=google-site-verification content="6eFQOFLxYAer08ROqc3I-SAi44F9NmvH7PrUUBR3oCI"><meta name=google-site-verification content="xAUTWp3CDg-tU1LVVwsM9OrVhLR7L3SmiyKzkOuPNos"><meta name=google-site-verification content="F0zzwaMpiyWFcPQ1Lqu18qN3EnuQsqFXbySl_29yvHs"><meta name=google-site-verification content="nwo1bVaU0t9TZxZyM-aOI6-CofaH9GRL-uBPbdREWgc"><meta name=google-site-verification content="rWoHrtHEmIX0t28oOb1ZEDMYZb_EZA6rr6ZOl5otEPI"><meta name=google-site-verification content="fSxr8-uslxcuFL0N-oECp3Tm0RPNEGX97wbdayKOEL8"><meta name=google-site-verification content="ISxyLVnZqU8oY3jwrK7EO9o-2DOTvLJwPse7bZz6yhs"><meta name=google-site-verification content="x1WspIvz3ZHqS0gezfX_P-qiRDOeP2Oyrd68zrU2ErI"><meta name=google-site-verification content="DfXB2Za52GT3zs_vuLIAL4Mi3M3K4qxXcg7MAs0CUqo"><meta name=google-site-verification content="BCEBC2LC7A1NzO9Com1oBrWK88tV_QXfUL0i9mwXPL0"><meta name=google-site-verification content="a2lNcHMorfS43aoISjZt5_BBPo-H1UaTKMQdBgZO9iY"><meta name=google-site-verification content="0s16pP9MelY6wDHRf-izXb5pwLU01IogP-Uc_e8f3GU"><meta name=google-site-verification content="H474RNof35Xp8fLg02fZbg9Dzxdtfch6vtcjzpmUraU"><meta name=google-site-verification content="E0FlhpgBGeE7d1pQ6amdcIWPMDLDeu15-HLQVoDTguE"><meta name=google-site-verification content="opQd7_rXtPy-pX5CO_XZiztzeQEsXnB3j6Y1_dZAizA"><meta name=google-site-verification content="06Kq4AoXdmBOjOAkbPvnYGtSxnn4Q9QBqEO55PLlw5c"><meta name=google-site-verification content="djBBokRFSWV_VRlSE51V5TZSPzMC6hml5l-Sb22WglE"><meta name=google-site-verification content="UOW6nOsvbyMeIySuamzbws4kNC_WqehamWfoxxtKjZ8"><meta name=google-site-verification content="hXU1Gsdba74DUbvbdUHRl9o0cQeiwXIhAdIllOG6p8E"><meta name=google-site-verification content="YFeHIAPk9lE76ubVMeq4P0sQVnzo2-a4k1oU_bPY8yE"><meta name=google-site-verification content="h8ICI4eDkvXmYaGDuLTLoWuXnLn-KUkChqYB-roMRsw"><meta name=google-site-verification content="9QW7feFNlCpMLPm7vAWEU-v14vdzb0Bb3RAk-8e_a18"><meta name=google-site-verification content="26kXLBOjaYRb2UwzWTDl1I1nzA2NxMunhp7SUtxGV6E"><meta name=google-site-verification content="jr3C8t6vKGPyN9GV3esdHY_xGYyQaUNznIl-Un2RObA"><meta name=google-site-verification content="WdlBpRU0ec1ieKqrTY_772OhG23FY45VQ4Lv9DyLJ_Y"><meta name=google-site-verification content="n9i6B9q4Xjr_etK2nQGZH1msoo7vIv9SXV8SQLOUA7c"><meta name=zd-site-verification content="ony3w7hk1vs6tfyrc51mld"><meta name=zd-site-verification content="gtuq65qdzt6n31viazi6hj"></head><body data-elastic-exclude><nav data-ga-section=header data-elastic-exclude><div class="header-wrapper gl-w-full gl-fixed gl-z-4"><div class=header><div class="header-top gl-flex gl-items-center"><a href=#skipTarget class="gl-sr-only skip-link">Skip to main content</a>
<a class=navbar-logo href=/><span class=gl-sr-only>Go to GitLab Docs homepage</span></a><div class="mobile-header gl-w-full gl-text-base"><div class=mobile-header-overlay></div><div class="header-right collapse gl-z-4 gl-border-t lg:gl-border-0"><div class="search-wrapper lg:gl-ml-4 lg:gl-grow"><div class="js-elastic-search-form gl-spinner-container"><span role=status aria-label=Loading class="gl-ml-3 gl-align-text-bottom! gl-spinner gl-spinner gl-spinner-sm"></span></div></div><div class="gl-flex gl-flex-col gl-gap-3 gl-mt-5 lg:gl-mt-0 lg:gl-flex-row lg:gl-items-center gl-ml-auto"><a class="whats-new gl-button btn-default btn-default-tertiary gl-hidden lg:gl-block" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a><div data-vue-app=versions-menu></div><div data-vue-app=appearance-toggle class="gl-hidden lg:gl-block"></div><div class="gl-flex gl-justify-evenly lg:gl-justify-normal gl-items-center gl-gap-5"><a class="whats-new gl-button btn-default btn-default-tertiary gl-w-full lg:gl-hidden hover:gl-no-underline" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a>
<a class="free-trial-btn cta-button gl-button btn-confirm gl-w-full hover:gl-no-underline" href="https://gitlab.com/-/trial_registrations/new?glm_source=docs.gitlab.com&amp;amp;glm_content=navigation-cta-docs" target=_blank rel="noopener noreferrer" role=button>Get free trial</a></div></div></div></div><button class="navbar-toggle gl-button btn-default lg:gl-hidden" data-toggle=collapse data-target=.header-right>
<span class=navbar-toggle-icon></span>
<span class=gl-sr-only>Toggle menu</span></button></div><div class="header-bottom gl-border-t lg:gl-border-b"><ul class="subheader-menu gl-hidden lg:gl-flex gl-list-none gl-text-base gl-space-x-5 gl-py-4 gl-pl-0 gl-mb-0"><li><a href=/user/ class=active>Use GitLab</a></li><li><a href=/user/gitlab_duo/>GitLab Duo</a></li><li><a href=/api/>Extend</a></li><li><a href=/install/>Install</a></li><li><a href=/administration/>Administer</a></li><li><a href=/subscriptions/>Subscribe</a></li><li><a href=/development/>Contribute</a></li><li><a href=/solutions/>Solutions</a></li></ul></div></div></div></nav><main data-ga-section=content-body><div id=js-version-banner></div><div class="template-single gl-flex gl-h-full"><div class=side-nav data-ga-section=side-nav data-vue-app=sidebar-menu></div><div data-pagefind-body class=main-content><div class=docs-content><div class="gl-flex gl-h-5 gl-items-center gl-my-6"><div data-vue-app=open-sidebar></div><div data-vue-app=breadcrumb-nav></div></div><hr class="gl-border-t gl-px-5 lg:gl-hidden"><div class="gl-pt-4 gl-mt-4 lg:gl-pt-0 lg:gl-mt-0 lg:gl-border-t-0"><h1 id=skipTarget class=gl-mb-6>Deploy to Amazon Elastic Container Service</h1></div><div data-elastic-include><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Free, Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><p>This step-by-step guide helps you deploy a project hosted on GitLab.com to
the Amazon <a href=https://aws.amazon.com/ecs/>Elastic Container Service (ECS)</a>.</p><p>In this guide, you begin by creating an ECS cluster manually using the AWS console. You create and
deploy a simple application that you create from a GitLab template.</p><p>These instructions work for both GitLab.com and GitLab Self-Managed instances.
Ensure your own <a href=/ci/runners/>runners are configured</a>.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>An <a href=https://repost.aws/knowledge-center/create-and-activate-aws-account>AWS account</a>.
Sign in with an existing AWS account or create a new one.</li><li>In this guide, you create an infrastructure in <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html><code>us-east-2</code> region</a>.
You can use any region, but do not change it after you begin.</li></ul><h2 id=create-an-infrastructure-and-initial-deployment-on-aws>Create an infrastructure and initial deployment on AWS</h2><p>For deploying an application from GitLab, you must first create an infrastructure and initial
deployment on AWS.
This includes an <a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/clusters.html>ECS cluster</a>
and related components, such as
<a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html>ECS task definitions</a>,
<a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html>ECS services</a>,
and containerized application image.</p><p>For the first step here, you create a demo application from a project template.</p><h3 id=create-a-new-project-from-a-template>Create a new project from a template</h3><p>Use a GitLab project template to get started. As the name suggests, these projects provide a
bare-bones application built on some well-known frameworks.</p><ol><li>In GitLab on the left sidebar, at the top, select <strong>Create new</strong> (<span> <svg role="img" aria-label="plus" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#plus"/><title>plus</title></svg> </span>) and <strong>New project/repository</strong>. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this button is in the upper-right corner.</li><li>Select <strong>Create from template</strong>, where you can choose from a Ruby on Rails, Spring, or
NodeJS Express project. For this guide, use the Ruby on Rails template.</li><li>Give your project a name. In this example, it&rsquo;s named <code>ecs-demo</code>. Make it public so that you can
take advantage of the features available in the
<a href=https://about.gitlab.com/pricing/>GitLab Ultimate plan</a>.</li><li>Select <strong>Create project</strong>.</li></ol><p>Now that you created a demo project, you must containerize the application and push it to the
container registry.</p><h3 id=push-a-containerized-application-image-to-gitlab-container-registry>Push a containerized application image to GitLab container registry</h3><p><a href=https://aws.amazon.com/ecs/>ECS</a> is a container orchestration service, meaning that you must
provide a containerized application image during the infrastructure build. To do so, you can use
GitLab <a href=/topics/autodevops/stages/#auto-build>Auto Build</a>
and <a href=/user/packages/container_registry/>Container Registry</a>.</p><ol><li><p>On the left sidebar, select <strong>Search or go to</strong> and find your <code>ecs-demo</code> project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</p></li><li><p>Select <strong>Set up CI/CD</strong>. It brings you to a <code>.gitlab-ci.yml</code>
creation form.</p></li><li><p>Copy and paste the following content into the empty <code>.gitlab-ci.yml</code>. This defines
a pipeline for continuous deployment to ECS.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>AWS/Deploy-ECS.gitlab-ci.yml</span></span></span></code></pre></div></div></li><li><p>Select <strong>Commit Changes</strong>. It automatically triggers a new pipeline. In this pipeline, the <code>build</code>
job containerizes the application and pushes the image to <a href=/user/packages/container_registry/>GitLab container registry</a>.</p></li><li><p>Visit <strong>Deploy</strong> > <strong>Container Registry</strong>. Make sure the application image has been
pushed.</p><p><a href=/ci/cloud_deployment/ecs/img/registry_v13_10.png target=_blank rel="noopener noreferrer"><img alt="A containerized application image in the GitLab container registry." src=/ci/cloud_deployment/ecs/img/registry_v13_10.png></a></p></li></ol><p>Now you have a containerized application image that can be pulled from AWS. Next, you define the
spec of how this application image is used in AWS.</p><p>The <code>production_ecs</code> job fails because ECS Cluster is not connected yet. You can fix this
later.</p><h3 id=create-an-ecs-task-definition>Create an ECS task definition</h3><p><a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html>ECS Task definitions</a>
is a specification about how the application image is started by an <a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html>ECS service</a>.</p><ol><li><p>Go to <strong>ECS</strong> > <strong>Task Definitions</strong> on <a href=https://aws.amazon.com/>AWS console</a>.</p></li><li><p>Select <strong>Create new Task Definition</strong>.</p><p><a href=/ci/cloud_deployment/ecs/img/ecs-task-definitions_v13_10.png target=_blank rel="noopener noreferrer"><img alt="Task definitions page with a &lsquo;Create new task definition&rsquo; button." src=/ci/cloud_deployment/ecs/img/ecs-task-definitions_v13_10.png></a></p></li><li><p>Choose <strong>EC2</strong> as the launch type. Select <strong>Next Step</strong>.</p></li><li><p>Set <code>ecs_demo</code> to <strong>Task Definition Name</strong>.</p></li><li><p>Set <code>512</code> to <strong>Task Size</strong> > <strong>Task memory</strong> and <strong>Task CPU</strong>.</p></li><li><p>Select <strong>Container Definitions</strong> > <strong>Add container</strong>. This opens a container registration form.</p></li><li><p>Set <code>web</code> to <strong>Container name</strong>.</p></li><li><p>Set <code>registry.gitlab.com/&lt;your-namespace>/ecs-demo/master:latest</code> to <strong>Image</strong>.
Alternatively, you can copy and paste the image path from the <a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#push-a-containerized-application-image-to-gitlab-container-registry>GitLab container registry page</a>.</p><p><a href=/ci/cloud_deployment/ecs/img/container-name_v13_10.png target=_blank rel="noopener noreferrer"><img alt="Container name and image fields completed." src=/ci/cloud_deployment/ecs/img/container-name_v13_10.png></a></p></li><li><p>Add a port mapping. Set <code>80</code> to <strong>Host Port</strong> and <code>5000</code> to <strong>Container port</strong>.</p><p><a href=/ci/cloud_deployment/ecs/img/container-port-mapping_v13_10.png target=_blank rel="noopener noreferrer"><img alt="Port mappings fields completed." src=/ci/cloud_deployment/ecs/img/container-port-mapping_v13_10.png></a></p></li><li><p>Select <strong>Create</strong>.</p></li></ol><p>Now you have the initial task definition. Next, you create an actual infrastructure to run the
application image.</p><h3 id=create-an-ecs-cluster>Create an ECS cluster</h3><p>An <a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/clusters.html>ECS cluster</a>
is a virtual group of <a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html>ECS services</a>.
It&rsquo;s also associated with EC2 or Fargate as the computation resource.</p><ol><li><p>Go to <strong>ECS</strong> > <strong>Clusters</strong> on <a href=https://aws.amazon.com/>AWS console</a>.</p></li><li><p>Select <strong>Create Cluster</strong>.</p></li><li><p>Select <strong>EC2 Linux + Networking</strong> as the cluster template. Select <strong>Next Step</strong>.</p></li><li><p>Set <code>ecs-demo</code> to <strong>Cluster Name</strong>.</p></li><li><p>Choose the default <a href="https://aws.amazon.com/vpc/?vpc-blogs.sort-by=item.additionalFields.createdDate&amp;vpc-blogs.sort-order=desc">VPC</a>
in <strong>Networking</strong>. If there are no existing VPCs, you can leave it as-is to create a new one.</p></li><li><p>Set all available subnets of the VPC to <strong>Subnets</strong>.</p></li><li><p>Select <strong>Create</strong>.</p></li><li><p>Make sure that the ECS cluster has been successfully created.</p><p><a href=/ci/cloud_deployment/ecs/img/ecs-launch-status_v13_10.png target=_blank rel="noopener noreferrer"><img alt="ECS cluster created successfully with all instances running." src=/ci/cloud_deployment/ecs/img/ecs-launch-status_v13_10.png></a></p></li></ol><p>Now you can register an ECS service to the ECS cluster in the next step.</p><p>Note the following:</p><ul><li>Optionally, you can set a SSH key pair in the creation form. This allows you to SSH to the EC2
instance for debugging.</li><li>If you don&rsquo;t choose an existing VPC, it creates a new VPC by default. This could cause an error if
it reaches the maximum allowed number of internet gateways on your account.</li><li>The cluster requires an EC2 instance, meaning it costs you <a href=https://aws.amazon.com/ec2/pricing/on-demand/>according to the instance-type</a>.</li></ul><h3 id=create-an-ecs-service>Create an ECS Service</h3><p><a href=https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html>ECS service</a>
is a daemon to create an application container based on the <a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#create-an-ecs-task-definition>ECS task definition</a>.</p><ol><li><p>Go to <strong>ECS</strong> > <strong>Clusters</strong> > <strong>ecs-demo</strong> > <strong>Services</strong> on the <a href=https://aws.amazon.com/>AWS console</a></p></li><li><p>Select <strong>Deploy</strong>. This opens a service creation form.</p></li><li><p>Select <code>EC2</code> in <strong>Launch Type</strong>.</p></li><li><p>Set <code>ecs_demo</code> to <strong>Task definition</strong>. This corresponds to <a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#create-an-ecs-task-definition>the task definition you created previously</a>.</p></li><li><p>Set <code>ecs_demo</code> to <strong>Service name</strong>.</p></li><li><p>Set <code>1</code> to <strong>Desired tasks</strong>.</p><p><a href=/ci/cloud_deployment/ecs/img/service-parameter_v13_10.png target=_blank rel="noopener noreferrer"><img alt="Services page with all inputs completed." src=/ci/cloud_deployment/ecs/img/service-parameter_v13_10.png></a></p></li><li><p>Select <strong>Deploy</strong>.</p></li><li><p>Make sure that the created service is active.</p><p><a href=/ci/cloud_deployment/ecs/img/service-running_v13_10.png target=_blank rel="noopener noreferrer"><img alt="An active service running with tasks." src=/ci/cloud_deployment/ecs/img/service-running_v13_10.png></a></p></li></ol><p>The AWS console UI changes from time to time. If you can&rsquo;t find a relevant component in the
instructions, select the closest one.</p><h3 id=view-the-demo-application>View the demo application</h3><p>Now, the demo application is accessible from the internet.</p><ol><li><p>Go to <strong>EC2</strong> > <strong>Instances</strong> on the <a href=https://aws.amazon.com/>AWS console</a></p></li><li><p>Search by <code>ECS Instance</code> to find the corresponding EC2 instance that <a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#create-an-ecs-cluster>the ECS cluster created</a>.</p></li><li><p>Select the ID of the EC2 instance. This brings you to the instance detail page.</p></li><li><p>Copy <strong>Public IPv4 address</strong> and paste it in the browser. Now you can see the demo application
running.</p><p><a href=/ci/cloud_deployment/ecs/img/view-running-app_v13_10.png target=_blank rel="noopener noreferrer"><img alt="The demo application running in a browser." src=/ci/cloud_deployment/ecs/img/view-running-app_v13_10.png></a></p></li></ol><p>In this guide, HTTPS/SSL is <strong>not</strong> configured. You can access to the application through HTTP only
(for example, <code>http://&lt;ec2-ipv4-address></code>).</p><h2 id=set-up-continuous-deployment-from-gitlab>Set up Continuous Deployment from GitLab</h2><p>Now that you have an application running on ECS, you can set up continuous deployment from GitLab.</p><h3 id=create-a-new-iam-user-as-a-deployer>Create a new IAM user as a deployer</h3><p>For GitLab to access the ECS cluster, service, and task definition that you previously created, you must
create a deployer user on AWS:</p><ol><li><p>Go to <strong>IAM</strong> > <strong>Users</strong> on <a href=https://aws.amazon.com/>AWS console</a>.</p></li><li><p>Select <strong>Add user</strong>.</p></li><li><p>Set <code>ecs_demo</code> to <strong>User name</strong>.</p></li><li><p>Enable <strong>Programmatic access</strong> checkbox. Select <strong>Next: Permissions</strong>.</p></li><li><p>Select <code>Attach existing policies directly</code> in <strong>Set permissions</strong>.</p></li><li><p>Select <code>AmazonECS_FullAccess</code> from the policy list. Select <strong>Next: Tags</strong> and <strong>Next: Review</strong>.</p><p><a href=/ci/cloud_deployment/ecs/img/ecs-policy_v13_10.png target=_blank rel="noopener noreferrer"><img alt="A selected <code>AmazonECS_FullAccess</code> policy." src=/ci/cloud_deployment/ecs/img/ecs-policy_v13_10.png></a></p></li><li><p>Select <strong>Create user</strong>.</p></li><li><p>Take note of the <strong>Access key ID</strong> and <strong>Secret access key</strong> of the created user.</p></li></ol><div class="alert alert-type-note gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>Do not share the secret access key in a public place. You must save it in a secure place.</p></div></div><h3 id=setup-credentials-in-gitlab-to-let-pipeline-jobs-access-to-ecs>Setup credentials in GitLab to let pipeline jobs access to ECS</h3><p>You can register the access information in <a href=/ci/variables/>GitLab CI/CD Variables</a>.
These variables are injected into the pipeline jobs and can access the ECS API.</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your <code>ecs-demo</code> project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Go to <strong>Settings</strong> > <strong>CI/CD</strong> > <strong>Variables</strong>.</li><li>Select <strong>Add Variable</strong> and set the following key-value pairs.<table><thead><tr><th>Key</th><th>Value</th><th>Note</th></tr></thead><tbody><tr><td><code>AWS_ACCESS_KEY_ID</code></td><td><code>&lt;Access key ID of the deployer></code></td><td>For authenticating <code>aws</code> CLI.</td></tr><tr><td><code>AWS_SECRET_ACCESS_KEY</code></td><td><code>&lt;Secret access key of the deployer></code></td><td>For authenticating <code>aws</code> CLI.</td></tr><tr><td><code>AWS_DEFAULT_REGION</code></td><td><code>us-east-2</code></td><td>For authenticating <code>aws</code> CLI.</td></tr><tr><td><code>CI_AWS_ECS_CLUSTER</code></td><td><code>ecs-demo</code></td><td>The ECS cluster is accessed by <code>production_ecs</code> job.</td></tr><tr><td><code>CI_AWS_ECS_SERVICE</code></td><td><code>ecs_demo</code></td><td>The ECS service of the cluster is updated by <code>production_ecs</code> job. Ensure that this variable is scoped to the appropriate environment (<code>production</code>, <code>staging</code>, <code>review/*</code>).</td></tr><tr><td><code>CI_AWS_ECS_TASK_DEFINITION</code></td><td><code>ecs_demo</code></td><td>The ECS task definition is updated by <code>production_ecs</code> job.</td></tr></tbody></table></li></ol><h3 id=make-a-change-to-the-demo-application>Make a change to the demo application</h3><p>Change a file in the project and see if it&rsquo;s reflected in the demo application on ECS:</p><ol><li><p>On the left sidebar, select <strong>Search or go to</strong> and find your <code>ecs-demo</code> project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</p></li><li><p>Open the <code>app/views/welcome/index.html.erb</code> file.</p></li><li><p>Select <strong>Edit</strong>.</p></li><li><p>Change the text to <code>You're on ECS!</code>.</p></li><li><p>Select <strong>Commit Changes</strong>. This automatically triggers a new pipeline. Wait until it finishes.</p></li><li><p><a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#view-the-demo-application>Access the running application on the ECS cluster</a>. You should see
this:</p><p><a href=/ci/cloud_deployment/ecs/img/view-running-app-2_v13_10.png target=_blank rel="noopener noreferrer"><img alt="Application running on ECS with a confirmation message." src=/ci/cloud_deployment/ecs/img/view-running-app-2_v13_10.png></a></p></li></ol><p>Congratulations! You successfully set up continuous deployment to ECS.</p><div class="alert alert-type-note gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>ECS deploy jobs wait for the rollout to complete before exiting. To disable this behavior,
set <code>CI_AWS_ECS_WAIT_FOR_ROLLOUT_COMPLETE_DISABLED</code> to a non-empty value.</p></div></div><h2 id=set-up-review-apps>Set up review apps</h2><p>To use review apps with ECS:</p><ol><li>Set up a new <a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#create-an-ecs-service>service</a>.</li><li>Use the <code>CI_AWS_ECS_SERVICE</code> variable to set the name.</li><li>Set the environment scope to <code>review/*</code>.</li></ol><p>Only one Review App at a time can be deployed because this service is shared by all review apps.</p><h2 id=set-up-security-testing>Set up Security Testing</h2><h3 id=configure-sast>Configure SAST</h3><p>To use <a href=/user/application_security/sast/>SAST</a> with ECS, add the following to your <code>.gitlab-ci.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>Jobs/SAST.gitlab-ci.yml</span></span></span></code></pre></div></div><p>For more details and configuration options, see the <a href=/user/application_security/sast/#configuration>SAST documentation</a>.</p><h3 id=configure-dast>Configure DAST</h3><p>To use <a href=/user/application_security/dast/>DAST</a> on non-default branches, <a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#set-up-review-apps>set up review apps</a>
and add the following to your <code>.gitlab-ci.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>Security/DAST.gitlab-ci.yml</span></span></span></code></pre></div></div><p>To use DAST on the default branch:</p><ol><li>Set up a new <a href=/ci/cloud_deployment/ecs/deploy_to_aws_ecs/#create-an-ecs-service>service</a>. This service will be used to deploy a temporary
DAST environment.</li><li>Use the <code>CI_AWS_ECS_SERVICE</code> variable to set the name.</li><li>Set the scope to the <code>dast-default</code> environment.</li><li>Add the following to your <code>.gitlab-ci.yml</code> file:</li></ol><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>Security/DAST.gitlab-ci.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>Jobs/DAST-Default-Branch-Deploy.gitlab-ci.yml</span></span></span></code></pre></div></div><p>For more details and configuration options, see the <a href=/user/application_security/dast/>DAST documentation</a>.</p><h2 id=further-reading>Further reading</h2><ul><li>If you&rsquo;re interested in more of the continuous deployments to clouds, see <a href=/ci/cloud_deployment/>cloud deployments</a>.</li><li>If you want to quickly set up DevSecOps in your project, see <a href=/topics/autodevops/>Auto DevOps</a>.</li><li>If you want to quickly set up the production-grade environment, see <a href=https://gitlab.com/gitlab-org/5-minute-production-app/deploy-template/-/blob/master/README.md>the 5 Minute Production App</a>.</li></ul></div><div data-vue-app=back-to-top-button></div></div><div class="feedback gl-min-h-8" data-ga-section=feedback data-elastic-exclude><div data-component=docs-feedback></div></div></div><aside class=sidebar-right><div data-ga-section=toc data-vue-app=toc></div></aside></div></main><footer data-ga-section=footer><section data-ga-section=footer><div id=footer class="footer-section container gl-grid gl-grid-cols-2 gl-grid-rows-3 gl-grid-rows-auto gl-gap-8 lg:gl-grid-cols-5 lg:gl-grid-rows-1 lg:gl-justify-items-center gl-px-8 gl-py-8 lg:gl-py-10"><div class="gl-col-span-2 lg:gl-col-span-1 gl-row-start-1"><div class="docs-title gl-flex gl-items-center"><a href=/><img src=/gitlab-logo-footer.svg alt="GitLab Docs logo" class=logo width=176 height=24></a></div><ul class="docs-social gl-list-none gl-flex"><li><a href=https://www.facebook.com/gitlab class=facebook><span class=gl-sr-only>Facebook</span></a></li><li><a href=https://www.linkedin.com/company/gitlab-com class=linkedin><span class=gl-sr-only>LinkedIn</span></a></li><li><a href=https://twitter.com/gitlab class=twitter><span class=gl-sr-only>Twitter</span></a></li><li><a href=https://www.youtube.com/channel/UCnMGQ8QHMAnVIsI3xJrihhg class=youtube><span class=gl-sr-only>YouTube</span></a></li></ul><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="license noopener noreferrer" class=gl-mt-0><img src=/by-sa.svg alt="Creative Commons License" width=80 height=15></a></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Company</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/company/>About GitLab</a></li><li><a href=https://about.gitlab.com/pricing/>View pricing</a></li><li><a href=https://about.gitlab.com/free-trial/>Try GitLab for free</a></li></ul></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Feedback</div><ul class="gl-list-none gl-p-0"><li><a href=https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/ci/cloud_deployment/ecs/deploy_to_aws_ecs.md>View page source</a></li><li><a href=https://gitlab.com/-/ide/project/gitlab-org/gitlab/edit/master/-/doc/ci/cloud_deployment/ecs/deploy_to_aws_ecs.md>Edit in web IDE</a></li><li><a href=https://about.gitlab.com/community/contribute/>Contribute to GitLab</a></li><li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/new?issuable_template=Documentation">Suggest updates</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Help & Community</div><ul class="gl-list-none gl-p-0"><li><a href=https://university.gitlab.com/pages/certifications>Get certified</a></li><li><a href=https://about.gitlab.com/support/>Get support</a></li><li><a href="https://forum.gitlab.com/new-topic?title=topic%20title&amp;body=topic%20body&amp;tags=docs-feedback">Post on the GitLab forum</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Resources</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/terms/>Terms</a></li><li><a href=https://about.gitlab.com/privacy/>Privacy statement</a></li><li><a href=/legal/use_generative_ai/>Use of generative AI</a></li><li><a href=/legal/licensing_policy/>Acceptable use of user licenses</a></li><li><button id=ot-sdk-btn class=ot-sdk-show-settings></button></li></ul></div></div></section></footer><script type=module src=/vite/main.js></script><script async>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NJXWQL")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJXWQL" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script async>(function(){var e,t=!1;function n(){t===!1&&(t=!0,Munchkin.init("194-VVC-221",{useBeaconAPI:!0}))}e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://munchkin.marketo.net/munchkin.js",e.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&n()},e.onload=n,document.getElementsByTagName("head")[0].appendChild(e)})()</script><script async src=https://cdn.bizible.com/scripts/bizible.js></script><script async>_linkedin_partner_id="30694",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id),function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height=1 width=1 style=display:none alt src="https://dc.ads.linkedin.com/collect/?pid=30694&fmt=gif"></noscript></body></html>