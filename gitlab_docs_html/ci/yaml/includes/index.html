<!doctype html><html lang=en-us dir=ltr><head><script src=https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08></script><script type=text/javascript>function OptanonWrapper(){}</script><script>const callback=(e)=>{for(const t of e)t.type==="childList"&&t.addedNodes.forEach(e=>{e.nodeName==="IMG"&&document.querySelectorAll('img:not([src^="http"]):not([data-ot-ignore])').forEach(e=>{e.setAttribute("data-ot-ignore","")})})},config={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]},observer=new MutationObserver(callback);observer.observe(document.documentElement,config)</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GTM-NJXWQL"),gtag("consent","default",{analytics_storage:"granted",ad_storage:"granted",functionality_storage:"granted",wait_for_update:500}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",functionality_storage:"denied",region:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO","GB","PE","RU"],wait_for_update:500}),window.geofeed=e=>{dataLayer.push({event:"OneTrustCountryLoad",oneTrustCountryId:e.country.toString()})};const json=document.createElement("script");json.setAttribute("src","https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed"),document.head.appendChild(json)</script><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Use CI/CD configuration from other files | GitLab Docs</title><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=manifest href=/manifests/manifest.webmanifest><meta name=theme-color content="#FC6D26"><link rel=canonical href=https://docs.gitlab.com/ci/yaml/includes/><meta name=description content="Use the `include` keyword to extend your CI/CD configuration with content from other YAML files."><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"GitLab Docs","url":"https://docs.gitlab.com/"}</script><link rel=preload href=/gitlab_ui/fonts/GitLabSans.woff2 type=font/woff2 as=font crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabSans-Italic.woff2 crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabMono.woff2 crossorigin><link rel=stylesheet href=/gitlab_ui/ui/index.css><link rel=stylesheet href=/vite/main.css><link rel=stylesheet href=/css/syntax-dark.min.css id=syntax-dark-theme><link rel=stylesheet href=/css/syntax-light.min.css id=syntax-light-theme><script>(function(){const p="gitlab-docs-theme",g="gitlab-docs-layout",e={LIGHT:"light",DARK:"dark",AUTO:"auto"},i={FIXED:"fixed",FLUID:"fluid"},d="light",f="fixed";let r=!1;const t=localStorage?.getItem(p),m=localStorage?.getItem(g),l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?e.DARK:e.LIGHT;function h(){return t&&(t===e.LIGHT||t===e.DARK)?t:(t===e.AUTO&&(r=!0),l||d)}function u(){return m===i.FLUID?i.FLUID:f}const s=h(),c=u(),n=document.documentElement;n.classList.remove("gl-dark","gl-light"),n.classList.add(s===e.DARK?"gl-dark":"gl-light"),c===i.FLUID&&(n.classList.add("fluid"),n.classList.remove("fixed"));const a=document.getElementById("syntax-dark-theme"),o=document.getElementById("syntax-light-theme");a&&o&&(s===e.DARK?(a.disabled=!1,o.disabled=!0):(a.disabled=!0,o.disabled=!1)),window.__initialTheme=r?e.AUTO:s,window.__initialLayout=c})()</script><meta name=gitlab_docs_base_url content="/"><meta name=gitlab_docs_page_owner data-stage=Verify data-group="Pipeline Authoring"><meta class=elastic name=gitlab_docs_version content="18.6"><meta class=elastic name=gitlab_docs_section content="use_gitlab"><meta class=elastic name=gitlab_docs_breadcrumbs content="Use GitLab › Use CI/CD to build your application › CI/CD YAML syntax reference"><script>window.pageMetadata={trail:[{path:"user/",title:"Use GitLab"},{path:"topics/build_your_application/",title:"Use CI/CD to build your application"},{path:"ci/yaml/",title:"CI/CD YAML syntax reference"},{path:"ci/yaml/includes/",title:"Include examples"}]}</script><meta name=gitlab_docs_legacy_path content="/ee/ci/yaml/includes.html"><meta name=gitlab_docs_hugo_launch_version content="17.9"><script>const ELASTIC_CLOUD_ID="gitlab-docs-website:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJDQwZTQyYTQzMTJiZjQyMzNiMzBiZTg0MTU5YjlkNmE1JGMxODg4Y2U5OTY0YzQzZjc5ZjQ1YTk5NDZmMjI0ODg0",ELASTIC_KEY="cDFpLWJaSUJXVHBqWWI4VGZKN3M6eENBSjl4WDRSRnlCUW94ajRQazhLQQ==",ELASTIC_INDEX="search-gitlab-docs-hugo"</script><script type=module src=/vite/elastic_search.js></script><script type=module src=/vite/history.js></script><script>const FS_IDENTIFIER="AIzaSyCLdi3jHHjkmLji9D8uj_RNPMHcdrYoIW4",RECAPTCHA_PUBLIC_KEY="6Le4R3UrAAAAALsIlK_siq0_UhPD-0rD-ImF1gfO"</script><meta name=google-site-verification content="AcGSBNaKDWnLgcYotlVibGy6STm2Y6_KJSaRxrA90xY"><meta name=google-site-verification content="6eFQOFLxYAer08ROqc3I-SAi44F9NmvH7PrUUBR3oCI"><meta name=google-site-verification content="xAUTWp3CDg-tU1LVVwsM9OrVhLR7L3SmiyKzkOuPNos"><meta name=google-site-verification content="F0zzwaMpiyWFcPQ1Lqu18qN3EnuQsqFXbySl_29yvHs"><meta name=google-site-verification content="nwo1bVaU0t9TZxZyM-aOI6-CofaH9GRL-uBPbdREWgc"><meta name=google-site-verification content="rWoHrtHEmIX0t28oOb1ZEDMYZb_EZA6rr6ZOl5otEPI"><meta name=google-site-verification content="fSxr8-uslxcuFL0N-oECp3Tm0RPNEGX97wbdayKOEL8"><meta name=google-site-verification content="ISxyLVnZqU8oY3jwrK7EO9o-2DOTvLJwPse7bZz6yhs"><meta name=google-site-verification content="x1WspIvz3ZHqS0gezfX_P-qiRDOeP2Oyrd68zrU2ErI"><meta name=google-site-verification content="DfXB2Za52GT3zs_vuLIAL4Mi3M3K4qxXcg7MAs0CUqo"><meta name=google-site-verification content="BCEBC2LC7A1NzO9Com1oBrWK88tV_QXfUL0i9mwXPL0"><meta name=google-site-verification content="a2lNcHMorfS43aoISjZt5_BBPo-H1UaTKMQdBgZO9iY"><meta name=google-site-verification content="0s16pP9MelY6wDHRf-izXb5pwLU01IogP-Uc_e8f3GU"><meta name=google-site-verification content="H474RNof35Xp8fLg02fZbg9Dzxdtfch6vtcjzpmUraU"><meta name=google-site-verification content="E0FlhpgBGeE7d1pQ6amdcIWPMDLDeu15-HLQVoDTguE"><meta name=google-site-verification content="opQd7_rXtPy-pX5CO_XZiztzeQEsXnB3j6Y1_dZAizA"><meta name=google-site-verification content="06Kq4AoXdmBOjOAkbPvnYGtSxnn4Q9QBqEO55PLlw5c"><meta name=google-site-verification content="djBBokRFSWV_VRlSE51V5TZSPzMC6hml5l-Sb22WglE"><meta name=google-site-verification content="UOW6nOsvbyMeIySuamzbws4kNC_WqehamWfoxxtKjZ8"><meta name=google-site-verification content="hXU1Gsdba74DUbvbdUHRl9o0cQeiwXIhAdIllOG6p8E"><meta name=google-site-verification content="YFeHIAPk9lE76ubVMeq4P0sQVnzo2-a4k1oU_bPY8yE"><meta name=google-site-verification content="h8ICI4eDkvXmYaGDuLTLoWuXnLn-KUkChqYB-roMRsw"><meta name=google-site-verification content="9QW7feFNlCpMLPm7vAWEU-v14vdzb0Bb3RAk-8e_a18"><meta name=google-site-verification content="26kXLBOjaYRb2UwzWTDl1I1nzA2NxMunhp7SUtxGV6E"><meta name=google-site-verification content="jr3C8t6vKGPyN9GV3esdHY_xGYyQaUNznIl-Un2RObA"><meta name=google-site-verification content="WdlBpRU0ec1ieKqrTY_772OhG23FY45VQ4Lv9DyLJ_Y"><meta name=google-site-verification content="n9i6B9q4Xjr_etK2nQGZH1msoo7vIv9SXV8SQLOUA7c"><meta name=zd-site-verification content="ony3w7hk1vs6tfyrc51mld"><meta name=zd-site-verification content="gtuq65qdzt6n31viazi6hj"></head><body data-elastic-exclude><nav data-ga-section=header data-elastic-exclude><div class="header-wrapper gl-w-full gl-fixed gl-z-4"><div class=header><div class="header-top gl-flex gl-items-center"><a href=#skipTarget class="gl-sr-only skip-link">Skip to main content</a>
<a class=navbar-logo href=/><span class=gl-sr-only>Go to GitLab Docs homepage</span></a><div class="mobile-header gl-w-full gl-text-base"><div class=mobile-header-overlay></div><div class="header-right collapse gl-z-4 gl-border-t lg:gl-border-0"><div class="search-wrapper lg:gl-ml-4 lg:gl-grow"><div class="js-elastic-search-form gl-spinner-container"><span role=status aria-label=Loading class="gl-ml-3 gl-align-text-bottom! gl-spinner gl-spinner gl-spinner-sm"></span></div></div><div class="gl-flex gl-flex-col gl-gap-3 gl-mt-5 lg:gl-mt-0 lg:gl-flex-row lg:gl-items-center gl-ml-auto"><a class="whats-new gl-button btn-default btn-default-tertiary gl-hidden lg:gl-block" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a><div data-vue-app=versions-menu></div><div data-vue-app=appearance-toggle class="gl-hidden lg:gl-block"></div><div class="gl-flex gl-justify-evenly lg:gl-justify-normal gl-items-center gl-gap-5"><a class="whats-new gl-button btn-default btn-default-tertiary gl-w-full lg:gl-hidden hover:gl-no-underline" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a>
<a class="free-trial-btn cta-button gl-button btn-confirm gl-w-full hover:gl-no-underline" href="https://gitlab.com/-/trial_registrations/new?glm_source=docs.gitlab.com&amp;amp;glm_content=navigation-cta-docs" target=_blank rel="noopener noreferrer" role=button>Get free trial</a></div></div></div></div><button class="navbar-toggle gl-button btn-default lg:gl-hidden" data-toggle=collapse data-target=.header-right>
<span class=navbar-toggle-icon></span>
<span class=gl-sr-only>Toggle menu</span></button></div><div class="header-bottom gl-border-t lg:gl-border-b"><ul class="subheader-menu gl-hidden lg:gl-flex gl-list-none gl-text-base gl-space-x-5 gl-py-4 gl-pl-0 gl-mb-0"><li><a href=/user/ class=active>Use GitLab</a></li><li><a href=/user/gitlab_duo/>GitLab Duo</a></li><li><a href=/api/>Extend</a></li><li><a href=/install/>Install</a></li><li><a href=/administration/>Administer</a></li><li><a href=/subscriptions/>Subscribe</a></li><li><a href=/development/>Contribute</a></li><li><a href=/solutions/>Solutions</a></li></ul></div></div></div></nav><main data-ga-section=content-body><div id=js-version-banner></div><div class="template-single gl-flex gl-h-full"><div class=side-nav data-ga-section=side-nav data-vue-app=sidebar-menu></div><div data-pagefind-body class=main-content><div class=docs-content><div class="gl-flex gl-h-5 gl-items-center gl-my-6"><div data-vue-app=open-sidebar></div><div data-vue-app=breadcrumb-nav></div></div><hr class="gl-border-t gl-px-5 lg:gl-hidden"><div class="gl-pt-4 gl-mt-4 lg:gl-pt-0 lg:gl-mt-0 lg:gl-border-t-0"><h1 id=skipTarget class=gl-mb-6>Use CI/CD configuration from other files</h1></div><div data-elastic-include><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Free, Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><p>You can use <a href=/ci/yaml/#include><code>include</code></a> to include external YAML files in your CI/CD jobs.</p><h2 id=include-a-single-configuration-file>Include a single configuration file</h2><p>To include a single configuration file, use <code>include</code> by itself with a single file
with either of these syntax options:</p><ul><li><p>On the same line:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;my-config.yml&#39;</span></span></span></code></pre></div></div></li><li><p>As a single item in an array:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s1>&#39;my-config.yml&#39;</span></span></span></code></pre></div></div></li></ul><p>If the file is a local file, the behavior is the same as <a href=/ci/yaml/#includelocal><code>include:local</code></a>.
If the file is a remote file, it is the same as <a href=/ci/yaml/#includeremote><code>include:remote</code></a>.</p><h2 id=include-an-array-of-configuration-files>Include an array of configuration files</h2><p>You can include an array of configuration files:</p><ul><li><p>If you do not specify an <code>include</code> type, each array item defaults to <a href=/ci/yaml/#includelocal><code>include:local</code></a>
or <a href=/ci/yaml/#includeremote><code>include:remote</code></a>, as needed:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s1>&#39;https://gitlab.com/awesome-project/raw/main/.before-script-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s1>&#39;templates/.after-script-template.yml&#39;</span></span></span></code></pre></div></div></li><li><p>You can define a single item array:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>remote</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;https://gitlab.com/awesome-project/raw/main/.before-script-template.yml&#39;</span></span></span></code></pre></div></div></li><li><p>You can define an array and explicitly specify multiple <code>include</code> types:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>remote</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;https://gitlab.com/awesome-project/raw/main/.before-script-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;templates/.after-script-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>Auto-DevOps.gitlab-ci.yml</span></span></span></code></pre></div></div></li><li><p>You can define an array that combines both default and specific <code>include</code> types:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s1>&#39;https://gitlab.com/awesome-project/raw/main/.before-script-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s1>&#39;templates/.after-script-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>Auto-DevOps.gitlab-ci.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;my-group/my-project&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;templates/.gitlab-ci-template.yml&#39;</span></span></span></code></pre></div></div></li></ul><h2 id=use-default-configuration-from-an-included-configuration-file>Use <code>default</code> configuration from an included configuration file</h2><p>You can define a <a href=/ci/yaml/#default><code>default</code></a> section in a
configuration file. When you use a <code>default</code> section with the <code>include</code> keyword, the defaults apply to
all jobs in the pipeline.</p><p>For example, you can use a <code>default</code> section with <a href=/ci/yaml/#before_script><code>before_script</code></a>.</p><p>Content of a custom configuration file named <code>/templates/.before-script-template.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>before_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>apt-get update -qq &amp;&amp; apt-get install -y -qq sqlite3 libsqlite3-dev nodejs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>gem install bundler --no-document</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bundle install --jobs $(nproc)  &#34;${FLAGS[@]}&#34;</span></span></span></code></pre></div></div><p>Content of <code>.gitlab-ci.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;templates/.before-script-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rspec1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bundle exec rspec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rspec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bundle exec rspec</span></span></span></code></pre></div></div><p>The default <code>before_script</code> commands execute in both <code>rspec</code> jobs, before the <code>script</code> commands.</p><h2 id=override-included-configuration-values>Override included configuration values</h2><p>When you use the <code>include</code> keyword, you can override the included configuration values to adapt them
to your pipeline requirements.</p><p>The following example shows an <code>include</code> file that is customized in the
<code>.gitlab-ci.yml</code> file. Specific YAML-defined variables and details of the
<code>production</code> job are overridden.</p><p>Content of a custom configuration file named <code>autodevops-template.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_USER</span><span class=p>:</span><span class=w> </span><span class=l>user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>testing_password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_DB</span><span class=p>:</span><span class=w> </span><span class=l>$CI_ENVIRONMENT_SLUG</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>production</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>install_dependencies</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>https://$CI_PROJECT_PATH_SLUG.$KUBE_INGRESS_BASE_DOMAIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH</span></span></span></code></pre></div></div><p>Content of <code>.gitlab-ci.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;https://company.com/autodevops-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>alpine:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_USER</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>secure_password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>production</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>https://domain.com</span></span></span></code></pre></div></div><p>The <code>POSTGRES_USER</code> and <code>POSTGRES_PASSWORD</code> variables
and the <code>environment:url</code> of the <code>production</code> job defined in the <code>.gitlab-ci.yml</code> file
override the values defined in the <code>autodevops-template.yml</code> file. The other keywords
do not change. This method is called <em>merging</em>.</p><h3 id=merge-method-for-include>Merge method for <code>include</code></h3><p>The <code>include</code> configuration merges with the main configuration file with this process:</p><ul><li>Included files are read in the order defined in the configuration file, and
the included configuration is merged together in the same order.</li><li>If an included file also uses <code>include</code>, that nested <code>include</code> configuration is merged first (recursively).</li><li>If parameters overlap, the last included file takes precedence when merging the configuration
from the included files.</li><li>After all configuration added with <code>include</code> is merged together, the main configuration
is merged with the included configuration.</li></ul><p>This merge method is a <em>deep merge</em>, where hash maps are merged at any depth in the
configuration. To merge hash map &ldquo;A&rdquo; (that contains the configuration merged so far) and &ldquo;B&rdquo; (the next piece
of configuration), the keys and values are processed as follows:</p><ul><li>When the key only exists in A, use the key and value from A.</li><li>When the key exists in both A and B, and their values are both hash maps, merge those hash maps.</li><li>When the key exists in both A and B, and one of the values is not a hash map, use the value from B.</li><li>Otherwise, use the key and value from B.</li></ul><p>For example, with a configuration that consists of two files:</p><ul><li><p>The <code>.gitlab-ci.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;common.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_USER</span><span class=p>:</span><span class=w> </span><span class=l>username</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;merge_request_event&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>manual</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>reports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>junit</span><span class=p>:</span><span class=w> </span><span class=l>rspec.xml</span></span></span></code></pre></div></div></li><li><p>The <code>common.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_USER</span><span class=p>:</span><span class=w> </span><span class=l>common_username</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>testing_password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>never</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo LOGIN=${POSTGRES_USER} &gt; deploy.env</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rake spec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>reports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dotenv</span><span class=p>:</span><span class=w> </span><span class=l>deploy.env</span></span></span></code></pre></div></div></li></ul><p>The merged result is:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_USER</span><span class=p>:</span><span class=w> </span><span class=l>username</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>POSTGRES_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>testing_password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;merge_request_event&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>manual</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo LOGIN=${POSTGRES_USER} &gt; deploy.env</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rake spec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>reports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>junit</span><span class=p>:</span><span class=w> </span><span class=l>rspec.xml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dotenv</span><span class=p>:</span><span class=w> </span><span class=l>deploy.env</span></span></span></code></pre></div></div><p>In this example:</p><ul><li>Variables are only evaluated after all the files are merged together. A job in an included file
might end up using a variable value defined in a different file.</li><li><code>rules</code> is an array so it cannot be merged. The top-level file takes precedence.</li><li><code>artifacts</code> is a hash map so it can be deep merged.</li></ul><h2 id=override-included-configuration-arrays>Override included configuration arrays</h2><p>You can use merging to extend and override configuration in an included template, but
you cannot add or modify individual items in an array. For example, to add
an additional <code>notify_owner</code> command to the extended <code>production</code> job&rsquo;s <code>script</code> array:</p><p>Content of <code>autodevops-template.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>production</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>install_dependencies</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deploy</span></span></span></code></pre></div></div><p>Content of <code>.gitlab-ci.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;autodevops-template.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>production</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>install_dependencies</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>notify_owner</span></span></span></code></pre></div></div><p>If <code>install_dependencies</code> and <code>deploy</code> are not repeated in
the <code>.gitlab-ci.yml</code> file, the <code>production</code> job would have only <code>notify_owner</code> in the script.</p><h2 id=use-nested-includes>Use nested includes</h2><p>You can nest <code>include</code> sections in configuration files that are then included
in another configuration. For example, for <code>include</code> keywords nested three deep:</p><p>Content of <code>.gitlab-ci.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>/.gitlab-ci/another-config.yml</span></span></span></code></pre></div></div><p>Content of <code>/.gitlab-ci/another-config.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>/.gitlab-ci/config-defaults.yml</span></span></span></code></pre></div></div><p>Content of <code>/.gitlab-ci/config-defaults.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>after_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;Job complete.&#34;</span></span></span></code></pre></div></div><h3 id=use-nested-includes-with-duplicate-include-entries>Use nested includes with duplicate <code>include</code> entries</h3><p>You can include the same configuration file multiple times in the main configuration file and
in nested includes.</p><p>If any file changes the included configuration using <a href=/ci/yaml/includes/#override-included-configuration-values>overrides</a>,
then the order of the <code>include</code> entries might affect the final configuration. The last time
the configuration is included overrides any previous times the file was included.
For example:</p><ul><li><p>Contents of a <code>defaults.gitlab-ci.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>before_script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Default before script&#34;</span></span></span></code></pre></div></div></li><li><p>Contents of a <code>unit-tests.gitlab-ci.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>defaults.gitlab-ci.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>default</span><span class=p>:</span><span class=w>  </span><span class=c># Override the included default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>before_script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Unit test default override&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>unit-test-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>unit-test.sh</span></span></span></code></pre></div></div></li><li><p>Contents of a <code>smoke-tests.gitlab-ci.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>template</span><span class=p>:</span><span class=w> </span><span class=l>defaults.gitlab-ci.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>default</span><span class=p>:</span><span class=w>  </span><span class=c># Override the included default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>before_script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Smoke test default override&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>smoke-test-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>smoke-test.sh</span></span></span></code></pre></div></div></li></ul><p>With these three files, the order they are included changes the final configuration.
With:</p><ul><li><p><code>unit-tests</code> included first, the contents of the <code>.gitlab-ci.yml</code> file is:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>unit-tests.gitlab-ci.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>smoke-tests.gitlab-ci.yml</span></span></span></code></pre></div></div><p>The final configuration would be:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>unit-test-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>before_script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Smoke test default override&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>unit-test.sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>smoke-test-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>before_script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Smoke test default override&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>smoke-test.sh</span></span></span></code></pre></div></div></li><li><p><code>unit-tests</code> included last, the contents of the <code>.gitlab-ci.yml</code> file is:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>smoke-tests.gitlab-ci.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>unit-tests.gitlab-ci.yml</span></span></span></code></pre></div></div></li><li><p>The final configuration would be:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>unit-test-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>before_script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Unit test default override&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>unit-test.sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>smoke-test-job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>before_script</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;Unit test default override&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>smoke-test.sh</span></span></span></code></pre></div></div></li></ul><p>If no file overrides the included configuration, the order of the <code>include</code> entries
does not affect the final configuration</p><h2 id=use-variables-with-include>Use variables with <code>include</code></h2><p>In <code>include</code> sections in your <code>.gitlab-ci.yml</code> file, you can use:</p><ul><li><a href=/ci/variables/#for-a-project>Project variables</a>.</li><li><a href=/ci/variables/#for-a-group>Group variables</a>.</li><li><a href=/ci/variables/#for-an-instance>Instance variables</a>.</li><li>Project <a href=/ci/variables/predefined_variables/>predefined variables</a> (<code>CI_PROJECT_*</code>).</li><li><a href=/ci/triggers/#pass-cicd-variables-in-the-api-call>Trigger variables</a>.</li><li><a href=/ci/pipelines/schedules/#create-a-pipeline-schedule>Scheduled pipeline variables</a>.</li><li><a href=/ci/pipelines/#run-a-pipeline-manually>Manual pipeline run variables</a>.</li><li>The <code>CI_PIPELINE_SOURCE</code> and <code>CI_PIPELINE_TRIGGERED</code> <a href=/ci/variables/predefined_variables/>predefined variables</a>.</li><li>The <code>$CI_COMMIT_REF_NAME</code> <a href=/ci/variables/predefined_variables/>predefined variable</a>.</li></ul><p>For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;$CI_PROJECT_PATH&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;.compliance-gitlab-ci.yml&#39;</span></span></span></code></pre></div></div><p>You cannot use variables defined in jobs, or in a global <a href=/ci/yaml/#variables><code>variables</code></a>
section which defines the default variables for all jobs. Includes are evaluated before jobs,
so these variables cannot be used with <code>include</code>.</p><p>For an example of how you can include predefined variables, and the variables&rsquo; impact on CI/CD jobs,
see this <a href=https://youtu.be/4XR8gw3Pkos>CI/CD variable demo</a>.</p><p>You cannot use CI/CD variables in an <code>include</code> section in a dynamic child pipeline&rsquo;s configuration.
<a href=https://gitlab.com/gitlab-org/gitlab/-/issues/378717>Issue 378717</a> proposes fixing
this issue.</p><h2 id=use-rules-with-include>Use <code>rules</code> with <code>include</code></h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-1 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-1>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-1 class="collapsible-list collapse" aria-hidden=true><ul><li>Support for <code>needs</code> job dependency <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/345377>introduced</a> in GitLab 15.11.</li></ul></div></div><p>You can use <a href=/ci/yaml/#rules><code>rules</code></a> with <code>include</code> to conditionally include other configuration files.</p><p>You can only use <code>rules</code> with <a href=/ci/yaml/includes/#use-variables-with-include>certain variables</a>, and
these keywords:</p><ul><li><a href=/ci/yaml/#rulesif><code>rules:if</code></a>.</li><li><a href=/ci/yaml/#rulesexists><code>rules:exists</code></a>.</li><li><a href=/ci/yaml/#ruleschanges><code>rules:changes</code></a>.</li></ul><h3 id=include-with-rulesif><code>include</code> with <code>rules:if</code></h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-2 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-2>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-2 class="collapsible-list collapse" aria-hidden=true><ul><li>Support for <code>when: never</code> and <code>when:always</code> <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/348146>introduced</a> in GitLab 16.1 <a href=/administration/feature_flags/>with a flag</a> named <code>ci_support_include_rules_when_never</code>. Disabled by default.</li><li>Support for <code>when: never</code> and <code>when:always</code> <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/414517>generally available</a> in GitLab 16.2. Feature flag <code>ci_support_include_rules_when_never</code> removed.</li></ul></div></div><p>Use <a href=/ci/yaml/#rulesif><code>rules:if</code></a> to conditionally include other configuration files
based on the status of CI/CD variables. For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$DONT_INCLUDE_BUILDS == &#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>never</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$ALWAYS_INCLUDE_BUILDS == &#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$INCLUDE_BUILDS == &#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>deploys.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_COMMIT_BRANCH == &#34;main&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>exit 0</span></span></span></code></pre></div></div><h3 id=include-with-rulesexists><code>include</code> with <code>rules:exists</code></h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-3 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-3>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-3 class="collapsible-list collapse" aria-hidden=true><ul><li>Support for <code>when: never</code> and <code>when:always</code> <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/348146>introduced</a> in GitLab 16.1 <a href=/administration/feature_flags/>with a flag</a> named <code>ci_support_include_rules_when_never</code>. Disabled by default.</li><li>Support for <code>when: never</code> and <code>when:always</code> <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/414517>generally available</a> in GitLab 16.2. Feature flag <code>ci_support_include_rules_when_never</code> removed.</li></ul></div></div><p>Use <a href=/ci/yaml/#rulesexists><code>rules:exists</code></a> to conditionally include other configuration files
based on the existence of files. For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>exists</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>exception-file.md</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>never</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>exists</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>important-file.md</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>exists</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>file.md</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>exit 0</span></span></span></code></pre></div></div><p>In this example, GitLab checks for the existence of <code>file.md</code> in the current project.</p><p>Review your configuration carefully if you use <code>include</code> with <code>rules:exists</code> in an include file
from a different project. GitLab checks for the existence of the file in the other project.
For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Pipeline configuration in my-group/my-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my-group/other-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>other_branch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=l>other-file.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>exit 0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># other-file.yml in my-group/other-project on ref other_branch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my-group/my-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=l>my-file.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>exists</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>file.md</span></span></span></code></pre></div></div><p>In this example, GitLab searches for the existence of <code>file.md</code> in <code>my-group/other-project</code>
on commit ref <code>other_branch</code>, not the project/ref in which the pipeline runs.</p><p>To change the search context you can use <a href=/ci/yaml/#rulesexistspaths><code>rules:exists:paths</code></a>
with <a href=/ci/yaml/#rulesexistsproject><code>rules:exists:project</code></a>.
For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my-group/my-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=l>my-file.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>exists</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>file.md</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>my-group/my-project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>main</span></span></span></code></pre></div></div><h3 id=include-with-ruleschanges><code>include</code> with <code>rules:changes</code></h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-4 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-4>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-4 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/342209>Introduced</a> in GitLab 16.4.</li></ul></div></div><p>Use <a href=/ci/yaml/#ruleschanges><code>rules:changes</code></a> to conditionally include other configuration files
based on changed files. For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds1.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>Dockerfile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds2.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>Dockerfile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>compare_to</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;refs/heads/branch1&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>local</span><span class=p>:</span><span class=w> </span><span class=l>builds3.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>$CI_PIPELINE_SOURCE == &#34;merge_request_event&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>changes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>Dockerfile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=l>exit 0</span></span></span></code></pre></div></div><p>In this example:</p><ul><li><code>builds1.yml</code> is included when <code>Dockerfile</code> has changed.</li><li><code>builds2.yml</code> is included when <code>Dockerfile</code> has changed relative to <code>refs/heads/branch1</code>.</li><li><code>builds3.yml</code> is included when <code>Dockerfile</code> has changed and the pipeline source is a merge request event. The jobs in <code>builds3.yml</code> must also be configured to run for <a href=/ci/pipelines/merge_request_pipelines/#add-jobs-to-merge-request-pipelines>merge request pipelines</a>.</li></ul><h2 id=use-includelocal-with-wildcard-file-paths>Use <code>include:local</code> with wildcard file paths</h2><p>You can use wildcard paths (<code>*</code> and <code>**</code>) with <code>include:local</code>.</p><p>Example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;configs/*.yml&#39;</span></span></span></code></pre></div></div><p>When the pipeline runs, GitLab:</p><ul><li><p>Adds all <code>.yml</code> files in the <code>configs</code> directory into the pipeline configuration.</p></li><li><p>Does not add <code>.yml</code> files in subfolders of the <code>configs</code> directory. To allow this,
add the following configuration:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># This matches all `.yml` files in `configs` and any subfolder in it.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;configs/**.yml&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># This matches all `.yml` files only in subfolders of `configs`.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;configs/**/*.yml&#39;</span></span></span></code></pre></div></div></li></ul><h2 id=troubleshooting>Troubleshooting</h2><h3 id=maximum-of-150-nested-includes-are-allowed-error><code>Maximum of 150 nested includes are allowed!</code> error</h3><p>The maximum number of <a href=/ci/yaml/includes/#use-nested-includes>nested included files</a> for a pipeline is 150.
If you receive the <code>Maximum 150 includes are allowed</code> error message in your pipeline,
it&rsquo;s likely that either:</p><ul><li>Some of the nested configuration includes an overly large number of additional nested <code>include</code> configuration.</li><li>There is an accidental loop in the nested includes. For example, <code>include1.yml</code> includes
<code>include2.yml</code> which includes <code>include1.yml</code>, creating a recursive loop.</li></ul><p>To help reduce the risk of this happening, edit the pipeline configuration file
with the <a href=/ci/pipeline_editor/>pipeline editor</a>, which validates if the
limit is reached. You can remove one included file at a time to try to narrow down
which configuration file is the source of the loop or excessive included files.</p><p>In <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/207270>GitLab 16.0 and later</a> users on GitLab Self-Managed can
change the <a href=/administration/settings/continuous_integration/#set-maximum-includes>maximum includes</a> value.</p><h3 id=ssl_connect-syscall-returned5-errno0-statesslv3tls-write-client-hello-and-other-network-failures><code>SSL_connect SYSCALL returned=5 errno=0 state=SSLv3/TLS write client hello</code> and other network failures</h3><p>When using <a href=/ci/yaml/#includeremote><code>include:remote</code></a>, GitLab tries to fetch the remote file
through HTTP(S). This process can fail because of a variety of connectivity issues.</p><p>The <code>SSL_connect SYSCALL returned=5 errno=0 state=SSLv3/TLS write client hello</code> error
happens when GitLab can&rsquo;t establish an HTTPS connection to the remote host. This issue
can be caused if the remote host has rate limits to prevent overloading the server
with requests.</p><p>For example, the <a href=/user/project/pages/>GitLab Pages</a> server for GitLab.com
is rate limited. Repeated attempts to fetch CI/CD configuration files hosted on GitLab Pages
can cause the rate limit to be reached and cause the error. You should avoid hosting
CI/CD configuration files on a GitLab Pages site.</p><p>When possible, use <a href=/ci/yaml/#includeproject><code>include:project</code></a> to fetch configuration
files from other projects within the GitLab instance without making external HTTP(S) requests.</p></div><div data-vue-app=back-to-top-button></div></div><div class="feedback gl-min-h-8" data-ga-section=feedback data-elastic-exclude><div data-component=docs-feedback></div></div></div><aside class=sidebar-right><div data-ga-section=toc data-vue-app=toc></div></aside></div></main><footer data-ga-section=footer><section data-ga-section=footer><div id=footer class="footer-section container gl-grid gl-grid-cols-2 gl-grid-rows-3 gl-grid-rows-auto gl-gap-8 lg:gl-grid-cols-5 lg:gl-grid-rows-1 lg:gl-justify-items-center gl-px-8 gl-py-8 lg:gl-py-10"><div class="gl-col-span-2 lg:gl-col-span-1 gl-row-start-1"><div class="docs-title gl-flex gl-items-center"><a href=/><img src=/gitlab-logo-footer.svg alt="GitLab Docs logo" class=logo width=176 height=24></a></div><ul class="docs-social gl-list-none gl-flex"><li><a href=https://www.facebook.com/gitlab class=facebook><span class=gl-sr-only>Facebook</span></a></li><li><a href=https://www.linkedin.com/company/gitlab-com class=linkedin><span class=gl-sr-only>LinkedIn</span></a></li><li><a href=https://twitter.com/gitlab class=twitter><span class=gl-sr-only>Twitter</span></a></li><li><a href=https://www.youtube.com/channel/UCnMGQ8QHMAnVIsI3xJrihhg class=youtube><span class=gl-sr-only>YouTube</span></a></li></ul><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="license noopener noreferrer" class=gl-mt-0><img src=/by-sa.svg alt="Creative Commons License" width=80 height=15></a></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Company</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/company/>About GitLab</a></li><li><a href=https://about.gitlab.com/pricing/>View pricing</a></li><li><a href=https://about.gitlab.com/free-trial/>Try GitLab for free</a></li></ul></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Feedback</div><ul class="gl-list-none gl-p-0"><li><a href=https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/ci/yaml/includes.md>View page source</a></li><li><a href=https://gitlab.com/-/ide/project/gitlab-org/gitlab/edit/master/-/doc/ci/yaml/includes.md>Edit in web IDE</a></li><li><a href=https://about.gitlab.com/community/contribute/>Contribute to GitLab</a></li><li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/new?issuable_template=Documentation">Suggest updates</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Help & Community</div><ul class="gl-list-none gl-p-0"><li><a href=https://university.gitlab.com/pages/certifications>Get certified</a></li><li><a href=https://about.gitlab.com/support/>Get support</a></li><li><a href="https://forum.gitlab.com/new-topic?title=topic%20title&amp;body=topic%20body&amp;tags=docs-feedback">Post on the GitLab forum</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Resources</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/terms/>Terms</a></li><li><a href=https://about.gitlab.com/privacy/>Privacy statement</a></li><li><a href=/legal/use_generative_ai/>Use of generative AI</a></li><li><a href=/legal/licensing_policy/>Acceptable use of user licenses</a></li><li><button id=ot-sdk-btn class=ot-sdk-show-settings></button></li></ul></div></div></section></footer><script type=module src=/vite/main.js></script><script async>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NJXWQL")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJXWQL" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script async>(function(){var e,t=!1;function n(){t===!1&&(t=!0,Munchkin.init("194-VVC-221",{useBeaconAPI:!0}))}e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://munchkin.marketo.net/munchkin.js",e.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&n()},e.onload=n,document.getElementsByTagName("head")[0].appendChild(e)})()</script><script async src=https://cdn.bizible.com/scripts/bizible.js></script><script async>_linkedin_partner_id="30694",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id),function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height=1 width=1 style=display:none alt src="https://dc.ads.linkedin.com/collect/?pid=30694&fmt=gif"></noscript></body></html>