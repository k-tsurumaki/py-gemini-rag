<!doctype html><html lang=en-us dir=ltr><head><script src=https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08></script><script type=text/javascript>function OptanonWrapper(){}</script><script>const callback=(e)=>{for(const t of e)t.type==="childList"&&t.addedNodes.forEach(e=>{e.nodeName==="IMG"&&document.querySelectorAll('img:not([src^="http"]):not([data-ot-ignore])').forEach(e=>{e.setAttribute("data-ot-ignore","")})})},config={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]},observer=new MutationObserver(callback);observer.observe(document.documentElement,config)</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GTM-NJXWQL"),gtag("consent","default",{analytics_storage:"granted",ad_storage:"granted",functionality_storage:"granted",wait_for_update:500}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",functionality_storage:"denied",region:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO","GB","PE","RU"],wait_for_update:500}),window.geofeed=e=>{dataLayer.push({event:"OneTrustCountryLoad",oneTrustCountryId:e.country.toString()})};const json=document.createElement("script");json.setAttribute("src","https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed"),document.head.appendChild(json)</script><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Using SSH keys with GitLab CI/CD | GitLab Docs</title><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=manifest href=/manifests/manifest.webmanifest><meta name=theme-color content="#FC6D26"><link rel=canonical href=https://docs.gitlab.com/ci/jobs/ssh_keys/><meta name=description content="GitLab product documentation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"GitLab Docs","url":"https://docs.gitlab.com/"}</script><link rel=preload href=/gitlab_ui/fonts/GitLabSans.woff2 type=font/woff2 as=font crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabSans-Italic.woff2 crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabMono.woff2 crossorigin><link rel=stylesheet href=/gitlab_ui/ui/index.css><link rel=stylesheet href=/vite/main.css><link rel=stylesheet href=/css/syntax-dark.min.css id=syntax-dark-theme><link rel=stylesheet href=/css/syntax-light.min.css id=syntax-light-theme><script>(function(){const p="gitlab-docs-theme",g="gitlab-docs-layout",e={LIGHT:"light",DARK:"dark",AUTO:"auto"},i={FIXED:"fixed",FLUID:"fluid"},d="light",f="fixed";let r=!1;const t=localStorage?.getItem(p),m=localStorage?.getItem(g),l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?e.DARK:e.LIGHT;function h(){return t&&(t===e.LIGHT||t===e.DARK)?t:(t===e.AUTO&&(r=!0),l||d)}function u(){return m===i.FLUID?i.FLUID:f}const s=h(),c=u(),n=document.documentElement;n.classList.remove("gl-dark","gl-light"),n.classList.add(s===e.DARK?"gl-dark":"gl-light"),c===i.FLUID&&(n.classList.add("fluid"),n.classList.remove("fixed"));const a=document.getElementById("syntax-dark-theme"),o=document.getElementById("syntax-light-theme");a&&o&&(s===e.DARK?(a.disabled=!1,o.disabled=!0):(a.disabled=!0,o.disabled=!1)),window.__initialTheme=r?e.AUTO:s,window.__initialLayout=c})()</script><meta name=gitlab_docs_base_url content="/"><meta name=gitlab_docs_page_owner data-stage="Software Supply Chain Security" data-group="Pipeline Security"><meta class=elastic name=gitlab_docs_version content="18.6"><meta class=elastic name=gitlab_docs_section content="use_gitlab"><meta class=elastic name=gitlab_docs_breadcrumbs content="Use GitLab › Use CI/CD to build your application › Jobs"><script>window.pageMetadata={trail:[{path:"user/",title:"Use GitLab"},{path:"topics/build_your_application/",title:"Use CI/CD to build your application"},{path:"ci/jobs/",title:"Jobs"},{path:"ci/jobs/ssh_keys/",title:"SSH keys"}]}</script><meta name=gitlab_docs_legacy_path content="/ee/ci/jobs/ssh_keys.html"><meta name=gitlab_docs_hugo_launch_version content="17.9"><script>const ELASTIC_CLOUD_ID="gitlab-docs-website:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJDQwZTQyYTQzMTJiZjQyMzNiMzBiZTg0MTU5YjlkNmE1JGMxODg4Y2U5OTY0YzQzZjc5ZjQ1YTk5NDZmMjI0ODg0",ELASTIC_KEY="cDFpLWJaSUJXVHBqWWI4VGZKN3M6eENBSjl4WDRSRnlCUW94ajRQazhLQQ==",ELASTIC_INDEX="search-gitlab-docs-hugo"</script><script type=module src=/vite/elastic_search.js></script><script type=module src=/vite/history.js></script><script>const FS_IDENTIFIER="AIzaSyCLdi3jHHjkmLji9D8uj_RNPMHcdrYoIW4",RECAPTCHA_PUBLIC_KEY="6Le4R3UrAAAAALsIlK_siq0_UhPD-0rD-ImF1gfO"</script><meta name=google-site-verification content="AcGSBNaKDWnLgcYotlVibGy6STm2Y6_KJSaRxrA90xY"><meta name=google-site-verification content="6eFQOFLxYAer08ROqc3I-SAi44F9NmvH7PrUUBR3oCI"><meta name=google-site-verification content="xAUTWp3CDg-tU1LVVwsM9OrVhLR7L3SmiyKzkOuPNos"><meta name=google-site-verification content="F0zzwaMpiyWFcPQ1Lqu18qN3EnuQsqFXbySl_29yvHs"><meta name=google-site-verification content="nwo1bVaU0t9TZxZyM-aOI6-CofaH9GRL-uBPbdREWgc"><meta name=google-site-verification content="rWoHrtHEmIX0t28oOb1ZEDMYZb_EZA6rr6ZOl5otEPI"><meta name=google-site-verification content="fSxr8-uslxcuFL0N-oECp3Tm0RPNEGX97wbdayKOEL8"><meta name=google-site-verification content="ISxyLVnZqU8oY3jwrK7EO9o-2DOTvLJwPse7bZz6yhs"><meta name=google-site-verification content="x1WspIvz3ZHqS0gezfX_P-qiRDOeP2Oyrd68zrU2ErI"><meta name=google-site-verification content="DfXB2Za52GT3zs_vuLIAL4Mi3M3K4qxXcg7MAs0CUqo"><meta name=google-site-verification content="BCEBC2LC7A1NzO9Com1oBrWK88tV_QXfUL0i9mwXPL0"><meta name=google-site-verification content="a2lNcHMorfS43aoISjZt5_BBPo-H1UaTKMQdBgZO9iY"><meta name=google-site-verification content="0s16pP9MelY6wDHRf-izXb5pwLU01IogP-Uc_e8f3GU"><meta name=google-site-verification content="H474RNof35Xp8fLg02fZbg9Dzxdtfch6vtcjzpmUraU"><meta name=google-site-verification content="E0FlhpgBGeE7d1pQ6amdcIWPMDLDeu15-HLQVoDTguE"><meta name=google-site-verification content="opQd7_rXtPy-pX5CO_XZiztzeQEsXnB3j6Y1_dZAizA"><meta name=google-site-verification content="06Kq4AoXdmBOjOAkbPvnYGtSxnn4Q9QBqEO55PLlw5c"><meta name=google-site-verification content="djBBokRFSWV_VRlSE51V5TZSPzMC6hml5l-Sb22WglE"><meta name=google-site-verification content="UOW6nOsvbyMeIySuamzbws4kNC_WqehamWfoxxtKjZ8"><meta name=google-site-verification content="hXU1Gsdba74DUbvbdUHRl9o0cQeiwXIhAdIllOG6p8E"><meta name=google-site-verification content="YFeHIAPk9lE76ubVMeq4P0sQVnzo2-a4k1oU_bPY8yE"><meta name=google-site-verification content="h8ICI4eDkvXmYaGDuLTLoWuXnLn-KUkChqYB-roMRsw"><meta name=google-site-verification content="9QW7feFNlCpMLPm7vAWEU-v14vdzb0Bb3RAk-8e_a18"><meta name=google-site-verification content="26kXLBOjaYRb2UwzWTDl1I1nzA2NxMunhp7SUtxGV6E"><meta name=google-site-verification content="jr3C8t6vKGPyN9GV3esdHY_xGYyQaUNznIl-Un2RObA"><meta name=google-site-verification content="WdlBpRU0ec1ieKqrTY_772OhG23FY45VQ4Lv9DyLJ_Y"><meta name=google-site-verification content="n9i6B9q4Xjr_etK2nQGZH1msoo7vIv9SXV8SQLOUA7c"><meta name=zd-site-verification content="ony3w7hk1vs6tfyrc51mld"><meta name=zd-site-verification content="gtuq65qdzt6n31viazi6hj"></head><body data-elastic-exclude><nav data-ga-section=header data-elastic-exclude><div class="header-wrapper gl-w-full gl-fixed gl-z-4"><div class=header><div class="header-top gl-flex gl-items-center"><a href=#skipTarget class="gl-sr-only skip-link">Skip to main content</a>
<a class=navbar-logo href=/><span class=gl-sr-only>Go to GitLab Docs homepage</span></a><div class="mobile-header gl-w-full gl-text-base"><div class=mobile-header-overlay></div><div class="header-right collapse gl-z-4 gl-border-t lg:gl-border-0"><div class="search-wrapper lg:gl-ml-4 lg:gl-grow"><div class="js-elastic-search-form gl-spinner-container"><span role=status aria-label=Loading class="gl-ml-3 gl-align-text-bottom! gl-spinner gl-spinner gl-spinner-sm"></span></div></div><div class="gl-flex gl-flex-col gl-gap-3 gl-mt-5 lg:gl-mt-0 lg:gl-flex-row lg:gl-items-center gl-ml-auto"><a class="whats-new gl-button btn-default btn-default-tertiary gl-hidden lg:gl-block" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a><div data-vue-app=versions-menu></div><div data-vue-app=appearance-toggle class="gl-hidden lg:gl-block"></div><div class="gl-flex gl-justify-evenly lg:gl-justify-normal gl-items-center gl-gap-5"><a class="whats-new gl-button btn-default btn-default-tertiary gl-w-full lg:gl-hidden hover:gl-no-underline" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a>
<a class="free-trial-btn cta-button gl-button btn-confirm gl-w-full hover:gl-no-underline" href="https://gitlab.com/-/trial_registrations/new?glm_source=docs.gitlab.com&amp;amp;glm_content=navigation-cta-docs" target=_blank rel="noopener noreferrer" role=button>Get free trial</a></div></div></div></div><button class="navbar-toggle gl-button btn-default lg:gl-hidden" data-toggle=collapse data-target=.header-right>
<span class=navbar-toggle-icon></span>
<span class=gl-sr-only>Toggle menu</span></button></div><div class="header-bottom gl-border-t lg:gl-border-b"><ul class="subheader-menu gl-hidden lg:gl-flex gl-list-none gl-text-base gl-space-x-5 gl-py-4 gl-pl-0 gl-mb-0"><li><a href=/user/ class=active>Use GitLab</a></li><li><a href=/user/gitlab_duo/>GitLab Duo</a></li><li><a href=/api/>Extend</a></li><li><a href=/install/>Install</a></li><li><a href=/administration/>Administer</a></li><li><a href=/subscriptions/>Subscribe</a></li><li><a href=/development/>Contribute</a></li><li><a href=/solutions/>Solutions</a></li></ul></div></div></div></nav><main data-ga-section=content-body><div id=js-version-banner></div><div class="template-single gl-flex gl-h-full"><div class=side-nav data-ga-section=side-nav data-vue-app=sidebar-menu></div><div data-pagefind-body class=main-content><div class=docs-content><div class="gl-flex gl-h-5 gl-items-center gl-my-6"><div data-vue-app=open-sidebar></div><div data-vue-app=breadcrumb-nav></div></div><hr class="gl-border-t gl-px-5 lg:gl-hidden"><div class="gl-pt-4 gl-mt-4 lg:gl-pt-0 lg:gl-mt-0 lg:gl-border-t-0"><h1 id=skipTarget class=gl-mb-6>Using SSH keys with GitLab CI/CD</h1></div><div data-elastic-include><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Free, Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><p>GitLab does not have built-in support for managing SSH keys in a build
environment (where the GitLab Runner runs).</p><p>Use SSH keys when you want to:</p><ul><li>Check out internal submodules.</li><li>Download private packages using your package manager. For example, Bundler.</li><li>Deploy your application to your own server or, for example, Heroku.</li><li>Execute SSH commands from the build environment to a remote server.</li><li>Rsync files from the build environment to a remote server.</li></ul><p>The most widely supported method is to inject an SSH key into your build
environment by extending your <code>.gitlab-ci.yml</code>, and it&rsquo;s a solution that works
with any type of <a href=https://docs.gitlab.com/runner/executors/>executor</a>
(like Docker or shell, for example).</p><h2 id=create-and-use-an-ssh-key>Create and use an SSH key</h2><p>To create and use an SSH key in GitLab CI/CD:</p><ol><li><a href=/user/ssh/#generate-an-ssh-key-pair>Create a new SSH key pair</a> locally with <code>ssh-keygen</code>.</li><li>Add the private key as a <a href=/ci/variables/#for-a-project>file type CI/CD variable</a> to
your project. The variable value must end in a newline (<code>LF</code> character). To add a newline, press <kbd>Enter</kbd> or <kbd>Return</kbd>
at the end of the last line of the SSH key before saving it in the CI/CD settings.</li><li>Run the <a href=https://linux.die.net/man/1/ssh-agent><code>ssh-agent</code></a> in the job, which loads
the private key.</li><li>Copy the public key to the servers you want to have access to (usually in <code>~/.ssh/authorized_keys</code>).
If you are accessing a private GitLab repository, you also need to add the public key as
a <a href=/user/project/deploy_keys/>deploy key</a>.</li></ol><p>In the following example, the <code>ssh-add -</code> command does not display the value of
<code>$SSH_PRIVATE_KEY</code> in the job log, though it could be exposed if you enable
<a href=/ci/variables/variables_troubleshooting/#enable-debug-logging>debug logging</a>. You might also want to
check the <a href=/ci/pipelines/settings/#change-which-users-can-view-your-pipelines>visibility of your pipelines</a>.</p><h2 id=ssh-keys-when-using-the-docker-executor>SSH keys when using the Docker executor</h2><p>When your CI/CD jobs run inside Docker containers (meaning the environment is
contained) and you want to deploy your code in a private server, you need a way
to access it. In this case, you can use an SSH key pair.</p><ol><li><p>You first must create an SSH key pair. For more information, follow
the instructions to <a href=/user/ssh/#generate-an-ssh-key-pair>generate an SSH key</a>.
<strong>Do not</strong> add a passphrase to the SSH key, or the <code>before_script</code> will
prompt for it.</p></li><li><p>Create a new <a href=/ci/variables/#for-a-project>file type CI/CD variable</a>.</p><ul><li>In the <strong>Key</strong> field, enter <code>SSH_PRIVATE_KEY</code>.</li><li>In the <strong>Value</strong> field, paste the content of your private key from the key pair that you created earlier.
Make sure the file ends with a newline. To add a newline, press
<kbd>Enter</kbd> or <kbd>Return</kbd> at the end of the last line of the SSH key before saving your changes.</li></ul></li><li><p>Modify your <code>.gitlab-ci.yml</code> with a <code>before_script</code> action. In the following
example, a Debian based image is assumed. Edit to your needs:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>before_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Install ssh-agent if not already installed, it is required by Docker.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## (change apt-get to yum if you use an RPM-based image)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s1>&#39;command -v ssh-agent &gt;/dev/null || ( apt-get update -y &amp;&amp; apt-get install openssh-client -y )&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Run ssh-agent (inside the build environment)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>eval $(ssh-agent -s)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Give the right permissions, otherwise ssh-add will refuse to add files</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Add the SSH key stored in SSH_PRIVATE_KEY file type CI/CD variable to the agent store</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>chmod 400 &#34;$SSH_PRIVATE_KEY&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>ssh-add &#34;$SSH_PRIVATE_KEY&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Create the SSH directory and give it the right permissions</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>mkdir -p ~/.ssh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>chmod 700 ~/.ssh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Optionally, if you will be using any Git commands, set the user name and</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## and email.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># - git config --global user.email &#34;user@example.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># - git config --global user.name &#34;User name&#34;</span></span></span></code></pre></div></div><p>The <a href=/ci/yaml/#before_script><code>before_script</code></a> can be set as a default
or per-job.</p></li><li><p>Make sure the private server&rsquo;s <a href=/ci/jobs/ssh_keys/#verifying-the-ssh-host-keys>SSH host keys are verified</a>.</p></li><li><p>As a final step, add the public key from the one you created in the first
step to the services that you want to have an access to from inside the build
environment. If you are accessing a private GitLab repository you must add
it as a <a href=/user/project/deploy_keys/>deploy key</a>.</p></li></ol><p>That&rsquo;s it! You can now have access to private servers or repositories in your
build environment.</p><h2 id=ssh-keys-when-using-the-shell-executor>SSH keys when using the Shell executor</h2><p>If you are using the Shell executor and not Docker, it is easier to set up an
SSH key.</p><p>You can generate the SSH key from the machine that GitLab Runner is installed
on, and use that key for all projects that are run on this machine.</p><ol><li><p>First, sign in to the server that runs your jobs.</p></li><li><p>Then, from the terminal, sign in as the <code>gitlab-runner</code> user:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo su - gitlab-runner</span></span></code></pre></div></div></li><li><p>Generate the SSH key pair as described in the instructions to
<a href=/user/ssh/#generate-an-ssh-key-pair>generate an SSH key</a>.
<strong>Do not</strong> add a passphrase to the SSH key, or the <code>before_script</code> will
prompt for it.</p></li><li><p>As a final step, add the public key from the one you created earlier to the
services that you want to have an access to from inside the build environment.
If you are accessing a private GitLab repository you must add it as a
<a href=/user/project/deploy_keys/>deploy key</a>.</p></li></ol><p>After generating the key, try to sign in to the remote server to accept the
fingerprint:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ssh example.com</span></span></code></pre></div></div><p>For accessing repositories on GitLab.com, you would use <code>git@gitlab.com</code>.</p><h2 id=verifying-the-ssh-host-keys>Verifying the SSH host keys</h2><p>It is a good practice to check the private server&rsquo;s own public key to make sure
you are not being targeted by a man-in-the-middle attack. If anything
suspicious happens, you notice it because the job fails (the SSH
connection fails when the public keys don&rsquo;t match).</p><p>To find out the host keys of your server, run the <code>ssh-keyscan</code> command from a
trusted network (ideally, from the private server itself):</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>## Use the domain name</span>
</span></span><span class=line><span class=cl>ssh-keyscan example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Or use an IP</span>
</span></span><span class=line><span class=cl>ssh-keyscan 10.0.2.2</span></span></code></pre></div></div><p>Create a new <a href=/ci/variables/#use-file-type-cicd-variables>file type CI/CD variable</a>
with <code>SSH_KNOWN_HOSTS</code> as &ldquo;Key&rdquo;, and as a &ldquo;Value&rdquo; add the output of <code>ssh-keyscan</code>.
Make sure the file ends with a newline. To add a newline, press <kbd>Enter</kbd> or <kbd>Return</kbd>
at the end of the last line of the SSH key before saving your changes.</p><p>If you must connect to multiple servers, all the server host keys
must be collected in the <strong>Value</strong> of the variable, one key per line.</p><div class="alert alert-type-note gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>By using a file type CI/CD variable instead of <code>ssh-keyscan</code> directly inside
<code>.gitlab-ci.yml</code>, it has the benefit that you don&rsquo;t have to change <code>.gitlab-ci.yml</code>
if the host domain name changes for some reason. Also, the values are predefined
by you, meaning that if the host keys suddenly change, the CI/CD job doesn&rsquo;t fail,
so there&rsquo;s something wrong with the server or the network.</p><p>Do not run <code>ssh-keyscan</code> directly in a CI/CD job, as it is a security risk vulnerable
to machine-in-the-middle attacks.</p></div></div><p>Now that the <code>SSH_KNOWN_HOSTS</code> variable is created, in addition to the
<a href=/ci/jobs/ssh_keys/#ssh-keys-when-using-the-docker-executor>content of <code>.gitlab-ci.yml</code></a>, you must add:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>before_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Assuming you created the SSH_KNOWN_HOSTS file type CI/CD variable, uncomment the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## following two lines.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>##</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>cp &#34;$SSH_KNOWN_HOSTS&#34; ~/.ssh/known_hosts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>chmod 644 ~/.ssh/known_hosts</span></span></span></code></pre></div></div><h2 id=use-ssh-key-without-a-file-type-cicd-variable>Use SSH key without a file type CI/CD variable</h2><p>If you do not want to use a file type CI/CD variable, the <a href=https://gitlab.com/gitlab-examples/ssh-private-key/>example SSH Project</a>
shows an alternative method. This method uses a regular CI/CD variable instead of
the file type variable previously recommended.</p><h2 id=troubleshooting>Troubleshooting</h2><h3 id=error-loading-key-buildspathssh_private_key-error-in-libcrypto-message><code>Error loading key "/builds/path/SSH_PRIVATE_KEY": error in libcrypto</code> message</h3><p>This message can be returned if there is a formatting error with the SSH key.</p><p>When saving the SSH key as a <a href=/ci/variables/#use-file-type-cicd-variables>file type CI/CD variable</a>,
the value must end with a newline (<code>LF</code> character). To add a newline, press <kbd>Enter</kbd> or <kbd>Return</kbd>
at the end of the <code>-----END OPENSSH PRIVATE KEY-----</code> line of the SSH key before saving
the variable.</p></div><div data-vue-app=back-to-top-button></div></div><div class="feedback gl-min-h-8" data-ga-section=feedback data-elastic-exclude><div data-component=docs-feedback></div></div></div><aside class=sidebar-right><div data-ga-section=toc data-vue-app=toc></div></aside></div></main><footer data-ga-section=footer><section data-ga-section=footer><div id=footer class="footer-section container gl-grid gl-grid-cols-2 gl-grid-rows-3 gl-grid-rows-auto gl-gap-8 lg:gl-grid-cols-5 lg:gl-grid-rows-1 lg:gl-justify-items-center gl-px-8 gl-py-8 lg:gl-py-10"><div class="gl-col-span-2 lg:gl-col-span-1 gl-row-start-1"><div class="docs-title gl-flex gl-items-center"><a href=/><img src=/gitlab-logo-footer.svg alt="GitLab Docs logo" class=logo width=176 height=24></a></div><ul class="docs-social gl-list-none gl-flex"><li><a href=https://www.facebook.com/gitlab class=facebook><span class=gl-sr-only>Facebook</span></a></li><li><a href=https://www.linkedin.com/company/gitlab-com class=linkedin><span class=gl-sr-only>LinkedIn</span></a></li><li><a href=https://twitter.com/gitlab class=twitter><span class=gl-sr-only>Twitter</span></a></li><li><a href=https://www.youtube.com/channel/UCnMGQ8QHMAnVIsI3xJrihhg class=youtube><span class=gl-sr-only>YouTube</span></a></li></ul><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="license noopener noreferrer" class=gl-mt-0><img src=/by-sa.svg alt="Creative Commons License" width=80 height=15></a></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Company</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/company/>About GitLab</a></li><li><a href=https://about.gitlab.com/pricing/>View pricing</a></li><li><a href=https://about.gitlab.com/free-trial/>Try GitLab for free</a></li></ul></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Feedback</div><ul class="gl-list-none gl-p-0"><li><a href=https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/ci/jobs/ssh_keys.md>View page source</a></li><li><a href=https://gitlab.com/-/ide/project/gitlab-org/gitlab/edit/master/-/doc/ci/jobs/ssh_keys.md>Edit in web IDE</a></li><li><a href=https://about.gitlab.com/community/contribute/>Contribute to GitLab</a></li><li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/new?issuable_template=Documentation">Suggest updates</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Help & Community</div><ul class="gl-list-none gl-p-0"><li><a href=https://university.gitlab.com/pages/certifications>Get certified</a></li><li><a href=https://about.gitlab.com/support/>Get support</a></li><li><a href="https://forum.gitlab.com/new-topic?title=topic%20title&amp;body=topic%20body&amp;tags=docs-feedback">Post on the GitLab forum</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Resources</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/terms/>Terms</a></li><li><a href=https://about.gitlab.com/privacy/>Privacy statement</a></li><li><a href=/legal/use_generative_ai/>Use of generative AI</a></li><li><a href=/legal/licensing_policy/>Acceptable use of user licenses</a></li><li><button id=ot-sdk-btn class=ot-sdk-show-settings></button></li></ul></div></div></section></footer><script type=module src=/vite/main.js></script><script async>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NJXWQL")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJXWQL" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script async>(function(){var e,t=!1;function n(){t===!1&&(t=!0,Munchkin.init("194-VVC-221",{useBeaconAPI:!0}))}e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://munchkin.marketo.net/munchkin.js",e.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&n()},e.onload=n,document.getElementsByTagName("head")[0].appendChild(e)})()</script><script async src=https://cdn.bizible.com/scripts/bizible.js></script><script async>_linkedin_partner_id="30694",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id),function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height=1 width=1 style=display:none alt src="https://dc.ads.linkedin.com/collect/?pid=30694&fmt=gif"></noscript></body></html>