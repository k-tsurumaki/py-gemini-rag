<!doctype html><html lang=en-us dir=ltr><head><script src=https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08></script><script type=text/javascript>function OptanonWrapper(){}</script><script>const callback=(e)=>{for(const t of e)t.type==="childList"&&t.addedNodes.forEach(e=>{e.nodeName==="IMG"&&document.querySelectorAll('img:not([src^="http"]):not([data-ot-ignore])').forEach(e=>{e.setAttribute("data-ot-ignore","")})})},config={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]},observer=new MutationObserver(callback);observer.observe(document.documentElement,config)</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GTM-NJXWQL"),gtag("consent","default",{analytics_storage:"granted",ad_storage:"granted",functionality_storage:"granted",wait_for_update:500}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",functionality_storage:"denied",region:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO","GB","PE","RU"],wait_for_update:500}),window.geofeed=e=>{dataLayer.push({event:"OneTrustCountryLoad",oneTrustCountryId:e.country.toString()})};const json=document.createElement("script");json.setAttribute("src","https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed"),document.head.appendChild(json)</script><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Configuring runners | GitLab Docs</title><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=manifest href=/manifests/manifest.webmanifest><meta name=theme-color content="#FC6D26"><link rel=canonical href=https://docs.gitlab.com/ci/runners/configure_runners/><meta name=description content="Set timeouts, protect sensitive information, control behavior with tags and variables, and configure artifact and cache settings of your GitLab Runner."><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"GitLab Docs","url":"https://docs.gitlab.com/"}</script><link rel=preload href=/gitlab_ui/fonts/GitLabSans.woff2 type=font/woff2 as=font crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabSans-Italic.woff2 crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabMono.woff2 crossorigin><link rel=stylesheet href=/gitlab_ui/ui/index.css><link rel=stylesheet href=/vite/main.css><link rel=stylesheet href=/css/syntax-dark.min.css id=syntax-dark-theme><link rel=stylesheet href=/css/syntax-light.min.css id=syntax-light-theme><script>(function(){const p="gitlab-docs-theme",g="gitlab-docs-layout",e={LIGHT:"light",DARK:"dark",AUTO:"auto"},i={FIXED:"fixed",FLUID:"fluid"},d="light",f="fixed";let r=!1;const t=localStorage?.getItem(p),m=localStorage?.getItem(g),l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?e.DARK:e.LIGHT;function h(){return t&&(t===e.LIGHT||t===e.DARK)?t:(t===e.AUTO&&(r=!0),l||d)}function u(){return m===i.FLUID?i.FLUID:f}const s=h(),c=u(),n=document.documentElement;n.classList.remove("gl-dark","gl-light"),n.classList.add(s===e.DARK?"gl-dark":"gl-light"),c===i.FLUID&&(n.classList.add("fluid"),n.classList.remove("fixed"));const a=document.getElementById("syntax-dark-theme"),o=document.getElementById("syntax-light-theme");a&&o&&(s===e.DARK?(a.disabled=!1,o.disabled=!0):(a.disabled=!0,o.disabled=!1)),window.__initialTheme=r?e.AUTO:s,window.__initialLayout=c})()</script><meta name=gitlab_docs_base_url content="/"><meta name=gitlab_docs_page_owner data-stage=Verify data-group="Runner Core"><meta class=elastic name=gitlab_docs_version content="18.6"><meta class=elastic name=gitlab_docs_section content="administer"><meta class=elastic name=gitlab_docs_breadcrumbs content="Administer â€º Administer GitLab Runner"><script>window.pageMetadata={trail:[{path:"administration/",title:"Administer"},{path:"runner/",title:"Administer GitLab Runner"},{path:"ci/runners/configure_runners/",title:"Configure runners"}]}</script><meta name=gitlab_docs_legacy_path content="/ee/ci/runners/configure_runners.html"><meta name=gitlab_docs_hugo_launch_version content="17.9"><script>const ELASTIC_CLOUD_ID="gitlab-docs-website:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJDQwZTQyYTQzMTJiZjQyMzNiMzBiZTg0MTU5YjlkNmE1JGMxODg4Y2U5OTY0YzQzZjc5ZjQ1YTk5NDZmMjI0ODg0",ELASTIC_KEY="cDFpLWJaSUJXVHBqWWI4VGZKN3M6eENBSjl4WDRSRnlCUW94ajRQazhLQQ==",ELASTIC_INDEX="search-gitlab-docs-hugo"</script><script type=module src=/vite/elastic_search.js></script><script type=module src=/vite/history.js></script><script>const FS_IDENTIFIER="AIzaSyCLdi3jHHjkmLji9D8uj_RNPMHcdrYoIW4",RECAPTCHA_PUBLIC_KEY="6Le4R3UrAAAAALsIlK_siq0_UhPD-0rD-ImF1gfO"</script><meta name=google-site-verification content="AcGSBNaKDWnLgcYotlVibGy6STm2Y6_KJSaRxrA90xY"><meta name=google-site-verification content="6eFQOFLxYAer08ROqc3I-SAi44F9NmvH7PrUUBR3oCI"><meta name=google-site-verification content="xAUTWp3CDg-tU1LVVwsM9OrVhLR7L3SmiyKzkOuPNos"><meta name=google-site-verification content="F0zzwaMpiyWFcPQ1Lqu18qN3EnuQsqFXbySl_29yvHs"><meta name=google-site-verification content="nwo1bVaU0t9TZxZyM-aOI6-CofaH9GRL-uBPbdREWgc"><meta name=google-site-verification content="rWoHrtHEmIX0t28oOb1ZEDMYZb_EZA6rr6ZOl5otEPI"><meta name=google-site-verification content="fSxr8-uslxcuFL0N-oECp3Tm0RPNEGX97wbdayKOEL8"><meta name=google-site-verification content="ISxyLVnZqU8oY3jwrK7EO9o-2DOTvLJwPse7bZz6yhs"><meta name=google-site-verification content="x1WspIvz3ZHqS0gezfX_P-qiRDOeP2Oyrd68zrU2ErI"><meta name=google-site-verification content="DfXB2Za52GT3zs_vuLIAL4Mi3M3K4qxXcg7MAs0CUqo"><meta name=google-site-verification content="BCEBC2LC7A1NzO9Com1oBrWK88tV_QXfUL0i9mwXPL0"><meta name=google-site-verification content="a2lNcHMorfS43aoISjZt5_BBPo-H1UaTKMQdBgZO9iY"><meta name=google-site-verification content="0s16pP9MelY6wDHRf-izXb5pwLU01IogP-Uc_e8f3GU"><meta name=google-site-verification content="H474RNof35Xp8fLg02fZbg9Dzxdtfch6vtcjzpmUraU"><meta name=google-site-verification content="E0FlhpgBGeE7d1pQ6amdcIWPMDLDeu15-HLQVoDTguE"><meta name=google-site-verification content="opQd7_rXtPy-pX5CO_XZiztzeQEsXnB3j6Y1_dZAizA"><meta name=google-site-verification content="06Kq4AoXdmBOjOAkbPvnYGtSxnn4Q9QBqEO55PLlw5c"><meta name=google-site-verification content="djBBokRFSWV_VRlSE51V5TZSPzMC6hml5l-Sb22WglE"><meta name=google-site-verification content="UOW6nOsvbyMeIySuamzbws4kNC_WqehamWfoxxtKjZ8"><meta name=google-site-verification content="hXU1Gsdba74DUbvbdUHRl9o0cQeiwXIhAdIllOG6p8E"><meta name=google-site-verification content="YFeHIAPk9lE76ubVMeq4P0sQVnzo2-a4k1oU_bPY8yE"><meta name=google-site-verification content="h8ICI4eDkvXmYaGDuLTLoWuXnLn-KUkChqYB-roMRsw"><meta name=google-site-verification content="9QW7feFNlCpMLPm7vAWEU-v14vdzb0Bb3RAk-8e_a18"><meta name=google-site-verification content="26kXLBOjaYRb2UwzWTDl1I1nzA2NxMunhp7SUtxGV6E"><meta name=google-site-verification content="jr3C8t6vKGPyN9GV3esdHY_xGYyQaUNznIl-Un2RObA"><meta name=google-site-verification content="WdlBpRU0ec1ieKqrTY_772OhG23FY45VQ4Lv9DyLJ_Y"><meta name=google-site-verification content="n9i6B9q4Xjr_etK2nQGZH1msoo7vIv9SXV8SQLOUA7c"><meta name=zd-site-verification content="ony3w7hk1vs6tfyrc51mld"><meta name=zd-site-verification content="gtuq65qdzt6n31viazi6hj"></head><body data-elastic-exclude><nav data-ga-section=header data-elastic-exclude><div class="header-wrapper gl-w-full gl-fixed gl-z-4"><div class=header><div class="header-top gl-flex gl-items-center"><a href=#skipTarget class="gl-sr-only skip-link">Skip to main content</a>
<a class=navbar-logo href=/><span class=gl-sr-only>Go to GitLab Docs homepage</span></a><div class="mobile-header gl-w-full gl-text-base"><div class=mobile-header-overlay></div><div class="header-right collapse gl-z-4 gl-border-t lg:gl-border-0"><div class="search-wrapper lg:gl-ml-4 lg:gl-grow"><div class="js-elastic-search-form gl-spinner-container"><span role=status aria-label=Loading class="gl-ml-3 gl-align-text-bottom! gl-spinner gl-spinner gl-spinner-sm"></span></div></div><div class="gl-flex gl-flex-col gl-gap-3 gl-mt-5 lg:gl-mt-0 lg:gl-flex-row lg:gl-items-center gl-ml-auto"><a class="whats-new gl-button btn-default btn-default-tertiary gl-hidden lg:gl-block" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a><div data-vue-app=versions-menu></div><div data-vue-app=appearance-toggle class="gl-hidden lg:gl-block"></div><div class="gl-flex gl-justify-evenly lg:gl-justify-normal gl-items-center gl-gap-5"><a class="whats-new gl-button btn-default btn-default-tertiary gl-w-full lg:gl-hidden hover:gl-no-underline" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a>
<a class="free-trial-btn cta-button gl-button btn-confirm gl-w-full hover:gl-no-underline" href="https://gitlab.com/-/trial_registrations/new?glm_source=docs.gitlab.com&amp;amp;glm_content=navigation-cta-docs" target=_blank rel="noopener noreferrer" role=button>Get free trial</a></div></div></div></div><button class="navbar-toggle gl-button btn-default lg:gl-hidden" data-toggle=collapse data-target=.header-right>
<span class=navbar-toggle-icon></span>
<span class=gl-sr-only>Toggle menu</span></button></div><div class="header-bottom gl-border-t lg:gl-border-b"><ul class="subheader-menu gl-hidden lg:gl-flex gl-list-none gl-text-base gl-space-x-5 gl-py-4 gl-pl-0 gl-mb-0"><li><a href=/user/>Use GitLab</a></li><li><a href=/user/gitlab_duo/>GitLab Duo</a></li><li><a href=/api/>Extend</a></li><li><a href=/install/>Install</a></li><li><a href=/administration/ class=active>Administer</a></li><li><a href=/subscriptions/>Subscribe</a></li><li><a href=/development/>Contribute</a></li><li><a href=/solutions/>Solutions</a></li></ul></div></div></div></nav><main data-ga-section=content-body><div id=js-version-banner></div><div class="template-single gl-flex gl-h-full"><div class=side-nav data-ga-section=side-nav data-vue-app=sidebar-menu></div><div data-pagefind-body class=main-content><div class=docs-content><div class="gl-flex gl-h-5 gl-items-center gl-my-6"><div data-vue-app=open-sidebar></div><div data-vue-app=breadcrumb-nav></div></div><hr class="gl-border-t gl-px-5 lg:gl-hidden"><div class="gl-pt-4 gl-mt-4 lg:gl-pt-0 lg:gl-mt-0 lg:gl-border-t-0"><h1 id=skipTarget class=gl-mb-6>Configuring runners</h1></div><div data-elastic-include><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Free, Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><p>This document describes how to configure runners in the GitLab UI.</p><p>If you need to configure runners on the machine where you installed GitLab Runner, see
<a href=https://docs.gitlab.com/runner/configuration/>the GitLab Runner documentation</a>.</p><h2 id=set-the-maximum-job-timeout>Set the maximum job timeout</h2><p>You can specify a maximum job timeout for each runner to prevent projects
with longer job timeouts from using the runner. The maximum job timeout is
used if it is shorter than the job timeout defined in the project.</p><p>To set a runner&rsquo;s maximum timeout, set the <code>maximum_timeout</code> parameter in the REST API endpoint <a href=/api/runners/#update-runners-details><code>PUT /runners/:id</code></a>.</p><h3 id=for-an-instance-runner>For an instance runner</h3><p>Prerequisites:</p><ul><li>You must be an administrator.</li></ul><p>You can override the job timeout for instance runners on GitLab Self-Managed.</p><p>On GitLab.com, you cannot override the job timeout for GitLab hosted instance runners and must use the <a href=/ci/pipelines/settings/#set-a-limit-for-how-long-jobs-can-run>project defined timeout</a> instead.</p><p>To set the maximum job timeout:</p><ol><li>On the left sidebar, at the bottom, select <strong>Admin</strong>. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, in the upper-right corner, select <strong>Admin</strong>.</li><li>Select <strong>CI/CD > Runners</strong>.</li><li>To the right of the runner, you want to edit, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>In the <strong>Maximum job timeout</strong> field, enter a value in seconds. The minimum value is 600 seconds (10 minutes).</li><li>Select <strong>Save changes</strong>.</li></ol><h3 id=for-a-group-runner>For a group runner</h3><p>Prerequisites:</p><ul><li>You must have the Owner role for the group.</li></ul><p>To set the maximum job timeout:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your group. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Build</strong> > <strong>Runners</strong>.</li><li>To the right of the runner you want to edit, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>In the <strong>Maximum job timeout</strong> field, enter a value in seconds. The minimum value is 600 seconds (10 minutes).</li><li>Select <strong>Save changes</strong>.</li></ol><h3 id=for-a-project-runner>For a project runner</h3><p>Prerequisites:</p><ul><li>You must have the Owner role for the project.</li></ul><p>To set the maximum job timeout:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Settings</strong> > <strong>CI/CD</strong>.</li><li>Expand <strong>Runners</strong>.</li><li>To the right of the runner you want to edit, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>In the <strong>Maximum job timeout</strong> field, enter a value in seconds. The minimum value is 600 seconds (10 minutes). If not defined, the <a href=/ci/pipelines/settings/#set-a-limit-for-how-long-jobs-can-run>job timeout for the project</a> is used instead.</li><li>Select <strong>Save changes</strong>.</li></ol><h2 id=how-maximum-job-timeout-works>How maximum job timeout works</h2><p><strong>Example 1 - Runner timeout bigger than project timeout</strong></p><ol><li>You set the <code>maximum_timeout</code> parameter for a runner to 24 hours.</li><li>You set the <strong>Maximum job timeout</strong> for a project to <strong>2 hours</strong>.</li><li>You start a job.</li><li>The job, if running longer, times out after <strong>2 hours</strong>.</li></ol><p><strong>Example 2 - Runner timeout not configured</strong></p><ol><li>You remove the <code>maximum_timeout</code> parameter configuration from a runner.</li><li>You set the <strong>Maximum job timeout</strong> for a project to <strong>2 hours</strong>.</li><li>You start a job.</li><li>The job, if running longer, times out after <strong>2 hours</strong>.</li></ol><p><strong>Example 3 - Runner timeout smaller than project timeout</strong></p><ol><li>You set the <code>maximum_timeout</code> parameter for a runner to <strong>30 minutes</strong>.</li><li>You set the <strong>Maximum job timeout</strong> for a project to 2 hours.</li><li>You start a job.</li><li>The job, if running longer, times out after <strong>30 minutes</strong>.</li></ol><h2 id=set-script-and-after_script-timeouts>Set <code>script</code> and <code>after_script</code> timeouts</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-4 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-4>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-4 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/4335>Introduced</a> in GitLab Runner 16.4.</li></ul></div></div><p>To control the amount of time <code>script</code> and <code>after_script</code> runs before it terminates, specify a timeout value in the <code>.gitlab-ci.yml</code> file.</p><p>For example, you can specify a timeout to terminate a long-running <code>script</code> early. This ensures artifacts and caches can still be uploaded
before the <a href=/ci/pipelines/settings/#set-a-limit-for-how-long-jobs-can-run>job timeout</a> is exceeded.
The timeout values for <code>script</code> and <code>after_script</code> must be less than the job timeout.</p><ul><li>To set a timeout for <code>script</code>, use the job variable <code>RUNNER_SCRIPT_TIMEOUT</code>.</li><li>To set a timeout for <code>after_script</code>, and override the default of 5 minutes, use the job variable <code>RUNNER_AFTER_SCRIPT_TIMEOUT</code>.</li></ul><p>Both of these variables accept <a href=https://pkg.go.dev/time#ParseDuration>Go&rsquo;s duration format</a> (for example, <code>40s</code>, <code>1h20m</code>, <code>2h</code> <code>4h30m30s</code>).</p><p>For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>job-with-script-timeouts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>RUNNER_SCRIPT_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class=l>15m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>RUNNER_AFTER_SCRIPT_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;I am allowed to run for min(15m, remaining job timeout).&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>after_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;I am allowed to run for min(10m, remaining job timeout).&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job-artifact-upload-on-timeout</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>1h                          </span><span class=w> </span><span class=c># set job timeout to 1 hour</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>RUNNER_SCRIPT_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class=l>50m        </span><span class=w> </span><span class=c># only allow script to run for 50 minutes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>long-running-process &gt; output.txt</span><span class=w> </span><span class=c># will be terminated after 50m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w> </span><span class=c># artifacts will have roughly ~10m to upload</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>output.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>on_failure</span><span class=w> </span><span class=c># on_failure because script termination after a timeout is treated as a failure</span></span></span></code></pre></div></div><h3 id=ensuring-after_script-execution>Ensuring <code>after_script</code> execution</h3><p>For <code>after_script</code> to run successfully, the total of <code>RUNNER_SCRIPT_TIMEOUT</code> +
<code>RUNNER_AFTER_SCRIPT_TIMEOUT</code> must not exceed the job&rsquo;s configured timeout.</p><p>The following example shows how to configure timeouts to ensure <code>after_script</code> runs even when the main script times out:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>job-with-script-timeouts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>5m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>RUNNER_SCRIPT_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class=l>1m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>RUNNER_AFTER_SCRIPT_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class=l>1m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;Starting build...&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sleep 120</span><span class=w> </span><span class=c># Wait 2 minutes to trigger timeout. Script aborts after 1 minute due to RUNNER_SCRIPT_TIMEOUT.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;Build finished.&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>after_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;Starting Clean-up...&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sleep 15</span><span class=w> </span><span class=c># Wait just a few seconds. Runs successfully because it&#39;s within RUNNER_AFTER_SCRIPT_TIMEOUT.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;Clean-up finished.&#34;</span></span></span></code></pre></div></div><p>The <code>script</code> is canceled by <code>RUNNER_SCRIPT_TIMEOUT</code>, but the <code>after_script</code> runs successfully because it takes 15 seconds,
which is less than both <code>RUNNER_AFTER_SCRIPT_TIMEOUT</code> and the job&rsquo;s <code>timeout</code> value.</p><h2 id=protecting-sensitive-information>Protecting sensitive information</h2><p>The security risks are greater when using instance runners as they are available by default to all groups and projects in a GitLab instance.
The runner executor and file system configuration affects security. Users with access to the runner host environment can view the code that runner executed and the runner authentication.
For example, users with access to the runner authentication token can clone
a runner and submit false jobs in a vector attack. For more information, see <a href=https://docs.gitlab.com/runner/security/>Security Considerations</a>.</p><h2 id=configuring-long-polling>Configuring long polling</h2><p>To reduce job queueing times and load on your GitLab server, configure <a href=/ci/runners/long_polling/>long polling</a>.</p><h2 id=using-instance-runners-in-forked-projects>Using instance runners in forked projects</h2><p>When a project is forked, the job settings related to jobs are copied. If you have instance runners
configured for a project and a user forks that project, the instance runners serve jobs of this project.</p><p>Due to a <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/364303>known issue</a>, if the runner settings
of the forked project does not match the new project namespace, the following message displays:
<code>An error occurred while forking the project. Please try again.</code>.</p><p>To work around this issue, ensure that the instance runner settings are consistent in the forked project and the new namespace.</p><ul><li>If instance runners are <strong>enabled</strong> on the forked project, then this should also be <strong>enabled</strong> on the new namespace.</li><li>If instance runners are <strong>disabled</strong> on the forked project, then this should also be <strong>disabled</strong> on the new namespace.</li></ul><h2 id=reset-the-runner-registration-token-for-a-project-deprecated>Reset the runner registration token for a project (deprecated)</h2><div class="alert alert-type-warning gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>The option to pass runner registration tokens and support for certain configuration arguments is considered legacy
and is not recommended.
Use the <a href=https://docs.gitlab.com/runner/register/#register-with-a-runner-authentication-token>runner creation workflow</a>
to generate an authentication token to register runners. This process provides full
traceability of runner ownership and enhances your runner fleet&rsquo;s security.
For more information, see
<a href=/ci/runners/new_creation_workflow/>Migrating to the new runner registration workflow</a>.</p></div></div><p>If you think that a registration token for a project was revealed, you should
reset it. A registration token can be used to register another runner for the project.
That new runner may then be used to obtain the values of secret variables or to clone project code.</p><p>To reset the registration token:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Settings</strong> > <strong>CI/CD</strong>.</li><li>Expand <strong>Runners</strong>.</li><li>To the right of <strong>New project runner</strong>, select the vertical ellipsis (<span> <svg role="img" aria-label="ellipsis_v" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#ellipsis_v"/><title>ellipsis_v</title></svg> </span>).</li><li>Select <strong>Reset registration token</strong>.</li><li>Select <strong>Reset token</strong>.</li></ol><p>After you reset the registration token, it is no longer valid and does not register
any new runners to the project. You should also update the registration token in tools
you use to provision and register new values.</p><h2 id=authentication-token-security>Authentication token security</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-7 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-7>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-7 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/30942>Introduced</a> in GitLab 15.3 <a href=/administration/feature_flags/>with a flag</a> named <code>enforce_runner_token_expires_at</code>. Disabled by default.</li><li><a href=https://gitlab.com/gitlab-org/gitlab/-/issues/377902>Generally available</a> in GitLab 15.5. Feature flag <code>enforce_runner_token_expires_at</code> removed.</li></ul></div></div><p>Each runner uses a <a href=/api/runners/#registration-and-authentication-tokens>runner authentication token</a>
to connect to and authenticate with a GitLab instance.</p><p>To help prevent the token from being compromised, you can have the
token rotate automatically at specified intervals. When the tokens are rotated,
they are updated for each runner, regardless of the runner&rsquo;s status (<code>online</code> or <code>offline</code>).</p><p>No manual intervention should be required, and no running jobs should be affected.
For more information about token rotation, see
<a href=/ci/runners/new_creation_workflow/#runner-authentication-token-does-not-update-when-rotated>Runner authentication token does not update when rotated</a>.</p><p>If you need to manually update the runner authentication token, you can run a
command to <a href=https://docs.gitlab.com/runner/commands/#gitlab-runner-reset-token>reset the token</a>.</p><h3 id=reset-the-runner-configuration-authentication-token>Reset the runner configuration authentication token</h3><p>If a runner&rsquo;s authentication token is exposed, an attacker could use it to <a href=https://docs.gitlab.com/runner/security/#cloning-a-runner>clone the runner</a>.</p><p>To reset the runner configuration authentication token:</p><ol><li>Delete the runner:<ul><li><a href=/ci/runners/runners_scope/#delete-instance-runners>Delete an instance runner</a>.</li><li><a href=/ci/runners/runners_scope/#delete-a-group-runner>Delete a group runner</a>.</li><li><a href=/ci/runners/runners_scope/#delete-a-project-runner>Delete a project runner</a>.</li></ul></li><li>Create a new runner so that it is assigned a new runner authentication token:<ul><li><a href=/ci/runners/runners_scope/#create-an-instance-runner-with-a-runner-authentication-token>Create an instance runner</a>.</li><li><a href=/ci/runners/runners_scope/#create-a-group-runner-with-a-runner-authentication-token>Create a group runner</a>.</li><li><a href=/ci/runners/runners_scope/#create-a-project-runner-with-a-runner-authentication-token>Create a project runner</a>.</li></ul></li><li>Optional. To verify that the previous runner authentication token has been revoked, use the <a href=/api/runners/#verify-authentication-for-a-registered-runner>Runners API</a>.</li></ol><p>To reset runner configuration authentication tokens, you can also use the <a href=/api/runners/>Runners API</a>.</p><h3 id=automatically-rotate-runner-authentication-tokens>Automatically rotate runner authentication tokens</h3><p>You can specify an interval to rotate runner authentication tokens.
Regularly rotating runner authentication tokens helps minimize the risk of unauthorized access to your GitLab instance through compromised tokens.</p><p>Prerequisites:</p><ul><li>Runners must use <a href=https://docs.gitlab.com/runner/#gitlab-runner-versions>GitLab Runner 15.3 or later</a>.</li><li>You must be an administrator.</li></ul><p>To automatically rotate runner authentication tokens:</p><ol><li>On the left sidebar, at the bottom, select <strong>Admin</strong>. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, in the upper-right corner, select <strong>Admin</strong>.</li><li>Select <strong>Settings</strong> > <strong>CI/CD</strong>.</li><li>Expand <strong>Continuous Integration and Deployment</strong>.</li><li>Set a <strong>Runners expiration</strong> time for runners, leave empty for no expiration.</li><li>Select <strong>Save changes</strong>.</li></ol><p>Before the interval expires, runners automatically request a new runner authentication token.
For more information about token rotation, see
<a href=/ci/runners/new_creation_workflow/#runner-authentication-token-does-not-update-when-rotated>Runner authentication token does not update when rotated</a>.</p><h2 id=prevent-runners-from-revealing-sensitive-information>Prevent runners from revealing sensitive information</h2><p>To ensure runners don&rsquo;t reveal sensitive information, you can configure them to only run jobs
on <a href=/user/project/repository/branches/protected/>protected branches</a>, or jobs that have <a href=/user/project/protected_tags/>protected tags</a>.</p><p>Runners configured to run jobs on protected branches can
<a href=/ci/pipelines/merge_request_pipelines/#control-access-to-protected-variables-and-runners>optionally run jobs in merge request pipelines</a>.</p><h3 id=for-an-instance-runner-1>For an instance runner</h3><p>Prerequisites:</p><ul><li>You must be an administrator.</li></ul><ol><li>On the left sidebar, at the bottom, select <strong>Admin</strong>. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, in the upper-right corner, select <strong>Admin</strong>.</li><li>Select <strong>CI/CD > Runners</strong>.</li><li>To the right of the runner you want to protect, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>Select the <strong>Protected</strong> checkbox.</li><li>Select <strong>Save changes</strong>.</li></ol><h3 id=for-a-group-runner-1>For a group runner</h3><p>Prerequisites:</p><ul><li>You must have the Owner role for the group.</li></ul><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your group. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Build</strong> > <strong>Runners</strong>.</li><li>To the right of the runner you want to protect, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>Select the <strong>Protected</strong> checkbox.</li><li>Select <strong>Save changes</strong>.</li></ol><h3 id=for-a-project-runner-1>For a project runner</h3><p>Prerequisites:</p><ul><li>You must have the Owner role for the project.</li></ul><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Settings</strong> > <strong>CI/CD</strong>.</li><li>Expand <strong>Runners</strong>.</li><li>To the right of the runner you want to protect, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>Select the <strong>Protected</strong> checkbox.</li><li>Select <strong>Save changes</strong>.</li></ol><h2 id=control-jobs-that-a-runner-can-run>Control jobs that a runner can run</h2><p>You can use <a href=/ci/yaml/#tags>tags</a> to control the jobs a runner can run.
For example, you can specify the <code>rails</code> tag for runners that have the dependencies to run
Rails test suites.</p><p>GitLab CI/CD tags are different to Git tags. GitLab CI/CD tags are associated with runners.
Git tags are associated with commits.</p><h3 id=for-an-instance-runner-2>For an instance runner</h3><p>Prerequisites:</p><ul><li>You must be an administrator.</li></ul><p>To control the jobs that an instance runner can run:</p><ol><li>On the left sidebar, at the bottom, select <strong>Admin</strong>. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, in the upper-right corner, select <strong>Admin</strong>.</li><li>Select <strong>CI/CD > Runners</strong>.</li><li>To the right of the runner you want to edit, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>Set the runner to run tagged or untagged jobs:<ul><li>To run tagged jobs, in the <strong>Tags</strong> field, enter the job tags separated with a comma. For example, <code>macos</code>, <code>rails</code>.</li><li>To run untagged jobs, select the <strong>Run untagged jobs</strong> checkbox.</li></ul></li><li>Select <strong>Save changes</strong>.</li></ol><h3 id=for-a-group-runner-2>For a group runner</h3><p>Prerequisites:</p><ul><li>You must have the Owner role for the group.</li></ul><p>To control the jobs that a group runner can run:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your group. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Build</strong> > <strong>Runners</strong>.</li><li>To the right of the runner you want to edit, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>Set the runner to run tagged or untagged jobs:<ul><li>To run tagged jobs, in the <strong>Tags</strong> field, enter the job tags separated with a comma. For example, <code>macos</code>, <code>ruby</code>.</li><li>To run untagged jobs, select the <strong>Run untagged jobs</strong> checkbox.</li></ul></li><li>Select <strong>Save changes</strong>.</li></ol><h3 id=for-a-project-runner-2>For a project runner</h3><p>Prerequisites:</p><ul><li>You must have the Owner role for the project.</li></ul><p>To control the jobs that a project runner can run:</p><ol><li>On the left sidebar, select <strong>Search or go to</strong> and find your project. If you&rsquo;ve <a href=/user/interface_redesign/#turn-new-navigation-on-or-off>turned on the new navigation</a>, this field is on the top bar.</li><li>Select <strong>Settings</strong> > <strong>CI/CD</strong>.</li><li>Expand <strong>Runners</strong>.</li><li>To the right of the runner you want to edit, select <strong>Edit</strong> (<span> <svg role="img" aria-label="pencil" class="gl-icon s16"><use href="/gitlab_ui/svgs-latest/icons.svg#pencil"/><title>pencil</title></svg> </span>).</li><li>Set the runner to run tagged or untagged jobs:<ul><li>To run tagged jobs, in the <strong>Tags</strong> field, enter the job tags separated with a comma. For example, <code>macos</code>, <code>ruby</code>.</li><li>To run untagged jobs, select the <strong>Run untagged jobs</strong> checkbox.</li></ul></li><li>Select <strong>Save changes</strong>.</li></ol><h3 id=how-the-runner-uses-tags>How the runner uses tags</h3><h4 id=runner-runs-only-tagged-jobs>Runner runs only tagged jobs</h4><p>The following examples illustrate the potential impact of the runner being set
to run only tagged jobs.</p><p>Example 1:</p><ol><li>The runner is configured to run only tagged jobs and has the <code>docker</code> tag.</li><li>A job that has a <code>hello</code> tag is executed and stuck.</li></ol><p>Example 2:</p><ol><li>The runner is configured to run only tagged jobs and has the <code>docker</code> tag.</li><li>A job that has a <code>docker</code> tag is executed and run.</li></ol><p>Example 3:</p><ol><li>The runner is configured to run only tagged jobs and has the <code>docker</code> tag.</li><li>A job that has no tags defined is executed and stuck.</li></ol><h4 id=runner-is-allowed-to-run-untagged-jobs>Runner is allowed to run untagged jobs</h4><p>The following examples illustrate the potential impact of the runner being set
to run tagged and untagged jobs.</p><p>Example 1:</p><ol><li>The runner is configured to run untagged jobs and has the <code>docker</code> tag.</li><li>A job that has no tags defined is executed and run.</li><li>A second job that has a <code>docker</code> tag defined is executed and run.</li></ol><p>Example 2:</p><ol><li>The runner is configured to run untagged jobs and has no tags defined.</li><li>A job that has no tags defined is executed and run.</li><li>A second job that has a <code>docker</code> tag defined is stuck.</li></ol><h4 id=a-runner-and-a-job-have-multiple-tags>A runner and a job have multiple tags</h4><p>The selection logic that matches the job and runner is based on the list of <code>tags</code>
defined in the job.</p><p>The following examples illustrate the impact of a runner and a job having multiple tags. For a runner to be
selected to run a job, it must have all of the tags defined in the job script block.</p><p>Example 1:</p><ol><li>The runner is configured with the tags <code>[docker, shell, gpu]</code>.</li><li>The job has the tags <code>[docker, shell, gpu]</code> and is executed and run.</li></ol><p>Example 2:</p><ol><li>The runner is configured with the tags <code>[docker, shell, gpu]</code>.</li><li>The job has the tags <code>[docker, shell,]</code> and is executed and run.</li></ol><p>Example 3:</p><ol><li>The runner is configured with the tags <code>[docker, shell]</code>.</li><li>The job has the tags <code>[docker, shell, gpu]</code> and is not executed.</li></ol><h3 id=use-tags-to-run-jobs-on-different-platforms>Use tags to run jobs on different platforms</h3><p>You can use tags to run different jobs on different platforms. For
example, if you have an OS X runner with tag <code>osx</code> and a Windows runner with tag
<code>windows</code>, you can run a job on each platform.</p><p>Update the <code>tags</code> field in the <code>.gitlab-ci.yml</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>windows job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tags</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo Hello, %USERNAME%!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>osx job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tags</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>osx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;Hello, $USER!&#34;</span></span></span></code></pre></div></div><h3 id=use-cicd-variables-in-tags>Use CI/CD variables in tags</h3><p>In the <code>.gitlab-ci.yml</code> file, use <a href=/ci/variables/>CI/CD variables</a> with <code>tags</code> for dynamic runner selection:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>KUBERNETES_RUNNER</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>tags</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>docker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>$KUBERNETES_RUNNER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>echo &#34;Hello runner selector feature&#34;</span></span></span></code></pre></div></div><h2 id=configure-runner-behavior-with-variables>Configure runner behavior with variables</h2><p>You can use <a href=/ci/variables/>CI/CD variables</a> to configure runner Git behavior
globally or for individual jobs:</p><ul><li><a href=/ci/runners/configure_runners/#git-strategy><code>GIT_STRATEGY</code></a></li><li><a href=/ci/runners/configure_runners/#git-submodule-strategy><code>GIT_SUBMODULE_STRATEGY</code></a></li><li><a href=/ci/runners/configure_runners/#git-checkout><code>GIT_CHECKOUT</code></a></li><li><a href=/ci/runners/configure_runners/#git-clean-flags><code>GIT_CLEAN_FLAGS</code></a></li><li><a href=/ci/runners/configure_runners/#git-fetch-extra-flags><code>GIT_FETCH_EXTRA_FLAGS</code></a></li><li><a href=/ci/runners/configure_runners/#git-clone-extra-flags><code>GIT_CLONE_EXTRA_FLAGS</code></a></li><li><a href=/ci/runners/configure_runners/#git-submodule-update-flags><code>GIT_SUBMODULE_UPDATE_FLAGS</code></a></li><li><a href=/ci/runners/configure_runners/#rewrite-submodule-urls-to-https><code>GIT_SUBMODULE_FORCE_HTTPS</code></a></li><li><a href=/ci/runners/configure_runners/#shallow-cloning><code>GIT_DEPTH</code></a> (shallow cloning)</li><li><a href=/ci/runners/configure_runners/#git-submodule-depth><code>GIT_SUBMODULE_DEPTH</code></a></li><li><a href=/ci/runners/configure_runners/#custom-build-directories><code>GIT_CLONE_PATH</code></a> (custom build directories)</li><li><a href=/ci/runners/configure_runners/#artifact-and-cache-settings><code>TRANSFER_METER_FREQUENCY</code></a> (artifact/cache meter update frequency)</li><li><a href=/ci/runners/configure_runners/#artifact-and-cache-settings><code>ARTIFACT_COMPRESSION_LEVEL</code></a> (artifact archiver compression level)</li><li><a href=/ci/runners/configure_runners/#artifact-and-cache-settings><code>CACHE_COMPRESSION_LEVEL</code></a> (cache archiver compression level)</li><li><a href=/ci/runners/configure_runners/#artifact-and-cache-settings><code>CACHE_REQUEST_TIMEOUT</code></a> (cache request timeout)</li><li><a href=/ci/runners/configure_runners/#set-script-and-after_script-timeouts><code>RUNNER_SCRIPT_TIMEOUT</code></a></li><li><a href=/ci/runners/configure_runners/#set-script-and-after_script-timeouts><code>RUNNER_AFTER_SCRIPT_TIMEOUT</code></a></li><li><a href=/ci/runners/configure_runners/#ignore-errors-in-after_script><code>AFTER_SCRIPT_IGNORE_ERRORS</code></a></li></ul><p>You can also use variables to configure how many times a runner
<a href=/ci/runners/configure_runners/#job-stages-attempts>attempts certain stages of job execution</a>.</p><p>When using the Kubernetes executor, you can use variables to
<a href=https://docs.gitlab.com/runner/executors/kubernetes/#overwrite-container-resources>override Kubernetes CPU and memory allocations for requests and limits</a>.</p><p><a href=https://docs.gitlab.com/runner/configuration/feature-flags/#available-feature-flags>Runner feature flags</a> are also accepted as
<a href=https://docs.gitlab.com/runner/configuration/feature-flags/#enable-feature-flag-in-pipeline-configuration>job and pipeline variables</a>.</p><h3 id=git-strategy>Git strategy</h3><p>The <code>GIT_STRATEGY</code> variable configures how the build directory is prepared and
repository content is fetched. You can set this variable globally or per job
in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_STRATEGY</span><span class=p>:</span><span class=w> </span><span class=l>clone</span></span></span></code></pre></div></div><p>Possible values are <code>clone</code>, <code>fetch</code>, <code>none</code>, and <code>empty</code>. If you do not specify a value,
jobs use the <a href=/ci/pipelines/settings/#choose-the-default-git-strategy>project&rsquo;s pipeline setting</a>.</p><p><code>clone</code> is the slowest option. It clones the repository from scratch for every
job, ensuring that the local working copy is always pristine.
If an existing worktree is found, it is removed before cloning.</p><p><code>fetch</code> is faster as it re-uses the local working copy (falling back to <code>clone</code>
if it does not exist). <code>git clean</code> is used to undo any changes made by the last
job, and <code>git fetch</code> is used to retrieve commits made after the last job ran.</p><p>However, <code>fetch</code> does require access to the previous worktree. This works
well when using the <code>shell</code> or <code>docker</code> executor because these
try to preserve worktrees and try to re-use them by default.</p><p>This has limitations when using the <a href=https://docs.gitlab.com/runner/executors/docker_machine.html>Docker Machine executor</a>.</p><p>A Git strategy of <code>none</code> also re-uses the local working copy, but skips all Git
operations usually done by GitLab. GitLab Runner pre-clone scripts are also skipped,
if present. This strategy could mean you need to add <code>fetch</code> and <code>checkout</code> commands
to <a href=/ci/yaml/#script>your <code>.gitlab-ci.yml</code> script</a>.</p><p>It can be used for jobs that operate exclusively on artifacts, like a deployment job.
Git repository data may be present, but it&rsquo;s likely out of date. You should only
rely on files brought into the local working copy from cache or artifacts. Be
aware that cache and artifact files from previous pipelines might still be present.</p><p>Unlike <code>none</code>, the <code>empty</code> Git strategy deletes and then re-creates
a dedicated build directory before downloading cache or artifact files.
With this strategy, the GitLab Runner hook scripts are still run
(if provided) to allow for further behavior customization.
Use the <code>empty</code> Git strategy when:</p><ul><li>You do not need the repository data to be present.</li><li>You want a clean, controlled, or customized starting state every time a job runs.</li></ul><h3 id=git-submodule-strategy>Git submodule strategy</h3><p>The <code>GIT_SUBMODULE_STRATEGY</code> variable is used to control if / how
<a href=https://git-scm.com/book/en/v2/Git-Tools-Submodules>Git submodules</a> are included when fetching the code before a build. You can set them
globally or per-job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p>The three possible values are <code>none</code>, <code>normal</code>, and <code>recursive</code>:</p><ul><li><p><code>none</code> means that submodules are not included when fetching the project
code. This setting matches the default behavior in versions before 1.10.</p></li><li><p><code>normal</code> means that only the top-level submodules are included. It&rsquo;s
equivalent to:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git submodule sync
</span></span><span class=line><span class=cl>git submodule update --init</span></span></code></pre></div></div></li><li><p><code>recursive</code> means that all submodules (including submodules of submodules)
are included. This feature needs Git v1.8.1 and later. When using a
GitLab Runner with an executor not based on Docker, make sure the Git version
meets that requirement. It&rsquo;s equivalent to:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git submodule sync --recursive
</span></span><span class=line><span class=cl>git submodule update --init --recursive</span></span></code></pre></div></div></li></ul><p>For this feature to work correctly, the submodules must be configured
(in <code>.gitmodules</code>) with either:</p><ul><li>the HTTP(S) URL of a publicly-accessible repository, or</li><li>a relative path to another repository on the same GitLab server. See the
<a href=/ci/runners/git_submodules/>Git submodules</a> documentation.</li></ul><p>You can provide additional flags to control advanced behavior using <a href=/ci/runners/configure_runners/#git-submodule-update-flags><code>GIT_SUBMODULE_UPDATE_FLAGS</code></a>.</p><h3 id=git-checkout>Git checkout</h3><p>The <code>GIT_CHECKOUT</code> variable can be used when the <code>GIT_STRATEGY</code> is set to either
<code>clone</code> or <code>fetch</code> to specify whether a <code>git checkout</code> should be run. If not
specified, it defaults to true. You can set them globally or per-job in the
<a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p>If set to <code>false</code>, the runner:</p><ul><li>when doing <code>fetch</code> - updates the repository and leaves the working copy on
the current revision,</li><li>when doing <code>clone</code> - clones the repository and leaves the working copy on the
default branch.</li></ul><p>If <code>GIT_CHECKOUT</code> is set to <code>true</code>, both <code>clone</code> and <code>fetch</code> work the same way.
The runner checks out the working copy of a revision related
to the CI pipeline:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_STRATEGY</span><span class=p>:</span><span class=w> </span><span class=l>clone</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_CHECKOUT</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>git checkout -B master origin/master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>git merge $CI_COMMIT_SHA</span></span></span></code></pre></div></div><h3 id=git-clean-flags>Git clean flags</h3><p>The <code>GIT_CLEAN_FLAGS</code> variable is used to control the default behavior of
<code>git clean</code> after checking out the sources. You can set it globally or per-job in the
<a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p><code>GIT_CLEAN_FLAGS</code> accepts all possible options of the <a href=https://git-scm.com/docs/git-clean><code>git clean</code></a>
command.</p><p><code>git clean</code> is disabled if <code>GIT_CHECKOUT: "false"</code> is specified.</p><p>If <code>GIT_CLEAN_FLAGS</code> is:</p><ul><li>Not specified, <code>git clean</code> flags default to <code>-ffdx</code>.</li><li>Given the value <code>none</code>, <code>git clean</code> is not executed.</li></ul><p>For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_CLEAN_FLAGS</span><span class=p>:</span><span class=w> </span>-<span class=l>ffdx -e cache/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>ls -al cache/</span></span></span></code></pre></div></div><h3 id=git-fetch-extra-flags>Git fetch extra flags</h3><p>Use the <code>GIT_FETCH_EXTRA_FLAGS</code> variable to control the behavior of
<code>git fetch</code>. You can set it globally or per-job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p><code>GIT_FETCH_EXTRA_FLAGS</code> accepts all options of the <a href=https://git-scm.com/docs/git-fetch><code>git fetch</code></a> command. However, <code>GIT_FETCH_EXTRA_FLAGS</code> flags are appended after the default flags that can&rsquo;t be modified.</p><p>The default flags are:</p><ul><li><a href=/ci/runners/configure_runners/#shallow-cloning><code>GIT_DEPTH</code></a>.</li><li>The list of <a href=https://git-scm.com/book/en/v2/Git-Internals-The-Refspec>refspecs</a>.</li><li>A remote called <code>origin</code>.</li></ul><p>If <code>GIT_FETCH_EXTRA_FLAGS</code> is:</p><ul><li>Not specified, <code>git fetch</code> flags default to <code>--prune --quiet</code> along with the default flags.</li><li>Given the value <code>none</code>, <code>git fetch</code> is executed only with the default flags.</li></ul><p>For example, the default flags are <code>--prune --quiet</code>, so you can make <code>git fetch</code> more verbose by overriding this with just <code>--prune</code>:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_FETCH_EXTRA_FLAGS</span><span class=p>:</span><span class=w> </span>--<span class=l>prune</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>ls -al cache/</span></span></span></code></pre></div></div><p>The previous configuration results in <code>git fetch</code> being called this way:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git fetch origin <span class=nv>$REFSPECS</span> --depth <span class=m>20</span>  --prune</span></span></code></pre></div></div><p>Where <code>$REFSPECS</code> is a value provided to the runner internally by GitLab.</p><h3 id=git-clone-extra-flags>Git clone extra flags</h3><p>Use the <code>GIT_CLONE_EXTRA_FLAGS</code> variable to pass extra arguments to the native <code>git clone</code> operation.
You can set it globally or per-job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p>To use <code>GIT_CLONE_EXTRA_FLAGS</code>:</p><ul><li>Set <code>FF_USE_GIT_NATIVE_CLONE</code> to <code>true</code> to enable the native <code>git clone</code> functionality.</li><li>Set <code>GIT_STRATEGY</code> to <code>clone</code> to use the clone strategy instead of fetch.</li><li>The Git client must be at least version 2.49. This condition is met automatically if the
<a href=https://docs.gitlab.com/runner/configuration/advanced-configuration/#helper-image>helper image</a>
is a Linux-flavored image, version 18.1 or later.</li></ul><p><code>GIT_CLONE_EXTRA_FLAGS</code> accepts all options of the <code>git clone</code> command. The flags are appended to the native
<code>git clone</code> command to provide flexibility for advanced use cases, including referencing alternate repositories
or optimizing clone performance.</p><p>For example, you can optimize clone performance by using a reference repository:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>FF_USE_GIT_NATIVE_CLONE</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_STRATEGY</span><span class=p>:</span><span class=w> </span><span class=l>clone</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_CLONE_EXTRA_FLAGS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;--reference-if-available /tmp/test&#34;</span></span></span></code></pre></div></div><p>If <code>GIT_CLONE_EXTRA_FLAGS</code> is not specified, <code>git clone</code> uses only the default flags.</p><h3 id=sync-or-exclude-specific-submodules-from-ci-jobs>Sync or exclude specific submodules from CI jobs</h3><p>Use the <code>GIT_SUBMODULE_PATHS</code> variable to control which submodules have to be synced or updated.
You can set it globally or per-job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p>The path syntax is the same as <a href=https://git-scm.com/docs/git-submodule#Documentation/git-submodule.txt-ltpathgt82308203><code>git submodule</code></a>:</p><ul><li><p>To sync and update specific paths:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>GIT_SUBMODULE_PATHS</span><span class=p>:</span><span class=w> </span><span class=l>submoduleA submoduleB</span></span></span></code></pre></div></div></li><li><p>To exclude specific paths:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>GIT_SUBMODULE_PATHS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;:(exclude)submoduleA :(exclude)submoduleB&#34;</span></span></span></code></pre></div></div></li></ul><div class="alert alert-type-warning gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>Git ignores nested paths. To ignore a nested submodule, exclude
the parent submodule and then manually clone it in the job&rsquo;s scripts. For example,
<code>git clone &lt;repo> --recurse-submodules=':(exclude)nested-submodule'</code>. Make sure
to wrap the string in single quotes so the YAML can be parsed successfully.</p></div></div><h3 id=git-submodule-update-flags>Git submodule update flags</h3><p>Use the <code>GIT_SUBMODULE_UPDATE_FLAGS</code> variable to control the behavior of <code>git submodule update</code>
when <a href=/ci/runners/configure_runners/#git-submodule-strategy><code>GIT_SUBMODULE_STRATEGY</code></a> is set to either <code>normal</code> or <code>recursive</code>.
You can set it globally or per-job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p><code>GIT_SUBMODULE_UPDATE_FLAGS</code> accepts all options of the
<a href=https://git-scm.com/docs/git-submodule#Documentation/git-submodule.txt-update--init--remote-N--no-fetch--no-recommend-shallow-f--force--checkout--rebase--merge--referenceltrepositorygt--depthltdepthgt--recursive--jobsltngt--no-single-branch--ltpathgt82308203><code>git submodule update</code></a>
subcommand. However, <code>GIT_SUBMODULE_UPDATE_FLAGS</code> flags are appended after a few default flags:</p><ul><li><code>--init</code>, if <a href=/ci/runners/configure_runners/#git-submodule-strategy><code>GIT_SUBMODULE_STRATEGY</code></a> was set to <code>normal</code> or <code>recursive</code>.</li><li><code>--recursive</code>, if <a href=/ci/runners/configure_runners/#git-submodule-strategy><code>GIT_SUBMODULE_STRATEGY</code></a> was set to <code>recursive</code>.</li><li><code>GIT_DEPTH</code>. See the default value in the <a href=/ci/runners/configure_runners/#shallow-cloning>shallow cloning</a> section.</li></ul><p>Git honors the last occurrence of a flag in the list of arguments, so manually
providing them in <code>GIT_SUBMODULE_UPDATE_FLAGS</code> overrides these default flags.</p><p>For example, you can use this variable to:</p><ul><li>Fetch the latest remote <code>HEAD</code> instead of the tracked commit in the
repository (default) to automatically update all submodules with the
<code>--remote</code> flag.</li><li>Speed up the checkout by fetching submodules in multiple parallel jobs with
the <code>--jobs 4</code> flag.</li></ul><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_SUBMODULE_STRATEGY</span><span class=p>:</span><span class=w> </span><span class=l>recursive</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_SUBMODULE_UPDATE_FLAGS</span><span class=p>:</span><span class=w> </span>--<span class=l>remote --jobs 4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>ls -al .git/modules/</span></span></span></code></pre></div></div><p>The previous configuration results in <code>git submodule update</code> being called this way:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git submodule update --init --depth <span class=m>20</span> --recursive --remote --jobs <span class=m>4</span></span></span></code></pre></div></div><div class="alert alert-type-warning gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>You should be aware of the implications for the security, stability, and
reproducibility of your builds when using the <code>--remote</code> flag. In most cases,
it is better to explicitly track submodule commits as designed, and update them
using an auto-remediation/dependency bot.</p><p>The <code>--remote</code> flag is not required to check out submodules at their committed
revisions. Use this flag only when you want to automatically update submodules
to their latest remote versions.</p></div></div><p>The behavior of <code>--remote</code> depends on your Git version.
If the branch specified in your superproject&rsquo;s <code>.gitmodules</code> file is different from the
default branch of the submodule repository, some Git versions will fail with this error:</p><p><code>fatal: Unable to find refs/remotes/origin/&lt;branch> revision in submodule path '&lt;submodule-path>'</code></p><p>The runner implements a &ldquo;best effort&rdquo; fallback that attempts to
pull remote refs when the submodule update fails.</p><p>If this fallback does not work with your Git version, try one of the following
workarounds:</p><ul><li>Update the submodule repository&rsquo;s default branch to match the branch set in
<code>.gitmodules</code> in the superproject.</li><li>Set <code>GIT_SUBMODULE_DEPTH</code> to <code>0</code>.</li><li>Update the submodules separately and remove the <code>--remote</code> flag from
<code>GIT_SUBMODULE_UPDATE_FLAGS</code>.</li></ul><h3 id=rewrite-submodule-urls-to-https>Rewrite submodule URLs to HTTPS</h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-16 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-16>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-16 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/3198>Introduced</a> in GitLab Runner 15.11.</li></ul></div></div><p>Use the <code>GIT_SUBMODULE_FORCE_HTTPS</code> variable to force a rewrite of all Git and SSH submodule URLs to HTTPS.
You can clone submodules that use absolute URLs on the same GitLab instance, even if they were
configured with a Git or SSH protocol.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_SUBMODULE_STRATEGY</span><span class=p>:</span><span class=w> </span><span class=l>recursive</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_SUBMODULE_FORCE_HTTPS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span></span></span></code></pre></div></div><p>When enabled, GitLab Runner uses a <a href=/ci/jobs/ci_job_token/>CI/CD job token</a> to clone the submodules.
The token uses the permissions of the user executing the job and does not require SSH credentials.</p><h3 id=shallow-cloning>Shallow cloning</h3><p>You can specify the depth of fetching and cloning using <code>GIT_DEPTH</code>.
<code>GIT_DEPTH</code> does a shallow clone of the repository and can significantly speed up cloning.
It can be helpful for repositories with a large number of commits or old, large binaries. The value is
passed to <code>git fetch</code> and <code>git clone</code>.</p><p>Newly-created projects automatically have a
<a href=/ci/pipelines/settings/#limit-the-number-of-changes-fetched-during-clone>default <code>git depth</code> value of <code>20</code></a>.</p><p>If you use a depth of <code>1</code> and have a queue of jobs or retry
jobs, jobs may fail.</p><p>Git fetching and cloning is based on a ref, such as a branch name, so runners
can&rsquo;t clone a specific commit SHA. If multiple jobs are in the queue, or
you retry an old job, the commit to be tested must be in the cloned
Git history. Setting too small a value for <code>GIT_DEPTH</code> can make
it impossible to run these old commits and <code>unresolved reference</code> is displayed in
job logs. You should then reconsider changing <code>GIT_DEPTH</code> to a higher value.</p><p>Jobs that rely on <code>git describe</code> may not work correctly when <code>GIT_DEPTH</code> is
set because only part of the Git history is present.</p><p>To fetch or clone only the last 3 commits:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_DEPTH</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3&#34;</span></span></span></code></pre></div></div><p>You can set it globally or per-job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><h3 id=git-submodule-depth>Git submodule depth</h3><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-17 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-17>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-17 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/3651>Introduced</a> in GitLab Runner 15.5.</li></ul></div></div><p>Use the <code>GIT_SUBMODULE_DEPTH</code> variable to specify the depth of fetching and cloning submodules
when <a href=/ci/runners/configure_runners/#git-submodule-strategy><code>GIT_SUBMODULE_STRATEGY</code></a> is set to either <code>normal</code> or <code>recursive</code>.
You can set it globally or for a specific job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><p>When you set the <code>GIT_SUBMODULE_DEPTH</code> variable, it overwrites the <a href=/ci/runners/configure_runners/#shallow-cloning><code>GIT_DEPTH</code></a> setting
for the submodules only.</p><p>To fetch or clone only the last 3 commits:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_SUBMODULE_DEPTH</span><span class=p>:</span><span class=w> </span><span class=m>3</span></span></span></code></pre></div></div><h3 id=custom-build-directories>Custom build directories</h3><p>By default, GitLab Runner clones the repository in a unique subpath of the
<code>$CI_BUILDS_DIR</code> directory. However, your project might require the code in a
specific directory (Go projects, for example). In that case, you can specify
the <code>GIT_CLONE_PATH</code> variable to tell the runner the directory to clone the
repository in:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_CLONE_PATH</span><span class=p>:</span><span class=w> </span><span class=l>$CI_BUILDS_DIR/project-name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pwd</span></span></span></code></pre></div></div><p>The <code>GIT_CLONE_PATH</code> must always be inside <code>$CI_BUILDS_DIR</code>. The directory set in <code>$CI_BUILDS_DIR</code>
is dependent on executor and configuration of <a href=https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section>runners.builds_dir</a>
setting.</p><p>This can only be used when <code>custom_build_dir</code> is enabled in the
<a href=https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runnerscustom_build_dir-section>runner&rsquo;s configuration</a>.</p><h4 id=handling-concurrency>Handling concurrency</h4><p>An executor that uses a concurrency greater than <code>1</code> might lead
to failures. Multiple jobs might be working on the same directory if the <code>builds_dir</code>
is shared between jobs.</p><p>The runner does not try to prevent this situation. It&rsquo;s up to the administrator
and developers to comply with the requirements of runner configuration.</p><p>To avoid this scenario, you can use a unique path in <code>$CI_BUILDS_DIR</code>, because runner
exposes two additional variables that provide a unique <code>ID</code> of concurrency:</p><ul><li><code>$CI_CONCURRENT_ID</code>: Unique ID for all jobs running in the given executor.</li><li><code>$CI_CONCURRENT_PROJECT_ID</code>: Unique ID for all jobs running in the given executor and project.</li></ul><p>The most stable configuration that should work well in any scenario and on any executor
is to use <code>$CI_CONCURRENT_ID</code> in the <code>GIT_CLONE_PATH</code>. For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_CLONE_PATH</span><span class=p>:</span><span class=w> </span><span class=l>$CI_BUILDS_DIR/$CI_CONCURRENT_ID/project-name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pwd -P</span></span></span></code></pre></div></div><p>The <code>$CI_CONCURRENT_PROJECT_ID</code> should be used in conjunction with <code>$CI_PROJECT_PATH</code>.
<code>$CI_PROJECT_PATH</code> provides a path of a repository in the <code>group/subgroup/project</code> format.
For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_CLONE_PATH</span><span class=p>:</span><span class=w> </span><span class=l>$CI_BUILDS_DIR/$CI_CONCURRENT_ID/$CI_PROJECT_PATH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pwd -P</span></span></span></code></pre></div></div><h4 id=nested-paths>Nested paths</h4><p>The value of <code>GIT_CLONE_PATH</code> expands once. You cannot nest variables
in this value.</p><p>For example, you define the following variables in your
<code>.gitlab-ci.yml</code> file:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GOPATH</span><span class=p>:</span><span class=w> </span><span class=l>$CI_BUILDS_DIR/go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GIT_CLONE_PATH</span><span class=p>:</span><span class=w> </span><span class=l>$GOPATH/src/namespace/project</span></span></span></code></pre></div></div><p>The value of <code>GIT_CLONE_PATH</code> is expanded once into
<code>$CI_BUILDS_DIR/go/src/namespace/project</code>, and results in failure
because <code>$CI_BUILDS_DIR</code> is not expanded.</p><h3 id=ignore-errors-in-after_script>Ignore errors in <code>after_script</code></h3><p>You can use <a href=/ci/yaml/#after_script><code>after_script</code></a> in a job to define an array of commands
that should run after the job&rsquo;s <code>before_script</code> and <code>script</code> sections. The <code>after_script</code> commands
run regardless of the script termination status (failure or success).</p><p>By default, GitLab Runner ignores any errors that happen when <code>after_script</code> runs.
To set the job to fail immediately on errors when <code>after_script</code> runs, set the
<code>AFTER_SCRIPT_IGNORE_ERRORS</code> CI/CD variable to <code>false</code>. For example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>AFTER_SCRIPT_IGNORE_ERRORS</span><span class=p>:</span><span class=w> </span><span class=kc>false</span></span></span></code></pre></div></div><h3 id=job-stages-attempts>Job stages attempts</h3><p>You can set the number of attempts that the running job tries to execute
the following stages:</p><table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>ARTIFACT_DOWNLOAD_ATTEMPTS</code></td><td>Number of attempts to download artifacts running a job</td></tr><tr><td><code>EXECUTOR_JOB_SECTION_ATTEMPTS</code></td><td>The number of attempts to run a section in a job after a <a href=https://gitlab.com/gitlab-org/gitlab-runner/-/issues/4450><code>No Such Container</code></a> error (<a href=https://docs.gitlab.com/runner/executors/docker.html>Docker executor</a> only).</td></tr><tr><td><code>GET_SOURCES_ATTEMPTS</code></td><td>Number of attempts to fetch sources running a job</td></tr><tr><td><code>RESTORE_CACHE_ATTEMPTS</code></td><td>Number of attempts to restore the cache running a job</td></tr></tbody></table><p>The default is one single attempt.</p><p>Example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>GET_SOURCES_ATTEMPTS</span><span class=p>:</span><span class=w> </span><span class=m>3</span></span></span></code></pre></div></div><p>You can set them globally or per-job in the <a href=/ci/yaml/#variables><code>variables</code></a> section.</p><h2 id=system-calls-not-available-on-gitlabcom-instance-runners>System calls not available on GitLab.com instance runners</h2><p>GitLab.com instance runners run on CoreOS. This means that you cannot use some system calls, like <code>getlogin</code>, from the C standard library.</p><h2 id=artifact-and-cache-settings>Artifact and cache settings</h2><p>Artifact and cache settings control the compression ratio of artifacts and caches.
Use these settings to specify the size of the archive produced by a job.</p><ul><li>On a slow network, uploads might be faster for smaller archives.</li><li>On a fast network where bandwidth and storage are not a concern, uploads might be faster using the fastest compression ratio, despite the archive produced being larger.</li></ul><p>For <a href=/user/project/pages/>GitLab Pages</a> to serve
<a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests>HTTP Range requests</a>, artifacts
should use the <code>ARTIFACT_COMPRESSION_LEVEL: fastest</code> setting, as only uncompressed zip archives
support this feature.</p><p>A meter can be enabled to provide the rate of transfer for uploads and downloads.</p><p>You can set a maximum time for cache upload and download with the <code>CACHE_REQUEST_TIMEOUT</code> setting.
Use this setting when slow cache uploads substantially increase the duration of your job.</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># output upload and download progress every 2 seconds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>TRANSFER_METER_FREQUENCY</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Use fast compression for artifacts, resulting in larger archives</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ARTIFACT_COMPRESSION_LEVEL</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;fast&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Use no compression for caches</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>CACHE_COMPRESSION_LEVEL</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;fastest&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Set maximum duration of cache upload and download</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>CACHE_REQUEST_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class=m>5</span></span></span></code></pre></div></div><table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>TRANSFER_METER_FREQUENCY</code></td><td>Specify how often to print the meter&rsquo;s transfer rate. It can be set to a duration (for example, <code>1s</code> or <code>1m30s</code>). A duration of <code>0</code> disables the meter (default). When a value is set, the pipeline shows a progress meter for artifact and cache uploads and downloads.</td></tr><tr><td><code>ARTIFACT_COMPRESSION_LEVEL</code></td><td>To adjust compression ratio, set to <code>fastest</code>, <code>fast</code>, <code>default</code>, <code>slow</code>, or <code>slowest</code>. This setting works with the Fastzip archiver only, so the GitLab Runner feature flag <a href=https://docs.gitlab.com/runner/configuration/feature-flags.html#available-feature-flags><code>FF_USE_FASTZIP</code></a> must also be enabled.</td></tr><tr><td><code>CACHE_COMPRESSION_LEVEL</code></td><td>To adjust compression ratio, set to <code>fastest</code>, <code>fast</code>, <code>default</code>, <code>slow</code>, or <code>slowest</code>. This setting works with the Fastzip archiver only, so the GitLab Runner feature flag <a href=https://docs.gitlab.com/runner/configuration/feature-flags.html#available-feature-flags><code>FF_USE_FASTZIP</code></a> must also be enabled.</td></tr><tr><td><code>CACHE_REQUEST_TIMEOUT</code></td><td>Configure the maximum duration of cache upload and download operations for a single job in minutes. Default is <code>10</code> minutes.</td></tr></tbody></table><h2 id=artifact-provenance-metadata>Artifact provenance metadata</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-18 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-18>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-18 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab-runner/-/issues/28940>Introduced</a> in GitLab Runner 15.1.</li></ul></div></div><p>Runners can generate an <a href=https://slsa.dev/spec/v1.0/provenance>SLSA Provenance</a>
and produce an <a href=https://slsa.dev/spec/v1.0/attestation-model#model-and-terminology>SLSA Statement</a>
that binds the provenance to all build artifacts.
The statement is called artifact provenance metadata.</p><p>To enable artifact provenance metadata, set the <code>RUNNER_GENERATE_ARTIFACTS_METADATA</code> environment
variable to <code>true</code>. You can set the variable globally or for individual jobs:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>RUNNER_GENERATE_ARTIFACTS_METADATA</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>job1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>RUNNER_GENERATE_ARTIFACTS_METADATA</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span></span></span></code></pre></div></div><p>The metadata renders in a plain text <code>.json</code> file stored with the artifact. The
filename is <code>{ARTIFACT_NAME}-metadata.json</code>. <code>ARTIFACT_NAME</code> is the
<a href=/ci/jobs/job_artifacts/#with-an-explicitly-defined-artifact-name>name for the artifact</a>
defined in the <code>.gitlab-ci.yml</code> file. If the name is not defined, the default filename is
<code>artifacts-metadata.json</code>.</p><h3 id=provenance-metadata-format>Provenance metadata format</h3><p>The artifact provenance metadata is generated in the
<a href=https://github.com/in-toto/attestation/tree/v0.1.0/spec#statement>in-toto v0.1 Statement</a> format.
It contains a provenance predicate generated in the <a href=https://slsa.dev/spec/v1.0/provenance>SLSA 1.0 Provenance</a> format.</p><p>These fields are populated by default:</p><table><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody><tr><td><code>_type</code></td><td><code>https://in-toto.io/Statement/v0.1</code></td></tr><tr><td><code>subject</code></td><td>Set of software artifacts the metadata applies to</td></tr><tr><td><code>subject[].name</code></td><td>The filename of the artifact.</td></tr><tr><td><code>subject[].sha256</code></td><td>The artifact&rsquo;s <code>sha256</code> checksum.</td></tr><tr><td><code>predicateType</code></td><td><code>https://slsa.dev/provenance/v1</code></td></tr><tr><td><code>predicate.buildDefinition.buildType</code></td><td><code>https://gitlab.com/gitlab-org/gitlab-runner/-/blob/{GITLAB_RUNNER_VERSION}/PROVENANCE.md</code>. For example, v15.0.0</td></tr><tr><td><code>predicate.runDetails.builder.id</code></td><td>A URI pointing to the runner details page, for example, <code>https://gitlab.com/gitlab-com/www-gitlab-com/-/runners/3785264</code>.</td></tr><tr><td><code>predicate.buildDefinition.externalParameters</code></td><td>The names of any CI/CD or environment variables available during the build command execution. The value is always represented as an empty string to protect secrets.</td></tr><tr><td><code>predicate.buildDefinition.externalParameters.source</code></td><td>The URL of the project.</td></tr><tr><td><code>predicate.buildDefinition.externalParameters.entryPoint</code></td><td>The name of the CI/CD job that triggered the build.</td></tr><tr><td><code>predicate.buildDefinition.internalParameters.name</code></td><td>The name of the runner.</td></tr><tr><td><code>predicate.buildDefinition.internalParameters.executor</code></td><td>The runner executor.</td></tr><tr><td><code>predicate.buildDefinition.internalParameters.architecture</code></td><td>The architecture on which the CI/CD job is run.</td></tr><tr><td><code>predicate.buildDefinition.internalParameters.job</code></td><td>The ID of the CI/CD job that triggered the build.</td></tr><tr><td><code>predicate.buildDefinition.resolvedDependencies[0].uri</code></td><td>The URL of the project.</td></tr><tr><td><code>predicate.buildDefinition.resolvedDependencies[0].digest.sha256</code></td><td>The commit revision of the project.</td></tr><tr><td><code>predicate.runDetails.metadata.invocationID</code></td><td>The ID of the CI/CD job that triggered the build.</td></tr><tr><td><code>predicate.runDetails.metadata.startedOn</code></td><td>The time when the build was started. This field is <code>RFC3339</code> formatted.</td></tr><tr><td><code>predicate.runDetails.metadata.finishedOn</code></td><td>The time when the build ended. Because metadata generation happens during the build, this time is slightly earlier than the one reported in GitLab. This field is <code>RFC3339</code> formatted.</td></tr></tbody></table><p>A provenance statement should look similar to this example:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=json class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;_type&#34;</span><span class=p>:</span> <span class=s2>&#34;https://in-toto.io/Statement/v0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;predicateType&#34;</span><span class=p>:</span> <span class=s2>&#34;https://slsa.dev/provenance/v1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;subject&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;x.txt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;digest&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sha256&#34;</span><span class=p>:</span> <span class=s2>&#34;ac097997b6ec7de591d4f11315e4aa112e515bb5d3c52160d0c571298196ea8b&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;y.txt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;digest&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sha256&#34;</span><span class=p>:</span> <span class=s2>&#34;9eb634f80da849d828fcf42740d823568c49e8d7b532886134f9086246b1fdf3&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>],</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;predicate&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;buildDefinition&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;buildType&#34;</span><span class=p>:</span> <span class=s2>&#34;https://gitlab.com/gitlab-org/gitlab-runner/-/blob/2147fb44/PROVENANCE.md&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;externalParameters&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI_API_GRAPHQL_URL&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI_API_V4_URL&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI_COMMIT_AUTHOR&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI_COMMIT_BEFORE_SHA&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI_COMMIT_BRANCH&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI_COMMIT_DESCRIPTION&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CI_COMMIT_MESSAGE&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>[...</span> <span class=err>additional</span> <span class=err>environmental</span> <span class=err>variables</span> <span class=err>...]</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;entryPoint&#34;</span><span class=p>:</span> <span class=s2>&#34;build-job&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;source&#34;</span><span class=p>:</span> <span class=s2>&#34;https://gitlab.com/my-group/my-project/test-runner-generated-slsa-statement&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>},</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;internalParameters&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;architecture&#34;</span><span class=p>:</span> <span class=s2>&#34;amd64&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;executor&#34;</span><span class=p>:</span> <span class=s2>&#34;docker+machine&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;job&#34;</span><span class=p>:</span> <span class=s2>&#34;10340684631&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;green-4.saas-linux-small-amd64.runners-manager.gitlab.com/default&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>},</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;resolvedDependencies&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=nt>&#34;uri&#34;</span><span class=p>:</span> <span class=s2>&#34;https://gitlab.com/my-group/my-project/test-runner-generated-slsa-statement&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=nt>&#34;digest&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sha256&#34;</span><span class=p>:</span> <span class=s2>&#34;bdd2ecda9ef57b129c88617a0215afc9fb223521&#34;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;runDetails&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;builder&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;https://gitlab.com/my-group/my-project/test-runner-generated-slsa-statement/-/runners/12270857&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=nt>&#34;gitlab-runner&#34;</span><span class=p>:</span> <span class=s2>&#34;2147fb44&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>},</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;invocationID&#34;</span><span class=p>:</span> <span class=s2>&#34;10340684631&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;startedOn&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-06-13T07:25:13Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;finishedOn&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-06-13T07:25:40Z&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><h2 id=staging-directory>Staging directory</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-19 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-19>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-19 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/3403>Introduced</a> in GitLab Runner 15.0.</li></ul></div></div><p>If you do not want to archive cache and artifacts in the system&rsquo;s default temporary directory, you can specify a different directory.</p><p>You might need to change the directory if your system&rsquo;s default temporary path has constraints.
If you use a fast disk for the directory location, it can also improve performance.</p><p>To change the directory, set <code>ARCHIVER_STAGING_DIR</code> as a variable in your CI job, or use a runner variable when you register the runner (<code>gitlab register --env ARCHIVER_STAGING_DIR=&lt;dir></code>).</p><p>The directory you specify is used as the location for downloading artifacts prior to extraction. If the <code>fastzip</code> archiver is
used, this location is also used as scratch space when archiving.</p><h2 id=configure-fastzip-to-improve-performance>Configure <code>fastzip</code> to improve performance</h2><div class="collapsible-section gl-my-5"><button class="gl-align-middle gl-text-left gl-border-0 gl-pl-0" type=button aria-expanded=false aria-controls=collapsible-20 aria-label="Toggle section" data-toggle=collapse data-target=#collapsible-20>History<span class="gl-ml-2 icon"></span></button><div id=collapsible-20 class="collapsible-list collapse" aria-hidden=true><ul><li><a href=https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/3130>Introduced</a> in GitLab Runner 15.0.</li></ul></div></div><p>To tune <code>fastzip</code>, ensure the <a href=https://docs.gitlab.com/runner/configuration/feature-flags.html#available-feature-flags><code>FF_USE_FASTZIP</code></a> flag is enabled.
Then use any of the following environment variables.</p><table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>FASTZIP_ARCHIVER_CONCURRENCY</code></td><td>The number of files to be concurrently compressed. Default is the number of CPUs available.</td></tr><tr><td><code>FASTZIP_ARCHIVER_BUFFER_SIZE</code></td><td>The buffer size allocated per concurrency for each file. Data exceeding this number moves to scratch space. Default is 2 MiB.</td></tr><tr><td><code>FASTZIP_EXTRACTOR_CONCURRENCY</code></td><td>The number of files to be concurrency decompressed. Default is the number of CPUs available.</td></tr></tbody></table><p>Files in a zip archive are appended sequentially. This makes concurrent compression challenging. <code>fastzip</code> works around
this limitation by compressing files concurrently to disk first, and then copying the result back to zip archive
sequentially.</p><p>To avoid writing to disk and reading the contents back for smaller files, a small buffer per concurrency is used. This setting
can be controlled with <code>FASTZIP_ARCHIVER_BUFFER_SIZE</code>. The default size for this buffer is 2 MiB, therefore, a
concurrency of 16 allocates 32 MiB. Data that exceeds the buffer size is written to and read back from disk.
Therefore, using no buffer, <code>FASTZIP_ARCHIVER_BUFFER_SIZE: 0</code>, and only scratch space is a valid option.</p><p><code>FASTZIP_ARCHIVER_CONCURRENCY</code> controls how many files are compressed concurrency. As previously mentioned, this setting
therefore can increase how much memory is being used. It can also increase the temporary data written to the scratch space.
The default is the number of CPUs available, but given the memory ramifications, this may not always be the best
setting.</p><p><code>FASTZIP_EXTRACTOR_CONCURRENCY</code> controls how many files are decompressed at once. Files from a zip archive can natively
be read from concurrency, so no additional memory is allocated in addition to what the extractor requires. This
defaults to the number of CPUs available.</p></div><div data-vue-app=back-to-top-button></div></div><div class="feedback gl-min-h-8" data-ga-section=feedback data-elastic-exclude><div data-component=docs-feedback></div></div></div><aside class=sidebar-right><div data-ga-section=toc data-vue-app=toc></div></aside></div></main><footer data-ga-section=footer><section data-ga-section=footer><div id=footer class="footer-section container gl-grid gl-grid-cols-2 gl-grid-rows-3 gl-grid-rows-auto gl-gap-8 lg:gl-grid-cols-5 lg:gl-grid-rows-1 lg:gl-justify-items-center gl-px-8 gl-py-8 lg:gl-py-10"><div class="gl-col-span-2 lg:gl-col-span-1 gl-row-start-1"><div class="docs-title gl-flex gl-items-center"><a href=/><img src=/gitlab-logo-footer.svg alt="GitLab Docs logo" class=logo width=176 height=24></a></div><ul class="docs-social gl-list-none gl-flex"><li><a href=https://www.facebook.com/gitlab class=facebook><span class=gl-sr-only>Facebook</span></a></li><li><a href=https://www.linkedin.com/company/gitlab-com class=linkedin><span class=gl-sr-only>LinkedIn</span></a></li><li><a href=https://twitter.com/gitlab class=twitter><span class=gl-sr-only>Twitter</span></a></li><li><a href=https://www.youtube.com/channel/UCnMGQ8QHMAnVIsI3xJrihhg class=youtube><span class=gl-sr-only>YouTube</span></a></li></ul><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="license noopener noreferrer" class=gl-mt-0><img src=/by-sa.svg alt="Creative Commons License" width=80 height=15></a></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Company</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/company/>About GitLab</a></li><li><a href=https://about.gitlab.com/pricing/>View pricing</a></li><li><a href=https://about.gitlab.com/free-trial/>Try GitLab for free</a></li></ul></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Feedback</div><ul class="gl-list-none gl-p-0"><li><a href=https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/ci/runners/configure_runners.md>View page source</a></li><li><a href=https://gitlab.com/-/ide/project/gitlab-org/gitlab/edit/master/-/doc/ci/runners/configure_runners.md>Edit in web IDE</a></li><li><a href=https://about.gitlab.com/community/contribute/>Contribute to GitLab</a></li><li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/new?issuable_template=Documentation">Suggest updates</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Help & Community</div><ul class="gl-list-none gl-p-0"><li><a href=https://university.gitlab.com/pages/certifications>Get certified</a></li><li><a href=https://about.gitlab.com/support/>Get support</a></li><li><a href="https://forum.gitlab.com/new-topic?title=topic%20title&amp;body=topic%20body&amp;tags=docs-feedback">Post on the GitLab forum</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Resources</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/terms/>Terms</a></li><li><a href=https://about.gitlab.com/privacy/>Privacy statement</a></li><li><a href=/legal/use_generative_ai/>Use of generative AI</a></li><li><a href=/legal/licensing_policy/>Acceptable use of user licenses</a></li><li><button id=ot-sdk-btn class=ot-sdk-show-settings></button></li></ul></div></div></section></footer><script type=module src=/vite/main.js></script><script async>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NJXWQL")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJXWQL" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script async>(function(){var e,t=!1;function n(){t===!1&&(t=!0,Munchkin.init("194-VVC-221",{useBeaconAPI:!0}))}e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://munchkin.marketo.net/munchkin.js",e.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&n()},e.onload=n,document.getElementsByTagName("head")[0].appendChild(e)})()</script><script async src=https://cdn.bizible.com/scripts/bizible.js></script><script async>_linkedin_partner_id="30694",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id),function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height=1 width=1 style=display:none alt src="https://dc.ads.linkedin.com/collect/?pid=30694&fmt=gif"></noscript></body></html>