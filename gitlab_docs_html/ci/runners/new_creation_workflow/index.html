<!doctype html><html lang=en-us dir=ltr><head><script src=https://cdn.cookielaw.org/consent/7f944245-c5cd-4eed-a90e-dd955adfdd08/OtAutoBlock.js></script><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js data-domain-script=7f944245-c5cd-4eed-a90e-dd955adfdd08></script><script type=text/javascript>function OptanonWrapper(){}</script><script>const callback=(e)=>{for(const t of e)t.type==="childList"&&t.addedNodes.forEach(e=>{e.nodeName==="IMG"&&document.querySelectorAll('img:not([src^="http"]):not([data-ot-ignore])').forEach(e=>{e.setAttribute("data-ot-ignore","")})})},config={attributes:!0,childList:!0,subtree:!0,attributeFilter:["src"]},observer=new MutationObserver(callback);observer.observe(document.documentElement,config)</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GTM-NJXWQL"),gtag("consent","default",{analytics_storage:"granted",ad_storage:"granted",functionality_storage:"granted",wait_for_update:500}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",functionality_storage:"denied",region:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO","GB","PE","RU"],wait_for_update:500}),window.geofeed=e=>{dataLayer.push({event:"OneTrustCountryLoad",oneTrustCountryId:e.country.toString()})};const json=document.createElement("script");json.setAttribute("src","https://geolocation.onetrust.com/cookieconsentpub/v1/geo/location/geofeed"),document.head.appendChild(json)</script><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Migrating to the new runner registration workflow | GitLab Docs</title><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=manifest href=/manifests/manifest.webmanifest><meta name=theme-color content="#FC6D26"><link rel=canonical href=https://docs.gitlab.com/ci/runners/new_creation_workflow/><meta name=description content="GitLab product documentation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"GitLab Docs","url":"https://docs.gitlab.com/"}</script><link rel=preload href=/gitlab_ui/fonts/GitLabSans.woff2 type=font/woff2 as=font crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabSans-Italic.woff2 crossorigin><link rel=prefetch href=/gitlab_ui/fonts/GitLabMono.woff2 crossorigin><link rel=stylesheet href=/gitlab_ui/ui/index.css><link rel=stylesheet href=/vite/main.css><link rel=stylesheet href=/css/syntax-dark.min.css id=syntax-dark-theme><link rel=stylesheet href=/css/syntax-light.min.css id=syntax-light-theme><script>(function(){const p="gitlab-docs-theme",g="gitlab-docs-layout",e={LIGHT:"light",DARK:"dark",AUTO:"auto"},i={FIXED:"fixed",FLUID:"fluid"},d="light",f="fixed";let r=!1;const t=localStorage?.getItem(p),m=localStorage?.getItem(g),l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?e.DARK:e.LIGHT;function h(){return t&&(t===e.LIGHT||t===e.DARK)?t:(t===e.AUTO&&(r=!0),l||d)}function u(){return m===i.FLUID?i.FLUID:f}const s=h(),c=u(),n=document.documentElement;n.classList.remove("gl-dark","gl-light"),n.classList.add(s===e.DARK?"gl-dark":"gl-light"),c===i.FLUID&&(n.classList.add("fluid"),n.classList.remove("fixed"));const a=document.getElementById("syntax-dark-theme"),o=document.getElementById("syntax-light-theme");a&&o&&(s===e.DARK?(a.disabled=!1,o.disabled=!0):(a.disabled=!0,o.disabled=!1)),window.__initialTheme=r?e.AUTO:s,window.__initialLayout=c})()</script><meta name=gitlab_docs_base_url content="/"><meta name=gitlab_docs_page_owner data-stage=Verify data-group="Runner Core"><meta class=elastic name=gitlab_docs_version content="18.6"><meta class=elastic name=gitlab_docs_section content="administer"><meta class=elastic name=gitlab_docs_breadcrumbs content="Administer › Administer GitLab Runner › Register a runner"><script>window.pageMetadata={trail:[{path:"administration/",title:"Administer"},{path:"runner/",title:"Administer GitLab Runner"},{path:"runner/register/",title:"Register a runner"},{path:"ci/runners/new_creation_workflow/",title:"Migrate to the new runner registration workflow"}]}</script><meta name=gitlab_docs_legacy_path content="/ee/ci/runners/new_creation_workflow.html"><meta name=gitlab_docs_hugo_launch_version content="17.9"><script>const ELASTIC_CLOUD_ID="gitlab-docs-website:dXMtY2VudHJhbDEuZ2NwLmNsb3VkLmVzLmlvJDQwZTQyYTQzMTJiZjQyMzNiMzBiZTg0MTU5YjlkNmE1JGMxODg4Y2U5OTY0YzQzZjc5ZjQ1YTk5NDZmMjI0ODg0",ELASTIC_KEY="cDFpLWJaSUJXVHBqWWI4VGZKN3M6eENBSjl4WDRSRnlCUW94ajRQazhLQQ==",ELASTIC_INDEX="search-gitlab-docs-hugo"</script><script type=module src=/vite/elastic_search.js></script><script type=module src=/vite/history.js></script><script>const FS_IDENTIFIER="AIzaSyCLdi3jHHjkmLji9D8uj_RNPMHcdrYoIW4",RECAPTCHA_PUBLIC_KEY="6Le4R3UrAAAAALsIlK_siq0_UhPD-0rD-ImF1gfO"</script><meta name=google-site-verification content="AcGSBNaKDWnLgcYotlVibGy6STm2Y6_KJSaRxrA90xY"><meta name=google-site-verification content="6eFQOFLxYAer08ROqc3I-SAi44F9NmvH7PrUUBR3oCI"><meta name=google-site-verification content="xAUTWp3CDg-tU1LVVwsM9OrVhLR7L3SmiyKzkOuPNos"><meta name=google-site-verification content="F0zzwaMpiyWFcPQ1Lqu18qN3EnuQsqFXbySl_29yvHs"><meta name=google-site-verification content="nwo1bVaU0t9TZxZyM-aOI6-CofaH9GRL-uBPbdREWgc"><meta name=google-site-verification content="rWoHrtHEmIX0t28oOb1ZEDMYZb_EZA6rr6ZOl5otEPI"><meta name=google-site-verification content="fSxr8-uslxcuFL0N-oECp3Tm0RPNEGX97wbdayKOEL8"><meta name=google-site-verification content="ISxyLVnZqU8oY3jwrK7EO9o-2DOTvLJwPse7bZz6yhs"><meta name=google-site-verification content="x1WspIvz3ZHqS0gezfX_P-qiRDOeP2Oyrd68zrU2ErI"><meta name=google-site-verification content="DfXB2Za52GT3zs_vuLIAL4Mi3M3K4qxXcg7MAs0CUqo"><meta name=google-site-verification content="BCEBC2LC7A1NzO9Com1oBrWK88tV_QXfUL0i9mwXPL0"><meta name=google-site-verification content="a2lNcHMorfS43aoISjZt5_BBPo-H1UaTKMQdBgZO9iY"><meta name=google-site-verification content="0s16pP9MelY6wDHRf-izXb5pwLU01IogP-Uc_e8f3GU"><meta name=google-site-verification content="H474RNof35Xp8fLg02fZbg9Dzxdtfch6vtcjzpmUraU"><meta name=google-site-verification content="E0FlhpgBGeE7d1pQ6amdcIWPMDLDeu15-HLQVoDTguE"><meta name=google-site-verification content="opQd7_rXtPy-pX5CO_XZiztzeQEsXnB3j6Y1_dZAizA"><meta name=google-site-verification content="06Kq4AoXdmBOjOAkbPvnYGtSxnn4Q9QBqEO55PLlw5c"><meta name=google-site-verification content="djBBokRFSWV_VRlSE51V5TZSPzMC6hml5l-Sb22WglE"><meta name=google-site-verification content="UOW6nOsvbyMeIySuamzbws4kNC_WqehamWfoxxtKjZ8"><meta name=google-site-verification content="hXU1Gsdba74DUbvbdUHRl9o0cQeiwXIhAdIllOG6p8E"><meta name=google-site-verification content="YFeHIAPk9lE76ubVMeq4P0sQVnzo2-a4k1oU_bPY8yE"><meta name=google-site-verification content="h8ICI4eDkvXmYaGDuLTLoWuXnLn-KUkChqYB-roMRsw"><meta name=google-site-verification content="9QW7feFNlCpMLPm7vAWEU-v14vdzb0Bb3RAk-8e_a18"><meta name=google-site-verification content="26kXLBOjaYRb2UwzWTDl1I1nzA2NxMunhp7SUtxGV6E"><meta name=google-site-verification content="jr3C8t6vKGPyN9GV3esdHY_xGYyQaUNznIl-Un2RObA"><meta name=google-site-verification content="WdlBpRU0ec1ieKqrTY_772OhG23FY45VQ4Lv9DyLJ_Y"><meta name=google-site-verification content="n9i6B9q4Xjr_etK2nQGZH1msoo7vIv9SXV8SQLOUA7c"><meta name=zd-site-verification content="ony3w7hk1vs6tfyrc51mld"><meta name=zd-site-verification content="gtuq65qdzt6n31viazi6hj"></head><body data-elastic-exclude><nav data-ga-section=header data-elastic-exclude><div class="header-wrapper gl-w-full gl-fixed gl-z-4"><div class=header><div class="header-top gl-flex gl-items-center"><a href=#skipTarget class="gl-sr-only skip-link">Skip to main content</a>
<a class=navbar-logo href=/><span class=gl-sr-only>Go to GitLab Docs homepage</span></a><div class="mobile-header gl-w-full gl-text-base"><div class=mobile-header-overlay></div><div class="header-right collapse gl-z-4 gl-border-t lg:gl-border-0"><div class="search-wrapper lg:gl-ml-4 lg:gl-grow"><div class="js-elastic-search-form gl-spinner-container"><span role=status aria-label=Loading class="gl-ml-3 gl-align-text-bottom! gl-spinner gl-spinner gl-spinner-sm"></span></div></div><div class="gl-flex gl-flex-col gl-gap-3 gl-mt-5 lg:gl-mt-0 lg:gl-flex-row lg:gl-items-center gl-ml-auto"><a class="whats-new gl-button btn-default btn-default-tertiary gl-hidden lg:gl-block" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a><div data-vue-app=versions-menu></div><div data-vue-app=appearance-toggle class="gl-hidden lg:gl-block"></div><div class="gl-flex gl-justify-evenly lg:gl-justify-normal gl-items-center gl-gap-5"><a class="whats-new gl-button btn-default btn-default-tertiary gl-w-full lg:gl-hidden hover:gl-no-underline" href=https://about.gitlab.com/releases/categories/releases/ target=_blank rel="noopener noreferrer">What's new?</a>
<a class="free-trial-btn cta-button gl-button btn-confirm gl-w-full hover:gl-no-underline" href="https://gitlab.com/-/trial_registrations/new?glm_source=docs.gitlab.com&amp;amp;glm_content=navigation-cta-docs" target=_blank rel="noopener noreferrer" role=button>Get free trial</a></div></div></div></div><button class="navbar-toggle gl-button btn-default lg:gl-hidden" data-toggle=collapse data-target=.header-right>
<span class=navbar-toggle-icon></span>
<span class=gl-sr-only>Toggle menu</span></button></div><div class="header-bottom gl-border-t lg:gl-border-b"><ul class="subheader-menu gl-hidden lg:gl-flex gl-list-none gl-text-base gl-space-x-5 gl-py-4 gl-pl-0 gl-mb-0"><li><a href=/user/>Use GitLab</a></li><li><a href=/user/gitlab_duo/>GitLab Duo</a></li><li><a href=/api/>Extend</a></li><li><a href=/install/>Install</a></li><li><a href=/administration/ class=active>Administer</a></li><li><a href=/subscriptions/>Subscribe</a></li><li><a href=/development/>Contribute</a></li><li><a href=/solutions/>Solutions</a></li></ul></div></div></div></nav><main data-ga-section=content-body><div id=js-version-banner></div><div class="template-single gl-flex gl-h-full"><div class=side-nav data-ga-section=side-nav data-vue-app=sidebar-menu></div><div data-pagefind-body class=main-content><div class=docs-content><div class="gl-flex gl-h-5 gl-items-center gl-my-6"><div data-vue-app=open-sidebar></div><div data-vue-app=breadcrumb-nav></div></div><hr class="gl-border-t gl-px-5 lg:gl-hidden"><div class="gl-pt-4 gl-mt-4 lg:gl-pt-0 lg:gl-mt-0 lg:gl-border-t-0"><h1 id=skipTarget class=gl-mb-6>Migrating to the new runner registration workflow</h1></div><div data-elastic-include><div class="availability gl-pl-4 gl-mb-5"><ul class="gl-list-none gl-p-0 gl-m-0"><li><span class=gl-font-bold>Tier</span>: Free, Premium, Ultimate</li><li><span class=gl-font-bold>Offering</span>: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li></ul></div><div class="alert alert-type-disclaimer gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0>This page contains information related to upcoming products, features, and functionality. It is important to note that the information presented is for informational purposes only. Please do not rely on this information for purchasing or planning purposes. The development, release, and timing of any products, features, or functionality may be subject to change or delay and remain at the sole discretion of GitLab Inc.</div></div><p>GitLab 16.0 introduced a new runner creation workflow that uses runner authentication tokens to register
runners. The legacy workflow that uses registration tokens is not recommended.
Use the <a href=https://docs.gitlab.com/runner/register/#register-with-a-runner-authentication-token>runner creation workflow</a> instead.</p><p>For information about the current development status of the new workflow, see <a href=https://gitlab.com/groups/gitlab-org/-/epics/7663>epic 7663</a>.</p><p>For information about the technical design and reasons for the new architecture, see Next GitLab Runner Token Architecture.</p><p>If you experience problems or have concerns about the new runner registration workflow,
or need more information, let us know in the <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/387993>feedback issue</a>.</p><h2 id=the-new-runner-registration-workflow>The new runner registration workflow</h2><p>For the new runner registration workflow, you:</p><ol><li><a href=/ci/runners/runners_scope/>Create a runner</a> directly in the GitLab UI or <a href=/ci/runners/new_creation_workflow/#creating-runners-programmatically>programmatically</a>.</li><li>Receive a runner authentication token.</li><li>Use the runner authentication token instead of the registration token when you register
a runner with this configuration. Runner managers registered in multiple hosts appear
under the same runner in the GitLab UI, but with an identifying system ID.</li></ol><p>The new runner registration workflow has the following benefits:</p><ul><li>Preserved ownership records for runners, and minimized impact on users.</li><li>The addition of a unique system ID ensures that you can reuse the same authentication token across
multiple runners. For more information, see <a href=https://docs.gitlab.com/runner/fleet_scaling/#reusing-a-gitlab-runner-configuration>Reusing a GitLab Runner configuration</a>.</li></ul><h2 id=estimated-time-frame-for-planned-changes>Estimated time frame for planned changes</h2><ul><li>In GitLab 15.10 and later, you can use the new runner registration workflow.</li></ul><h2 id=prevent-your-runner-registration-workflow-from-breaking>Prevent your runner registration workflow from breaking</h2><p>In GitLab 16.11 and earlier, you can use the legacy runner registration workflow.</p><p>In GitLab 17.0 and later, the legacy runner registration workflow can be disabled by instance administrators or group owners. For more information, see <a href=/ci/runners/new_creation_workflow/#using-registration-tokens-after-gitlab-170>Using registration tokens after GitLab 17.0</a>.</p><p>If you register a runner without migrating to the new workflow, the runner registration breaks and the <code>gitlab-runner register</code> command returns a <code>410 Gone - runner registration disallowed</code> error.</p><p>To avoid a broken workflow, you must:</p><ol><li><a href=/ci/runners/runners_scope/>Create a runner</a> and obtain the authentication token.</li><li>Replace the registration token in your runner registration workflow with the
authentication token.</li></ol><h2 id=using-registration-tokens-after-gitlab-170>Using registration tokens after GitLab 17.0</h2><p>To continue using registration tokens after GitLab 17.0:</p><ul><li>On GitLab.com, you can manually <a href=/ci/runners/runners_scope/#enable-use-of-runner-registration-tokens-in-projects-and-groups>enable the legacy runner registration process</a>
in the top-level group settings.</li><li>On GitLab Self-Managed, you can manually <a href=/administration/settings/continuous_integration/#control-runner-registration>enable the legacy runner registration process</a>
in the <strong>Admin</strong> area settings.</li></ul><h2 id=impact-on-existing-runners>Impact on existing runners</h2><p>Existing runners will continue to work as usual after upgrading to GitLab 17.0. This change only affects registration of new runners.</p><p>The <a href=https://docs.gitlab.com/runner/install/kubernetes.html>GitLab Runner Helm chart</a> generates new runner pods every time a job is executed.
For these runners, <a href=/ci/runners/new_creation_workflow/#using-registration-tokens-after-gitlab-170>enable legacy runner registration</a> to use registration tokens.</p><h2 id=changes-to-the-gitlab-runner-register-command-syntax>Changes to the <code>gitlab-runner register</code> command syntax</h2><p>The <code>gitlab-runner register</code> command accepts runner authentication tokens instead of registration tokens.
You can generate tokens from the <strong>Runners</strong> page in the <strong>Admin</strong> area.
The runner authentication tokens are recognizable by their <code>glrt-</code> prefix.</p><p>When you create a runner in the GitLab UI, you specify configuration values that were previously command-line options
prompted by the <code>gitlab-runner register</code> command.</p><p>If you specify a runner authentication token with:</p><ul><li>the <code>--token</code> command-line option, the <code>gitlab-runner register</code> command does not accept the configuration values.</li><li>the <code>--registration-token</code> command-line option, the <code>gitlab-runner register</code> command ignores the configuration values.</li></ul><table><thead><tr><th>Token</th><th>Registration command</th></tr></thead><tbody><tr><td>Runner authentication token</td><td><code>gitlab-runner register --token $RUNNER_AUTHENTICATION_TOKEN</code></td></tr><tr><td>Runner registration token (legacy)</td><td><code>gitlab-runner register --registration-token $RUNNER_REGISTRATION_TOKEN &lt;runner configuration arguments></code></td></tr></tbody></table><p>Authentication tokens have the prefix, <code>glrt-</code>.</p><p>To ensure minimal disruption to your automation workflow,
<a href=https://docs.gitlab.com/runner/register/#legacy-compatible-registration-process>legacy-compatible registration processing</a>
triggers if a runner authentication token is specified in the legacy parameter <code>--registration-token</code>.</p><p>Example command for GitLab 15.9:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>gitlab-runner register <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --non-interactive <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --executor <span class=s2>&#34;shell&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --url <span class=s2>&#34;https://gitlab.com/&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --tag-list <span class=s2>&#34;shell,mac,gdk,test&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --run-untagged <span class=s2>&#34;false&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --locked <span class=s2>&#34;false&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --access-level <span class=s2>&#34;not_protected&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --registration-token <span class=s2>&#34;REDACTED&#34;</span></span></span></code></pre></div></div><p>In GitLab 15.10 and later, you can create the runner and set attributes in the UI, like
tag list, locked status, and access level.
In GitLab 15.11 and later, these attributes are no longer accepted as arguments to <code>register</code> when a runner authentication token with the <code>glrt-</code> prefix is specified.</p><p>The following example shows the new command:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=shell class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>gitlab-runner register <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --non-interactive <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --executor <span class=s2>&#34;shell&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --url <span class=s2>&#34;https://gitlab.com/&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --token <span class=s2>&#34;REDACTED&#34;</span></span></span></code></pre></div></div><h2 id=impact-on-autoscaling>Impact on autoscaling</h2><p>In autoscaling scenarios such as GitLab Runner Operator or GitLab Runner Helm Chart, the
runner authentication token generated from the UI replaces the registration token.
This means that the same runner configuration is reused across jobs, instead of creating a runner
for each job.
The specific runner can be identified by the unique system ID that is generated when the runner
process is started.</p><h2 id=creating-runners-programmatically>Creating runners programmatically</h2><p>In GitLab 15.11 and later, you can use the <a href=/api/users/#create-a-runner-linked-to-a-user>POST /user/runners REST API</a>
to create a runner as an authenticated user. This should only be used if the runner configuration is dynamic
or not reusable. If the runner configuration is static, you should reuse the runner authentication token of
an existing runner.</p><p>For instructions about how to automate runner creation and registration, see the tutorial,
<a href=/tutorials/automate_runner_creation/>Automate runner creation and registration</a>.</p><h2 id=installing-gitlab-runner-with-helm-chart>Installing GitLab Runner with Helm chart</h2><p>Several runner configuration options cannot be set during runner registration if runner registration tokens are disabled. These options can only be configured:</p><ul><li>When you create a runner in the UI.</li><li>With the <code>user/runners</code> REST API endpoint.</li></ul><p>The following configuration options are not supported in <a href=https://gitlab.com/gitlab-org/charts/gitlab-runner/-/blob/main/values.yaml><code>values.yaml</code></a> in that scenario:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c>## If a runner authentication token is specified in runnerRegistrationToken, the registration will succeed, however the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>## other values will be ignored.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>runnerRegistrationToken</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>locked</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>tags</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>maximumTimeout</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>runUntagged</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>protected</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div><p>For GitLab Runner on Kubernetes, Helm deploy passes the runner authentication token to the runner worker pod and creates the runner configuration.
In GitLab 17.0 and later, if you use the <code>runnerRegistrationToken</code> token field on Kubernetes hosted runners attached to GitLab.com, the runner worker pod tries to use the legacy Registration API method during creation.</p><p>Replace the invalid <code>runnerRegistrationToken</code> field with the <code>runnerToken</code> field. You must also modify the runner authentication token stored in <code>secrets</code>.</p><p>In the legacy runner registration workflow, fields were specified with:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Secret</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>gitlab-runner-secret</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Opaque</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>runner-registration-token</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;REDACTED&#34;</span><span class=w> </span><span class=c># DEPRECATED, set to &#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>runner-token</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span></span></span></code></pre></div></div><p>In the new runner registration workflow, you must use <code>runner-token</code> instead:</p><div class=codeblock-wrapper><div data-vue-app=codeblock-toolbar data-code-language=yaml class=codeblock-toolbar></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Secret</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>gitlab-runner-secret</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Opaque</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>runner-registration-token</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w> </span><span class=c># need to leave as an empty string for compatibility reasons</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>runner-token</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;REDACTED&#34;</span></span></span></code></pre></div></div><div class="alert alert-type-note gl-rounded-lg"><div class=alert-icon></div><div class=gl-min-w-0><p>If your secret management solution doesn&rsquo;t allow you to set an empty string for <code>runner-registration-token</code>,
you can set it to any string. This value is ignored when <code>runner-token</code> is present.</p></div></div><h2 id=known-issues>Known issues</h2><h3 id=pod-name-is-not-visible-in-runner-details-page>Pod name is not visible in runner details page</h3><p>When you use the new registration workflow to register your runners with Helm chart, the pod name doesn&rsquo;t appear
on the runner details page.
For more information, see <a href=https://gitlab.com/gitlab-org/gitlab/-/issues/423523>issue 423523</a>.</p><h3 id=runner-authentication-token-does-not-update-when-rotated>Runner authentication token does not update when rotated</h3><h4 id=token-rotation-with-the-same-runner-registered-in-multiple-runner-managers>Token rotation with the same runner registered in multiple runner managers</h4><p>When you register runners on multiple host machines through the new workflow with
automatic token rotation, only the first runner manager receives the new token.
The remaining runner managers continue to use the invalid token and become disconnected.
You must update these managers manually to use the new token.</p><h4 id=token-rotation-in-gitlab-operator>Token rotation in GitLab Operator</h4><p>During runner registration with GitLab Operator through the new workflow,
the runner authentication token in the Custom Resource Definition doesn&rsquo;t update
during token rotation.
This occurs when:</p><ul><li>You&rsquo;re using a runner authentication token (prefixed with <code>glrt-</code>) in a secret
<a href=https://docs.gitlab.com/runner/install/operator.html#install-gitlab-runner>referenced by a Custom Resource Definition</a>.</li><li>The runner authentication token is due to expire.
For more information about runner authentication token expiration,
see <a href=/ci/runners/configure_runners/#authentication-token-security>Authentication token security</a>.</li></ul><p>For more information, see <a href=https://gitlab.com/gitlab-org/gl-openshift/gitlab-runner-operator/-/issues/186>issue 186</a>.</p></div><div data-vue-app=back-to-top-button></div></div><div class="feedback gl-min-h-8" data-ga-section=feedback data-elastic-exclude><div data-component=docs-feedback></div></div></div><aside class=sidebar-right><div data-ga-section=toc data-vue-app=toc></div></aside></div></main><footer data-ga-section=footer><section data-ga-section=footer><div id=footer class="footer-section container gl-grid gl-grid-cols-2 gl-grid-rows-3 gl-grid-rows-auto gl-gap-8 lg:gl-grid-cols-5 lg:gl-grid-rows-1 lg:gl-justify-items-center gl-px-8 gl-py-8 lg:gl-py-10"><div class="gl-col-span-2 lg:gl-col-span-1 gl-row-start-1"><div class="docs-title gl-flex gl-items-center"><a href=/><img src=/gitlab-logo-footer.svg alt="GitLab Docs logo" class=logo width=176 height=24></a></div><ul class="docs-social gl-list-none gl-flex"><li><a href=https://www.facebook.com/gitlab class=facebook><span class=gl-sr-only>Facebook</span></a></li><li><a href=https://www.linkedin.com/company/gitlab-com class=linkedin><span class=gl-sr-only>LinkedIn</span></a></li><li><a href=https://twitter.com/gitlab class=twitter><span class=gl-sr-only>Twitter</span></a></li><li><a href=https://www.youtube.com/channel/UCnMGQ8QHMAnVIsI3xJrihhg class=youtube><span class=gl-sr-only>YouTube</span></a></li></ul><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="license noopener noreferrer" class=gl-mt-0><img src=/by-sa.svg alt="Creative Commons License" width=80 height=15></a></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Company</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/company/>About GitLab</a></li><li><a href=https://about.gitlab.com/pricing/>View pricing</a></li><li><a href=https://about.gitlab.com/free-trial/>Try GitLab for free</a></li></ul></div><div class="gl-col-span-1 gl-row-start-2 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Feedback</div><ul class="gl-list-none gl-p-0"><li><a href=https://gitlab.com/gitlab-org/gitlab/-/blob/master/doc/ci/runners/new_creation_workflow.md>View page source</a></li><li><a href=https://gitlab.com/-/ide/project/gitlab-org/gitlab/edit/master/-/doc/ci/runners/new_creation_workflow.md>Edit in web IDE</a></li><li><a href=https://about.gitlab.com/community/contribute/>Contribute to GitLab</a></li><li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/new?issuable_template=Documentation">Suggest updates</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Help & Community</div><ul class="gl-list-none gl-p-0"><li><a href=https://university.gitlab.com/pages/certifications>Get certified</a></li><li><a href=https://about.gitlab.com/support/>Get support</a></li><li><a href="https://forum.gitlab.com/new-topic?title=topic%20title&amp;body=topic%20body&amp;tags=docs-feedback">Post on the GitLab forum</a></li></ul></div><div class="gl-col-span-1 gl-row-start-3 lg:gl-row-start-1"><div class="footer-section-title gl-heading-3">Resources</div><ul class="gl-list-none gl-p-0"><li><a href=https://about.gitlab.com/terms/>Terms</a></li><li><a href=https://about.gitlab.com/privacy/>Privacy statement</a></li><li><a href=/legal/use_generative_ai/>Use of generative AI</a></li><li><a href=/legal/licensing_policy/>Acceptable use of user licenses</a></li><li><button id=ot-sdk-btn class=ot-sdk-show-settings></button></li></ul></div></div></section></footer><script type=module src=/vite/main.js></script><script async>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NJXWQL")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJXWQL" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script async>(function(){var e,t=!1;function n(){t===!1&&(t=!0,Munchkin.init("194-VVC-221",{useBeaconAPI:!0}))}e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://munchkin.marketo.net/munchkin.js",e.onreadystatechange=function(){(this.readyState=="complete"||this.readyState=="loaded")&&n()},e.onload=n,document.getElementsByTagName("head")[0].appendChild(e)})()</script><script async src=https://cdn.bizible.com/scripts/bizible.js></script><script async>_linkedin_partner_id="30694",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id),function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height=1 width=1 style=display:none alt src="https://dc.ads.linkedin.com/collect/?pid=30694&fmt=gif"></noscript></body></html>